<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Comprehensive security analysis of Tesla Model S/X/3/Y MCU2 and Gateway"><meta name=author content="Security Researcher"><link href=https://talas9.github.io/tesla-research/core/04-network-ports-firewall/ rel=canonical><link href=../03-certificate-recovery-orphan-cars/ rel=prev><link href=../06-usb-firmware-update/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Network Topology - Tesla MCU2 Security Research</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tesla-mcu2-network-architecture-port-reference class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Tesla MCU2 Security Research" class="md-header__button md-logo" aria-label="Tesla MCU2 Security Research" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tesla MCU2 Security Research </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Network Topology </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=red data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/talas9/tesla-research title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla-research </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../INDEX/ class=md-tabs__link> Complete Index </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../00-master-cross-reference/ class=md-tabs__link> Core Research </a> </li> <li class=md-tabs__item> <a href=../../gateway/81-gateway-secure-configs-CRITICAL/ class=md-tabs__link> Gateway Security </a> </li> <li class=md-tabs__item> <a href=../../mcu/24-vcsec-key-programming/ class=md-tabs__link> MCU Research </a> </li> <li class=md-tabs__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-tabs__link> Evidence & Audit </a> </li> <li class=md-tabs__item> <a href=../../tools/56-gateway-factory-gate-REAL/ class=md-tabs__link> Tools & Scripts </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Tesla MCU2 Security Research" class="md-nav__button md-logo" aria-label="Tesla MCU2 Security Research" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Tesla MCU2 Security Research </label> <div class=md-nav__source> <a href=https://github.com/talas9/tesla-research title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla-research </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../INDEX/ class=md-nav__link> <span class=md-ellipsis> Complete Index </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Core Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../00-master-cross-reference/ class=md-nav__link> <span class=md-ellipsis> Master Cross-Reference </span> </a> </li> <li class=md-nav__item> <a href=../02-gateway-can-flood-exploit/ class=md-nav__link> <span class=md-ellipsis> Gateway CAN Flood Exploit </span> </a> </li> <li class=md-nav__item> <a href=../03-certificate-recovery-orphan-cars/ class=md-nav__link> <span class=md-ellipsis> Certificate Recovery </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Network Topology </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Network Topology </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#network-topology class=md-nav__link> <span class=md-ellipsis> Network Topology </span> </a> <nav class=md-nav aria-label="Network Topology"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#physical-network-architecture class=md-nav__link> <span class=md-ellipsis> Physical Network Architecture </span> </a> </li> <li class=md-nav__item> <a href=#network-interfaces class=md-nav__link> <span class=md-ellipsis> Network Interfaces </span> </a> <nav class=md-nav aria-label="Network Interfaces"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#eth0-primary-vehicle-network class=md-nav__link> <span class=md-ellipsis> eth0 - Primary Vehicle Network </span> </a> </li> <li class=md-nav__item> <a href=#wlan0-wifi-interface class=md-nav__link> <span class=md-ellipsis> wlan0 - WiFi Interface </span> </a> </li> <li class=md-nav__item> <a href=#eth02-vlan-2 class=md-nav__link> <span class=md-ellipsis> eth0.2 - VLAN 2 </span> </a> </li> <li class=md-nav__item> <a href=#lo-loopback-127001 class=md-nav__link> <span class=md-ellipsis> lo - Loopback (127.0.0.1) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#critical-ports-services class=md-nav__link> <span class=md-ellipsis> Critical Ports &amp; Services </span> </a> <nav class=md-nav aria-label="Critical Ports & Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#critical-risk-ports class=md-nav__link> <span class=md-ellipsis> ğŸ”´ CRITICAL RISK PORTS </span> </a> <nav class=md-nav aria-label="ğŸ”´ CRITICAL RISK PORTS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#port-49503-tcp-modem-update-server class=md-nav__link> <span class=md-ellipsis> Port 49503 TCP - Modem Update Server </span> </a> </li> <li class=md-nav__item> <a href=#ports-80443-tcp-httphttps-unrestricted class=md-nav__link> <span class=md-ellipsis> Ports 80/443 TCP - HTTP/HTTPS (UNRESTRICTED) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#high-risk-ports class=md-nav__link> <span class=md-ellipsis> ğŸŸ  HIGH RISK PORTS </span> </a> <nav class=md-nav aria-label="ğŸŸ  HIGH RISK PORTS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#port-25956-tcp-updater-shell class=md-nav__link> <span class=md-ellipsis> Port 25956 TCP - Updater Shell </span> </a> </li> <li class=md-nav__item> <a href=#port-20564-tcp-sx-updater-http class=md-nav__link> <span class=md-ellipsis> Port 20564 TCP - SX-Updater HTTP </span> </a> </li> <li class=md-nav__item> <a href=#ports-4030-tcp-toolbox-api class=md-nav__link> <span class=md-ellipsis> Ports 4030+ TCP - Toolbox API </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#medium-risk-ports class=md-nav__link> <span class=md-ellipsis> ğŸŸ¡ MEDIUM RISK PORTS </span> </a> <nav class=md-nav aria-label="ğŸŸ¡ MEDIUM RISK PORTS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#port-8081-tcp-service-shell class=md-nav__link> <span class=md-ellipsis> Port 8081 TCP - Service Shell </span> </a> </li> <li class=md-nav__item> <a href=#port-8901-tcp-provisioning-api-iris-api class=md-nav__link> <span class=md-ellipsis> Port 8901 TCP - Provisioning API / iris-api </span> </a> </li> <li class=md-nav__item> <a href=#port-3500-udp-gateway-udpapi class=md-nav__link> <span class=md-ellipsis> Port 3500 UDP - Gateway UDPAPI </span> </a> </li> <li class=md-nav__item> <a href=#port-8080-tcp-firmware-server-service-ui class=md-nav__link> <span class=md-ellipsis> Port 8080 TCP - Firmware Server / Service UI </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#internal-network-map class=md-nav__link> <span class=md-ellipsis> Internal Network Map </span> </a> <nav class=md-nav aria-label="Internal Network Map"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ip-address-allocation-19216890024 class=md-nav__link> <span class=md-ellipsis> IP Address Allocation (192.168.90.0/24) </span> </a> </li> <li class=md-nav__item> <a href=#trust-boundaries class=md-nav__link> <span class=md-ellipsis> Trust Boundaries </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#complete-port-matrix class=md-nav__link> <span class=md-ellipsis> Complete Port Matrix </span> </a> <nav class=md-nav aria-label="Complete Port Matrix"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mcu2-19216890100-listening-services class=md-nav__link> <span class=md-ellipsis> MCU2 (192.168.90.100) - Listening Services </span> </a> <nav class=md-nav aria-label="MCU2 (192.168.90.100) - Listening Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#external-facing-eth0-ports class=md-nav__link> <span class=md-ellipsis> External-Facing (eth0) Ports </span> </a> </li> <li class=md-nav__item> <a href=#outbound-connection-ports-mcu-others class=md-nav__link> <span class=md-ellipsis> Outbound Connection Ports (MCU â†’ Others) </span> </a> </li> <li class=md-nav__item> <a href=#localhost-services-127001 class=md-nav__link> <span class=md-ellipsis> Localhost Services (127.0.0.1) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#firewall-rules-analysis class=md-nav__link> <span class=md-ellipsis> Firewall Rules Analysis </span> </a> <nav class=md-nav aria-label="Firewall Rules Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rule-files-84-total-from-etcfirewalld class=md-nav__link> <span class=md-ellipsis> Rule Files (84 total from /etc/firewall.d/) </span> </a> <nav class=md-nav aria-label="Rule Files (84 total from /etc/firewall.d/)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#critical-service-rules class=md-nav__link> <span class=md-ellipsis> Critical Service Rules </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#modem-access-matrix class=md-nav__link> <span class=md-ellipsis> Modem Access Matrix </span> </a> </li> <li class=md-nav__item> <a href=#autopilot-access-matrix class=md-nav__link> <span class=md-ellipsis> Autopilot Access Matrix </span> </a> <nav class=md-nav aria-label="Autopilot Access Matrix"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ape-mcu-autopilot-can-access class=md-nav__link> <span class=md-ellipsis> APE â†’ MCU (Autopilot can access) </span> </a> </li> <li class=md-nav__item> <a href=#mcu-ape-mcu-can-access class=md-nav__link> <span class=md-ellipsis> MCU â†’ APE (MCU can access) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#service-dependencies class=md-nav__link> <span class=md-ellipsis> Service Dependencies </span> </a> <nav class=md-nav aria-label="Service Dependencies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#critical-service-chains class=md-nav__link> <span class=md-ellipsis> Critical Service Chains </span> </a> <nav class=md-nav aria-label="Critical Service Chains"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ota-update-chain class=md-nav__link> <span class=md-ellipsis> OTA Update Chain </span> </a> </li> <li class=md-nav__item> <a href=#autopilot-integration-chain class=md-nav__link> <span class=md-ellipsis> Autopilot Integration Chain </span> </a> </li> <li class=md-nav__item> <a href=#radioentertainment-chain class=md-nav__link> <span class=md-ellipsis> Radio/Entertainment Chain </span> </a> </li> <li class=md-nav__item> <a href=#logging-chain class=md-nav__link> <span class=md-ellipsis> Logging Chain </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#service-startup-dependencies class=md-nav__link> <span class=md-ellipsis> Service Startup Dependencies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#attack-surface-diagram class=md-nav__link> <span class=md-ellipsis> Attack Surface Diagram </span> </a> <nav class=md-nav aria-label="Attack Surface Diagram"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#attack-surface-by-network-interface class=md-nav__link> <span class=md-ellipsis> Attack Surface by Network Interface </span> </a> </li> <li class=md-nav__item> <a href=#attack-paths-by-risk class=md-nav__link> <span class=md-ellipsis> Attack Paths by Risk </span> </a> <nav class=md-nav aria-label="Attack Paths by Risk"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#critical-attack-paths class=md-nav__link> <span class=md-ellipsis> ğŸ”´ CRITICAL Attack Paths </span> </a> </li> <li class=md-nav__item> <a href=#high-attack-paths class=md-nav__link> <span class=md-ellipsis> ğŸŸ  HIGH Attack Paths </span> </a> </li> <li class=md-nav__item> <a href=#medium-attack-paths class=md-nav__link> <span class=md-ellipsis> ğŸŸ¡ MEDIUM Attack Paths </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#defense-in-depth-analysis class=md-nav__link> <span class=md-ellipsis> Defense in Depth Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#security-recommendations class=md-nav__link> <span class=md-ellipsis> Security Recommendations </span> </a> <nav class=md-nav aria-label="Security Recommendations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#immediate-actions-high-priority class=md-nav__link> <span class=md-ellipsis> Immediate Actions (High Priority) </span> </a> <nav class=md-nav aria-label="Immediate Actions (High Priority)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-restrict-httphttps-ports-80443 class=md-nav__link> <span class=md-ellipsis> 1. Restrict HTTP/HTTPS Ports (80/443) </span> </a> </li> <li class=md-nav__item> <a href=#2-enhance-modem-update-server-security-port-49503 class=md-nav__link> <span class=md-ellipsis> 2. Enhance Modem Update Server Security (Port 49503) </span> </a> </li> <li class=md-nav__item> <a href=#3-backport-model-3y-security-improvements-to-mcu2 class=md-nav__link> <span class=md-ellipsis> 3. Backport Model 3/Y Security Improvements to MCU2 </span> </a> </li> <li class=md-nav__item> <a href=#4-implement-mqtt-authentication-ports-5066650877 class=md-nav__link> <span class=md-ellipsis> 4. Implement MQTT Authentication (Ports 50666/50877) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#medium-priority class=md-nav__link> <span class=md-ellipsis> Medium Priority </span> </a> <nav class=md-nav aria-label="Medium Priority"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#5-network-segmentation-enhancements class=md-nav__link> <span class=md-ellipsis> 5. Network Segmentation Enhancements </span> </a> </li> <li class=md-nav__item> <a href=#6-service-shell-hardening-port-8081 class=md-nav__link> <span class=md-ellipsis> 6. Service Shell Hardening (Port 8081) </span> </a> </li> <li class=md-nav__item> <a href=#7-autopilot-api-security class=md-nav__link> <span class=md-ellipsis> 7. Autopilot API Security </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#long-term-improvements class=md-nav__link> <span class=md-ellipsis> Long-Term Improvements </span> </a> <nav class=md-nav aria-label="Long-Term Improvements"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#8-zero-trust-architecture class=md-nav__link> <span class=md-ellipsis> 8. Zero Trust Architecture </span> </a> </li> <li class=md-nav__item> <a href=#9-secure-update-pipeline class=md-nav__link> <span class=md-ellipsis> 9. Secure Update Pipeline </span> </a> </li> <li class=md-nav__item> <a href=#10-monitoring-alerting class=md-nav__link> <span class=md-ellipsis> 10. Monitoring &amp; Alerting </span> </a> </li> <li class=md-nav__item> <a href=#11-regular-security-audits class=md-nav__link> <span class=md-ellipsis> 11. Regular Security Audits </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-comparison-with-model-3y class=md-nav__link> <span class=md-ellipsis> Appendix: Comparison with Model 3/Y </span> </a> <nav class=md-nav aria-label="Appendix: Comparison with Model 3/Y"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#removed-services-security-improvements class=md-nav__link> <span class=md-ellipsis> Removed Services (Security Improvements) </span> </a> </li> <li class=md-nav__item> <a href=#added-services-new-features class=md-nav__link> <span class=md-ellipsis> Added Services (New Features) </span> </a> </li> <li class=md-nav__item> <a href=#port-changes class=md-nav__link> <span class=md-ellipsis> Port Changes </span> </a> </li> <li class=md-nav__item> <a href=#security-posture-evolution class=md-nav__link> <span class=md-ellipsis> Security Posture Evolution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-b-security-platform-gateway-server-comparison class=md-nav__link> <span class=md-ellipsis> Appendix B: Security Platform Gateway Server Comparison </span> </a> <nav class=md-nav aria-label="Appendix B: Security Platform Gateway Server Comparison"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#purpose class=md-nav__link> <span class=md-ellipsis> Purpose </span> </a> </li> <li class=md-nav__item> <a href=#security-platform-gateway-network-cwggco class=md-nav__link> <span class=md-ellipsis> Security Platform Gateway Network (c.wgg.co) </span> </a> <nav class=md-nav aria-label="Security Platform Gateway Network (c.wgg.co)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#network-interfaces-security-platform class=md-nav__link> <span class=md-ellipsis> Network Interfaces (Security Platform) </span> </a> </li> <li class=md-nav__item> <a href=#port-matrix-security-platform-vs-tesla-mcu2 class=md-nav__link> <span class=md-ellipsis> Port Matrix (Security Platform vs Tesla MCU2) </span> </a> </li> <li class=md-nav__item> <a href=#firewall-comparison class=md-nav__link> <span class=md-ellipsis> Firewall Comparison </span> </a> </li> <li class=md-nav__item> <a href=#key-differences class=md-nav__link> <span class=md-ellipsis> Key Differences </span> </a> </li> <li class=md-nav__item> <a href=#security-lessons class=md-nav__link> <span class=md-ellipsis> Security Lessons </span> </a> </li> <li class=md-nav__item> <a href=#additional-ports-found-security-platform-specific class=md-nav__link> <span class=md-ellipsis> Additional Ports Found (Security Platform-Specific) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#document-revision-history class=md-nav__link> <span class=md-ellipsis> Document Revision History </span> </a> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../06-usb-firmware-update/ class=md-nav__link> <span class=md-ellipsis> USB Firmware Update </span> </a> </li> <li class=md-nav__item> <a href=../07-usb-map-installation/ class=md-nav__link> <span class=md-ellipsis> USB Map Installation </span> </a> </li> <li class=md-nav__item> <a href=../08-key-programming-vcsec/ class=md-nav__link> <span class=md-ellipsis> Key Programming </span> </a> </li> <li class=md-nav__item> <a href=../13-ota-handshake-protocol/ class=md-nav__link> <span class=md-ellipsis> OTA Protocol </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Gateway Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Gateway Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gateway/81-gateway-secure-configs-CRITICAL/ class=md-nav__link> <span class=md-ellipsis> ğŸ”’ CRITICAL: Secure Configs </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/80-ryzen-gateway-flash-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> âœ… Complete Flash Dump </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/82-odin-routines-database-UNHASHED/ class=md-nav__link> <span class=md-ellipsis> ğŸ”“ Odin Database </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/92-config-metadata-table-FOUND/ class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Config Metadata Table </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/83-odin-config-api-analysis/ class=md-nav__link> <span class=md-ellipsis> Odin Config API </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/84-gw-diag-command-reference/ class=md-nav__link> <span class=md-ellipsis> gw-diag Commands </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/88-gateway-strings-analysis/ class=md-nav__link> <span class=md-ellipsis> Gateway Strings </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/91-gateway-powerpc-disassembly-summary/ class=md-nav__link> <span class=md-ellipsis> PowerPC Disassembly </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/94-gateway-ALL-FUNCTIONS/ class=md-nav__link> <span class=md-ellipsis> All Functions </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/95-gateway-CAN-MESSAGES-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> CAN Messages Complete </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/96-gateway-DATA-TABLES/ class=md-nav__link> <span class=md-ellipsis> All Data Tables </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/97-gateway-MEMORY-MAP/ class=md-nav__link> <span class=md-ellipsis> Memory Map </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/98-SHA-256-USAGE-ANALYSIS/ class=md-nav__link> <span class=md-ellipsis> SHA-256 Usage </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/99-gateway-FIRMWARE-METADATA/ class=md-nav__link> <span class=md-ellipsis> Firmware Metadata </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/55-gateway-spc-chip-replacement/ class=md-nav__link> <span class=md-ellipsis> SPC Chip Replacement </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> MCU Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> MCU Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mcu/24-vcsec-key-programming/ class=md-nav__link> <span class=md-ellipsis> VCSEC Key Programming </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/25-mcu-boot-sequence.md class=md-nav__link> <span class=md-ellipsis> Boot Sequence </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/28-can-flood-refined-timing/ class=md-nav__link> <span class=md-ellipsis> CAN Flood Timing </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/31-apparmor-sandbox-security/ class=md-nav__link> <span class=md-ellipsis> AppArmor Sandbox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Evidence & Audit </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Evidence & Audit </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-nav__link> <span class=md-ellipsis> Evidence Audit </span> </a> </li> <li class=md-nav__item> <a href=../../VERIFICATION-STATUS/ class=md-nav__link> <span class=md-ellipsis> Verification Status </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Tools & Scripts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Tools & Scripts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/56-gateway-factory-gate-REAL/ class=md-nav__link> <span class=md-ellipsis> Gateway Factory Gate </span> </a> </li> <li class=md-nav__item> <a href=../../SCRIPTS/ class=md-nav__link> <span class=md-ellipsis> Download Scripts </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=tesla-mcu2-network-architecture-port-reference>Tesla MCU2 Network Architecture &amp; Port Reference</h1> <p><strong>Document Version:</strong> 1.0<br> <strong>Last Updated:</strong> February 2, 2026<br> <strong>Vehicle Platform:</strong> Model S/X MCU2 (2024.x firmware)<br> <strong>Source Analysis:</strong> <code>/firmware/firewall-analysis-report.md</code></p> <hr> <h2 id=table-of-contents>Table of Contents</h2> <ol> <li><a href=#network-topology>Network Topology</a></li> <li><a href=#critical-ports--services>Critical Ports &amp; Services</a></li> <li><a href=#internal-network-map>Internal Network Map</a></li> <li><a href=#complete-port-matrix>Complete Port Matrix</a></li> <li><a href=#firewall-rules-analysis>Firewall Rules Analysis</a></li> <li><a href=#service-dependencies>Service Dependencies</a></li> <li><a href=#attack-surface-diagram>Attack Surface Diagram</a></li> <li><a href=#security-recommendations>Security Recommendations</a></li> </ol> <hr> <h2 id=network-topology>Network Topology</h2> <h3 id=physical-network-architecture>Physical Network Architecture</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>â”‚                    192.168.90.0/24 - Vehicle Network            â”‚
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>â”‚                                                                   â”‚
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>â”‚  â”‚   Gateway    â”‚      â”‚   MCU2 ICE   â”‚      â”‚  Autopilot   â”‚  â”‚
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>â”‚  â”‚ .90.102      â”‚â—„â”€â”€â”€â”€â–ºâ”‚  .90.100     â”‚â—„â”€â”€â”€â”€â–ºâ”‚  APE .103    â”‚  â”‚
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>â”‚  â”‚              â”‚      â”‚  (THIS)      â”‚      â”‚  APE .105    â”‚  â”‚
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>â”‚                               â”‚                                  â”‚
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>â”‚                               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>â”‚  â”‚    Modem     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â–ºâ”‚   Tuner    â”‚ â”‚
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>â”‚  â”‚  .90.60      â”‚                               â”‚  .90.30    â”‚ â”‚
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>â”‚  â”‚ (CELLULAR)   â”‚                               â”‚  (RADIO)   â”‚ â”‚
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>â”‚         â–²                                                        â”‚
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>          â”‚
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>          â”‚ Cellular Network
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>          â–¼
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>   â”‚    Tesla     â”‚
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>   â”‚   Servers    â”‚
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div> <h3 id=network-interfaces>Network Interfaces</h3> <h4 id=eth0-primary-vehicle-network><strong>eth0</strong> - Primary Vehicle Network</h4> <ul> <li><strong>Network:</strong> 192.168.90.0/24</li> <li><strong>Purpose:</strong> Inter-ECU communication backbone</li> <li><strong>Security:</strong> Internal only, firewall-protected</li> </ul> <h4 id=wlan0-wifi-interface><strong>wlan0</strong> - WiFi Interface</h4> <ul> <li><strong>Network:</strong> Variable (user/Tesla WiFi)</li> <li><strong>Purpose:</strong> User connectivity, over-the-air updates</li> <li><strong>Security:</strong> Restricted services, 10.0.0.0/8 filtering</li> </ul> <h4 id=eth02-vlan-2><strong>eth0.2</strong> - VLAN 2</h4> <ul> <li><strong>Purpose:</strong> Isolated radio services</li> <li><strong>Security:</strong> Separate segment for Harman tuner</li> </ul> <h4 id=lo-loopback-127001><strong>lo</strong> - Loopback (127.0.0.1)</h4> <ul> <li><strong>Purpose:</strong> Inter-process communication</li> <li><strong>Security:</strong> Local only</li> </ul> <hr> <h2 id=critical-ports-services>Critical Ports &amp; Services</h2> <h3 id=critical-risk-ports>ğŸ”´ CRITICAL RISK PORTS</h3> <h4 id=port-49503-tcp-modem-update-server><strong>Port 49503 TCP - Modem Update Server</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>Service:  modem-update-server
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>Access:   192.168.90.60 (Modem) â†’ 192.168.90.100 (MCU)
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>Protocol: HTTP
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>Risk:     CRITICAL - Direct firmware update path
</code></pre></div> <p><strong>Attack Vector:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>Compromise Modem â†’ Access Port 49503 â†’ Push Malicious Firmware
</code></pre></div></p> <p><strong>Firewall Rules:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>-A<span class=w> </span>MODEM_INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.60<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>--dport<span class=w> </span><span class=m>49503</span><span class=w> </span>-j<span class=w> </span>ACCEPT
</code></pre></div></p> <p><strong>Mitigation:</strong> Requires cryptographic signature verification on all updates.</p> <hr> <h4 id=ports-80443-tcp-httphttps-unrestricted><strong>Ports 80/443 TCP - HTTP/HTTPS (UNRESTRICTED)</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>Service:  connmand, qtcar, qtcar-connman
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>Access:   NO SOURCE RESTRICTIONS (!)
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>Protocol: HTTP/HTTPS
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>Risk:     HIGH - Potential external exposure
</code></pre></div> <p><strong>Firewall Rules:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>-A<span class=w> </span>CONNMAND<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>-A<span class=w> </span>QTCAR_CLUSTER<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-m<span class=w> </span>multiport<span class=w> </span>--dport<span class=w> </span><span class=m>80</span>,443<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>-A<span class=w> </span>QTCAR-CONNMAN<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>ACCEPT
</code></pre></div></p> <p><strong>Issue:</strong> No <code>-s</code> (source) restriction. Could accept from ANY interface if routing allows.</p> <p><strong>Recommendation:</strong> Add source filtering: <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>-A<span class=w> </span>CONNMAND<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.0/24<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>ACCEPT
</code></pre></div></p> <hr> <h3 id=high-risk-ports>ğŸŸ  HIGH RISK PORTS</h3> <h4 id=port-25956-tcp-updater-shell><strong>Port 25956 TCP - Updater Shell</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>Service:  updater-shell
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>Access:   Internal network
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>Protocol: Shell/TCP
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>Risk:     HIGH - Direct shell access, CAN flood trigger
</code></pre></div> <p><strong>Context:</strong> This port was discovered as part of the CAN flood vulnerability. Opening this port triggers system stress.</p> <hr> <h4 id=port-20564-tcp-sx-updater-http><strong>Port 20564 TCP - SX-Updater HTTP</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>Service:  sx-updater
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>Access:   192.168.90.30 (Tuner)
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>Protocol: HTTP
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>Risk:     HIGH - syncterm exploit trigger
</code></pre></div> <p><strong>Context:</strong> Accessing this service can trigger system instability (syncterm/valhalla-ctrl crashes).</p> <hr> <h4 id=ports-4030-tcp-toolbox-api><strong>Ports 4030+ TCP - Toolbox API</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>Service:  toolbox-api (diagnostics)
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>Access:   192.168.90.103, .105 (Autopilot only)
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>Protocol: HTTP/JSON API
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>Risk:     HIGH - System diagnostics &amp; control
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>Status:   âš ï¸ REMOVED IN MODEL 3/Y FIRMWARE
</code></pre></div> <p><strong>Accessible Ports:</strong> - 4030: APE/DRM/Video services - 4035: Mount daemon - 4050: Audio daemon<br> - 4060: Connection manager - 4090, 4094: Bluetooth services - 7654: Monitor service</p> <p><strong>Firewall Rules:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>-A<span class=w> </span>INPUT<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>-m<span class=w> </span>multiport<span class=w> </span>--dports<span class=w> </span><span class=m>4030</span>,4035,4050,4060,4090,4094,7654<span class=w> </span>-j<span class=w> </span>TOOLBOX-API-INPUT
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>-A<span class=w> </span>TOOLBOX-API-INPUT<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.103,192.168.90.105<span class=w> </span>-j<span class=w> </span>TOOLBOX-API-APE-INPUT
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>-A<span class=w> </span>TOOLBOX-API-APE-INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>4030</span><span class=w> </span>-j<span class=w> </span>ACCEPT
</code></pre></div></p> <p><strong>Note:</strong> Tesla removed this service in Model 3/Y firmware, recognizing the security risk.</p> <hr> <h3 id=medium-risk-ports>ğŸŸ¡ MEDIUM RISK PORTS</h3> <h4 id=port-8081-tcp-service-shell><strong>Port 8081 TCP - Service Shell</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>Service:  service-shell
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>Access:   Internal network (restricted)
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>Protocol: Shell/Diagnostics
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>Risk:     MEDIUM - Diagnostic interface
</code></pre></div> <p><strong>Firewall Rules:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>-A<span class=w> </span>INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>8081</span><span class=w> </span>-j<span class=w> </span>SERVICE-SHELL-INPUT
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=c1># Explicitly BLOCKS:</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.30,192.168.90.60<span class=w> </span>-j<span class=w> </span>REJECT<span class=w>  </span><span class=c1># Tuner, Modem</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.101-107<span class=w> </span>-j<span class=w> </span>REJECT<span class=w>          </span><span class=c1># All computers</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=c1># Allows:</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.0/24<span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>     </span><span class=c1># Other ECUs</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-i<span class=w> </span>lo<span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>                          </span><span class=c1># Localhost</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-j<span class=w> </span>REJECT<span class=w>                                </span><span class=c1># Default deny</span>
</code></pre></div></p> <p><strong>Security Posture:</strong> Reasonably well-restricted, but exploitable if attacker gains access to an allowed ECU.</p> <hr> <h4 id=port-8901-tcp-provisioning-api-iris-api><strong>Port 8901 TCP - Provisioning API / iris-api</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>Service:  iris-api, ape-deliver
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>Access:   Multiple sources (modem return traffic, APE)
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>Protocol: HTTP/JSON API
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>Risk:     MEDIUM - Provisioning &amp; control
</code></pre></div> <hr> <h4 id=port-3500-udp-gateway-udpapi><strong>Port 3500 UDP - Gateway UDPAPI</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>Service:  gateway-udpapi
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>Access:   Internal network
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>Protocol: UDP
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>Risk:     MEDIUM - Real-time vehicle data
</code></pre></div> <hr> <h4 id=port-8080-tcp-firmware-server-service-ui><strong>Port 8080 TCP - Firmware Server / Service UI</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>Service:  Service UI HTTP, local webserver
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>Access:   Internal
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>Protocol: HTTP
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>Risk:     MEDIUM - Local web interface
</code></pre></div> <hr> <h2 id=internal-network-map>Internal Network Map</h2> <h3 id=ip-address-allocation-19216890024>IP Address Allocation (192.168.90.0/24)</h3> <table> <thead> <tr> <th>IP Address</th> <th>Component</th> <th>Function</th> <th>Attack Surface</th> </tr> </thead> <tbody> <tr> <td><strong>192.168.90.100</strong></td> <td><strong>MCU2 ICE</strong></td> <td><strong>Infotainment, Primary System</strong></td> <td><strong>HIGH</strong></td> </tr> <tr> <td>192.168.90.102</td> <td>Gateway</td> <td>Logging, system coordination</td> <td>Medium</td> </tr> <tr> <td>192.168.90.103</td> <td>Autopilot APE #1</td> <td>Self-driving computer</td> <td>HIGH</td> </tr> <tr> <td>192.168.90.105</td> <td>Autopilot APE #2</td> <td>Self-driving computer</td> <td>HIGH</td> </tr> <tr> <td>192.168.90.60</td> <td>Cellular Modem</td> <td><strong>External connectivity</strong></td> <td><strong>CRITICAL</strong></td> </tr> <tr> <td>192.168.90.30</td> <td>Tuner/Radio</td> <td>Harman entertainment system</td> <td>Medium</td> </tr> <tr> <td>192.168.90.101</td> <td>ECU (various)</td> <td>Vehicle control units</td> <td>Low</td> </tr> <tr> <td>192.168.90.104</td> <td>ECU (various)</td> <td>Vehicle control units</td> <td>Low</td> </tr> <tr> <td>192.168.90.106</td> <td>ECU (various)</td> <td>Vehicle control units</td> <td>Low</td> </tr> <tr> <td>192.168.90.107</td> <td>ECU (various)</td> <td>Vehicle control units</td> <td>Low</td> </tr> </tbody> </table> <h3 id=trust-boundaries>Trust Boundaries</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>â”‚                 TRUSTED ZONE                        â”‚
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>â”‚  â”‚  MCU2    â”‚  â”‚ Gateway  â”‚  â”‚ ECU .101 â”‚         â”‚
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>â”‚  â”‚ .90.100  â”‚  â”‚ .90.102  â”‚  â”‚ .104/.106â”‚         â”‚
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>          â–²                â–²
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>          â”‚ Partial Trust  â”‚
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>          â–¼                â–¼
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>â”‚            SEMI-TRUSTED ZONE                        â”‚
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>â”‚  â”‚ Autopilotâ”‚            â”‚  Tuner   â”‚              â”‚
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>â”‚  â”‚APE .103  â”‚            â”‚  .90.30  â”‚              â”‚
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>â”‚  â”‚    .105  â”‚            â”‚          â”‚              â”‚
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>                    â–²
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>                    â”‚ UNTRUSTED
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>                    â–¼
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>         â”‚   Cellular Modem â”‚
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>         â”‚     .90.60       â”‚
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>         â”‚   (EXTERNAL)     â”‚
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a>         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div> <p><strong>Key Insights:</strong> - <strong>Modem (.60)</strong> is UNTRUSTED - has most restrictions, but still dangerous access - <strong>Autopilot (.103/.105)</strong> is SEMI-TRUSTED - extensive access to MCU services - <strong>Tuner (.30)</strong> is SEMI-TRUSTED - limited access, blocked from sensitive services - <strong>Gateway &amp; ECUs</strong> are TRUSTED - full internal network access</p> <hr> <h2 id=complete-port-matrix>Complete Port Matrix</h2> <h3 id=mcu2-19216890100-listening-services>MCU2 (192.168.90.100) - Listening Services</h3> <h4 id=external-facing-eth0-ports>External-Facing (eth0) Ports</h4> <table> <thead> <tr> <th>Port(s)</th> <th>Proto</th> <th>Service</th> <th>Source Allowed</th> <th>Auth</th> <th>Risk</th> </tr> </thead> <tbody> <tr> <td>80, 443</td> <td>TCP</td> <td>HTTP/HTTPS (connmand, qtcar)</td> <td><strong>UNRESTRICTED</strong></td> <td>None</td> <td>ğŸ”´ HIGH</td> </tr> <tr> <td>49503</td> <td>TCP</td> <td>Modem Update Server</td> <td>192.168.90.60 only</td> <td>None</td> <td>ğŸ”´ CRITICAL</td> </tr> <tr> <td>8081</td> <td>TCP</td> <td>Service Shell</td> <td>Internal network (restricted)</td> <td>Limited</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>4030,4035,4050,4060,4090,4094,7654</td> <td>TCP</td> <td>Toolbox API</td> <td>APE .103/.105 only</td> <td>None</td> <td>ğŸŸ  HIGH</td> </tr> <tr> <td>8901</td> <td>TCP</td> <td>iris-api / ape-deliver</td> <td>APE, Modem (return)</td> <td>Token?</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>3500</td> <td>UDP</td> <td>Gateway UDPAPI</td> <td>Internal</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>8080</td> <td>TCP</td> <td>Service UI HTTP</td> <td>Internal</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>53</td> <td>TCP/UDP</td> <td>DNS (dnsmasq)</td> <td>Internal</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>67</td> <td>UDP</td> <td>DHCP (connmand)</td> <td>Internal</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>123</td> <td>UDP</td> <td>NTP</td> <td>Internal/Modem</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>5801</td> <td>TCP/UDP</td> <td>linuxvm-logger</td> <td>Modem .60</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50960</td> <td>TCP</td> <td>modemvm-logger</td> <td>Modem .60</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50666</td> <td>TCP</td> <td>mqtt-logger</td> <td>Modem .60</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50877</td> <td>TCP</td> <td>mqtt-config</td> <td>Modem .60</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50950</td> <td>TCP</td> <td>AT Commands (modem control)</td> <td>Modem .60 (return)</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>7891</td> <td>TCP</td> <td>RIL over TCP</td> <td>Modem .60 (return)</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50911, 50101</td> <td>TCP</td> <td>ecall-server (emergency call)</td> <td>Modem .60</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>20564</td> <td>TCP</td> <td>Tuner control</td> <td>Tuner .30</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>5555</td> <td>TCP</td> <td>Tuner service</td> <td>Tuner .30 (both)</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>30490</td> <td>UDP</td> <td>Radio data</td> <td>Tuner .30</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>69</td> <td>UDP</td> <td>TFTP (updater)</td> <td>Tuner .30</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>4599</td> <td>UDP</td> <td>Tuner sync</td> <td>Tuner .30</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>5354</td> <td>UDP</td> <td>mDNS</td> <td>APE .103/.105</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> </tbody> </table> <h4 id=outbound-connection-ports-mcu-others>Outbound Connection Ports (MCU â†’ Others)</h4> <table> <thead> <tr> <th>Dest Port(s)</th> <th>Proto</th> <th>Dest IP</th> <th>Service</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td>8443,8444,8885,8888,19004</td> <td>TCP</td> <td>APE .103/.105</td> <td>Autopilot API</td> <td>Autopilot control</td> </tr> <tr> <td>9892-9900</td> <td>TCP</td> <td>APE .103/.105</td> <td>Dashcam</td> <td>Video recording</td> </tr> <tr> <td>8082,8088,8888</td> <td>TCP</td> <td>APE .103/.105</td> <td>qtcar</td> <td>Qt services</td> </tr> <tr> <td>8610,8906,8611</td> <td>UDP</td> <td>APE .103/.105</td> <td>UDP services</td> <td>Real-time data</td> </tr> <tr> <td>443</td> <td>TCP</td> <td>10.0.0.0/8 via wlan0</td> <td>HTTPS</td> <td>Autopilot API (WiFi)</td> </tr> <tr> <td>30508-30513</td> <td>TCP</td> <td>Tuner .30</td> <td>Tuner streams</td> <td>Audio streaming</td> </tr> <tr> <td>30520,30530</td> <td>TCP</td> <td>Tuner .30</td> <td>Radio services</td> <td>Radio control</td> </tr> <tr> <td>2345</td> <td>TCP</td> <td>Tuner .30 (return)</td> <td>Debug interface</td> <td>Debugging</td> </tr> <tr> <td>22</td> <td>TCP</td> <td>Modem .60, Tuner .30 (return)</td> <td>SSH</td> <td>Remote access (return)</td> </tr> <tr> <td>6789</td> <td>TCP</td> <td>Tesla servers</td> <td>Updater-Envoy</td> <td>OTA updates</td> </tr> </tbody> </table> <h4 id=localhost-services-127001>Localhost Services (127.0.0.1)</h4> <table> <thead> <tr> <th>Port</th> <th>Service</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td>4030</td> <td>APE/DRM/Video/Webcam</td> <td>Multimedia services</td> </tr> <tr> <td>4035</td> <td>Mount daemon</td> <td>Filesystem management</td> </tr> <tr> <td>4050</td> <td>Audio daemon</td> <td>Audio control</td> </tr> <tr> <td>4060</td> <td>Connection manager</td> <td>Network management</td> </tr> <tr> <td>4070</td> <td>Bluetooth</td> <td>BT services</td> </tr> <tr> <td>4090, 4094, 4096</td> <td>Bluetooth services</td> <td>Additional BT functionality</td> </tr> <tr> <td>4220</td> <td>Spotify</td> <td>Music streaming</td> </tr> <tr> <td>4400</td> <td>Autopilot API</td> <td>Local autopilot interface</td> </tr> <tr> <td>4567</td> <td>Download services</td> <td>OTA content (manual, release notes, TTS)</td> </tr> <tr> <td>8000-8002</td> <td>Service UI, Valhalla API</td> <td>System UI</td> </tr> <tr> <td>8080</td> <td>Service UI HTTP</td> <td>Web interface</td> </tr> <tr> <td>9000-9006</td> <td>Media adapters</td> <td>Content delivery</td> </tr> <tr> <td>18466</td> <td>Audio daemon</td> <td>Secondary audio interface</td> </tr> <tr> <td>49503</td> <td>Modem update server</td> <td>Update interface (also on eth0)</td> </tr> <tr> <td>49505, 49507</td> <td>Release notes, owners manual</td> <td>Documentation HTTP servers</td> </tr> </tbody> </table> <hr> <h2 id=firewall-rules-analysis>Firewall Rules Analysis</h2> <h3 id=rule-files-84-total-from-etcfirewalld>Rule Files (84 total from <code>/etc/firewall.d/</code>)</h3> <h4 id=critical-service-rules>Critical Service Rules</h4> <p><strong>connmand.iptables</strong> - Connection Manager <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>-A<span class=w> </span>CONNMAND<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>              </span><span class=c1># âš ï¸ UNRESTRICTED HTTP</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>-A<span class=w> </span>CONNMAND<span class=w> </span>-p<span class=w> </span>udp<span class=w> </span>-m<span class=w> </span>multiport<span class=w> </span>--dports<span class=w> </span><span class=m>53</span>,67<span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>  </span><span class=c1># DNS + DHCP</span>
</code></pre></div></p> <p><strong>modem.iptables</strong> - Cellular Modem Access <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>-A<span class=w> </span>MODEM_INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.60<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>--dport<span class=w> </span><span class=m>49503</span><span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>  </span><span class=c1># ğŸ”´ UPDATE SERVER</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>-A<span class=w> </span>MODEM_INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.60<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>--dport<span class=w> </span><span class=m>5801</span><span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>   </span><span class=c1># Logger</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>-A<span class=w> </span>MODEM_INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.60<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>--dport<span class=w> </span><span class=m>50960</span><span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>  </span><span class=c1># Modem VM logger</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>-A<span class=w> </span>MODEM_INPUT<span class=w> </span>-p<span class=w> </span>udp<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.60<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>--dport<span class=w> </span><span class=m>123</span><span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>    </span><span class=c1># NTP</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>-A<span class=w> </span>MODEM_INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-m<span class=w> </span>state<span class=w> </span>--state<span class=w> </span>ESTABLISHED<span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>  </span><span class=c1># Return traffic (TCUD, iris-api, AT, RIL, ecall)</span>
</code></pre></div></p> <p><strong>service-shell.iptables</strong> - Diagnostic Shell <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>-A<span class=w> </span>INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>8081</span><span class=w> </span>-j<span class=w> </span>SERVICE-SHELL-INPUT
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.30,192.168.90.60<span class=w> </span>-j<span class=w> </span>REJECT<span class=w>                    </span><span class=c1># Block tuner, modem</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.101,192.168.90.102,192.168.90.103,192.168.90.104,192.168.90.105,192.168.90.106,192.168.90.107<span class=w> </span>-j<span class=w> </span>REJECT<span class=w>  </span><span class=c1># Block all computers</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.0/24<span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>  </span><span class=c1># Allow other internal devices</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-i<span class=w> </span>lo<span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>                       </span><span class=c1># Allow localhost</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>-A<span class=w> </span>SERVICE-SHELL-INPUT<span class=w> </span>-j<span class=w> </span>REJECT<span class=w>                             </span><span class=c1># Default deny</span>
</code></pre></div></p> <p><strong>toolbox-api.iptables</strong> - System Diagnostics (MCU2 only) <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>-A<span class=w> </span>INPUT<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>-m<span class=w> </span>multiport<span class=w> </span>--dports<span class=w> </span><span class=m>4030</span>,4035,4050,4060,4090,4094,7654<span class=w> </span>-j<span class=w> </span>TOOLBOX-API-INPUT
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>-A<span class=w> </span>TOOLBOX-API-INPUT<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.103,192.168.90.105<span class=w> </span>-j<span class=w> </span>TOOLBOX-API-APE-INPUT<span class=w>  </span><span class=c1># Only autopilot</span>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>-A<span class=w> </span>TOOLBOX-API-APE-INPUT<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>4030</span><span class=w> </span>-j<span class=w> </span>ACCEPT
</code></pre></div> <strong>Status:</strong> âš ï¸ <strong>Removed in Model 3/Y firmware</strong> (security improvement)</p> <p><strong>qtcar.iptables / qtcar-connman.iptables</strong> - Qt Car UI <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>-A<span class=w> </span>QTCAR_CLUSTER<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-m<span class=w> </span>multiport<span class=w> </span>--dport<span class=w> </span><span class=m>80</span>,443<span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>  </span><span class=c1># âš ï¸ UNRESTRICTED HTTPS</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>-A<span class=w> </span>QTCAR-CONNMAN<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>ACCEPT<span class=w>                   </span><span class=c1># âš ï¸ UNRESTRICTED HTTP</span>
</code></pre></div></p> <p><strong>harman-tuner.iptables</strong> - Radio/Tuner Access <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>-A<span class=w> </span>HARMAN_TUNER<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.30<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>--dport<span class=w> </span><span class=m>20564</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>-A<span class=w> </span>HARMAN_TUNER<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.30<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>--dport<span class=w> </span><span class=m>5555</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=c1># ... various other tuner-specific ports</span>
</code></pre></div></p> <p><strong>updater-envoy.iptables</strong> - OTA Update Client <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>-A<span class=w> </span>UPDATER_ENVOY<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-m<span class=w> </span>tcp<span class=w> </span>--sport<span class=w> </span><span class=m>6789</span><span class=w> </span>-m<span class=w> </span>conntrack<span class=w> </span>--ctstate<span class=w> </span>ESTABLISHED<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>-A<span class=w> </span>OUTPUT<span class=w> </span>-m<span class=w> </span>owner<span class=w> </span>--uid-owner<span class=w> </span>envoy<span class=w> </span>-j<span class=w> </span>UPDATER_ENVOY
</code></pre></div> âœ… <strong>Secure design:</strong> Outbound-only, ESTABLISHED state</p> <hr> <h3 id=modem-access-matrix>Modem Access Matrix</h3> <p>Complete matrix of what the <strong>Cellular Modem (192.168.90.60)</strong> can access on <strong>MCU (192.168.90.100)</strong>:</p> <table> <thead> <tr> <th>Port</th> <th>Proto</th> <th>Direction</th> <th>Service</th> <th>Auth</th> <th>Risk Level</th> </tr> </thead> <tbody> <tr> <td>49503</td> <td>TCP</td> <td>INPUT</td> <td><strong>Modem Update Server</strong></td> <td>None</td> <td>ğŸ”´ <strong>CRITICAL</strong></td> </tr> <tr> <td>5801</td> <td>TCP+UDP</td> <td>INPUT</td> <td>linuxvm-logger</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50960</td> <td>TCP</td> <td>INPUT</td> <td>modemvm-logger</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>123</td> <td>UDP</td> <td>INPUT</td> <td>NTP</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>38888</td> <td>TCP</td> <td>RETURN</td> <td>TCUD (return traffic)</td> <td>?</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>8901</td> <td>TCP</td> <td>RETURN</td> <td>iris-api (return traffic)</td> <td>Token?</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50666</td> <td>TCP</td> <td>RETURN</td> <td>mqtt-logger</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50877</td> <td>TCP</td> <td>RETURN</td> <td>mqtt-config</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>7891</td> <td>TCP</td> <td>RETURN</td> <td>RIL over TCP</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50950</td> <td>TCP</td> <td>RETURN</td> <td>AT Commands</td> <td>None</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>50911, 50101</td> <td>TCP</td> <td>RETURN</td> <td>ecall-server</td> <td>None</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>22</td> <td>TCP</td> <td>RETURN</td> <td>SSH (return traffic)</td> <td>Key</td> <td>ğŸŸ¡ MEDIUM</td> </tr> </tbody> </table> <p><strong>Notes:</strong> - <strong>RETURN</strong> = ESTABLISHED state only (MCU initiates, safer) - <strong>INPUT</strong> = Modem can initiate connection (higher risk) - <strong>Port 49503</strong> is the most dangerous - direct update path</p> <hr> <h3 id=autopilot-access-matrix>Autopilot Access Matrix</h3> <p>Complete matrix of what <strong>Autopilot APE (192.168.90.103, .105)</strong> can access on <strong>MCU (192.168.90.100)</strong>:</p> <h4 id=ape-mcu-autopilot-can-access>APE â†’ MCU (Autopilot can access)</h4> <table> <thead> <tr> <th>Port(s)</th> <th>Proto</th> <th>Service</th> <th>Purpose</th> <th>Risk</th> </tr> </thead> <tbody> <tr> <td>4030</td> <td>TCP</td> <td>Toolbox API</td> <td>System diagnostics (MCU2 only)</td> <td>ğŸŸ  HIGH</td> </tr> <tr> <td>8901</td> <td>TCP</td> <td>APE-DELIVER</td> <td>Data delivery from APE</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>5354</td> <td>UDP</td> <td>mDNS</td> <td>Service discovery</td> <td>ğŸŸ¢ LOW</td> </tr> </tbody> </table> <h4 id=mcu-ape-mcu-can-access>MCU â†’ APE (MCU can access)</h4> <table> <thead> <tr> <th>Port(s)</th> <th>Proto</th> <th>Service</th> <th>Purpose</th> <th>Risk</th> </tr> </thead> <tbody> <tr> <td>8443, 8444, 8885, 8888, 19004</td> <td>TCP</td> <td>Autopilot API</td> <td>Autopilot control &amp; telemetry</td> <td>ğŸŸ  HIGH</td> </tr> <tr> <td>9892-9900</td> <td>TCP</td> <td>Dashcam</td> <td>Video recording services</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>8082, 8088, 8888</td> <td>TCP</td> <td>qtcar</td> <td>Qt car UI services</td> <td>ğŸŸ¢ LOW</td> </tr> <tr> <td>8610, 8906, 8611</td> <td>UDP</td> <td>Real-time services</td> <td>Live data streams</td> <td>ğŸŸ¡ MEDIUM</td> </tr> <tr> <td>443</td> <td>TCP</td> <td>HTTPS (over wlan0)</td> <td>WiFi-based API (10.0.0.0/8)</td> <td>ğŸŸ¡ MEDIUM</td> </tr> </tbody> </table> <p><strong>Security Concern:</strong> Bidirectional trust between MCU and APE. Compromise of either enables lateral movement to the other.</p> <hr> <h2 id=service-dependencies>Service Dependencies</h2> <h3 id=critical-service-chains>Critical Service Chains</h3> <h4 id=ota-update-chain><strong>OTA Update Chain</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>Tesla Server â†’ Cellular Network â†’ Modem (.60) â†’ [Port 49503] â†’ modem-update-server â†’ MCU Firmware
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>                                                 [Port 6789] â† updater-envoy â† Tesla Server
</code></pre></div> <p><strong>Vulnerabilities:</strong> - Port 49503 allows modem to push updates (no signature verification visible) - Port 6789 is safer (outbound-only, ESTABLISHED state)</p> <hr> <h4 id=autopilot-integration-chain><strong>Autopilot Integration Chain</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>Autopilot APE (.103/.105) â†â†’ [Ports 8443,8888,etc] â†â†’ MCU (.100)
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>                         â†â†’ [Port 4030 Toolbox API] â†â†’ MCU (MCU2 only)
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>                         â†â†’ [Port 9892-9900 Dashcam] â†â†’ MCU
</code></pre></div> <p><strong>Vulnerabilities:</strong> - Toolbox API (port 4030) provides deep system access to APE - Removed in Model 3/Y (security improvement) - Dashcam services create data flow from MCU â†’ APE</p> <hr> <h4 id=radioentertainment-chain><strong>Radio/Entertainment Chain</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>Tuner (.30) â†â†’ [Ports 20564, 5555, 30508-30513, etc] â†â†’ MCU (.100)
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>            â†â†’ [Port 69 TFTP] â†â†’ MCU (updater only)
</code></pre></div> <p><strong>Vulnerabilities:</strong> - Port 20564 is the <code>syncterm</code> exploit trigger - TFTP (port 69) provides another update path (restricted to updater service)</p> <hr> <h4 id=logging-chain><strong>Logging Chain</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a>Modem (.60) â†’ [Ports 5801, 50960, 50666] â†’ Logging services â†’ MCU (.100)
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>                                                            â†“
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>                                                     Gateway (.102)
</code></pre></div> <p><strong>Vulnerabilities:</strong> - MQTT services (50666, 50877) could be exploited for command injection - Extensive logging creates data exfiltration risk</p> <hr> <h3 id=service-startup-dependencies>Service Startup Dependencies</h3> <p>Based on <code>/etc/sv/</code> analysis:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>1. Basic System
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>   â”œâ”€ firewall-setup â†’ All services (required first)
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>   â”œâ”€ dnsmasq â†’ Network services
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>   â””â”€ connmand â†’ Network connectivity
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>2. Update Services
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>   â”œâ”€ updater-envoy (outbound, safe)
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>   â”œâ”€ modem-update-server (inbound, CRITICAL)
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>   â”œâ”€ sx-updater (file-based)
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>   â””â”€ gadget-updater (file-based)
<a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>
<a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>3. Communication
<a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>   â”œâ”€ mqtt-logger (port 50666)
<a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a>   â”œâ”€ mqtt-config (port 50877)
<a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>   â””â”€ tcud (Tesla Control Unit Daemon)
<a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a>
<a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>4. Autopilot Integration
<a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>   â”œâ”€ ape-deliver (port 8901)
<a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>   â””â”€ toolbox-api (ports 4030+, MCU2 only)
<a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a>
<a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a>5. Entertainment
<a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>   â”œâ”€ radioserver
<a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a>   â”œâ”€ harman-tuner
<a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a>   â””â”€ qtcar services
</code></pre></div> <hr> <h2 id=attack-surface-diagram>Attack Surface Diagram</h2> <h3 id=attack-surface-by-network-interface>Attack Surface by Network Interface</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>â”‚                         EXTERNAL                               â”‚
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a>â”‚                                                                 â”‚
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a>â”‚  â”‚   Cellular Network      â”‚                                  â”‚
<a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a>â”‚  â”‚   (Internet)            â”‚                                  â”‚
<a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
<a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>â”‚               â”‚                                                 â”‚
<a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a>â”‚               â–¼                                                 â”‚
<a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
<a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a>â”‚  â”‚   Modem (192.168.90.60) â”‚ â—„â”€â”€â”€ UNTRUSTED                   â”‚
<a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a>â”‚  â”‚   Attack Surface: HIGH  â”‚                                   â”‚
<a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
<a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a>                â”‚
<a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a>                â”‚ Filtered via modem.iptables
<a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a>                â–¼
<a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a>â”‚                       VEHICLE NETWORK                          â”‚
<a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a>â”‚                      192.168.90.0/24                           â”‚
<a id=__codelineno-29-22 name=__codelineno-29-22 href=#__codelineno-29-22></a>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
<a id=__codelineno-29-23 name=__codelineno-29-23 href=#__codelineno-29-23></a>â”‚                                                                 â”‚
<a id=__codelineno-29-24 name=__codelineno-29-24 href=#__codelineno-29-24></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
<a id=__codelineno-29-25 name=__codelineno-29-25 href=#__codelineno-29-25></a>â”‚  â”‚  MCU2 (192.168.90.100) - PRIMARY TARGET                  â”‚ â”‚
<a id=__codelineno-29-26 name=__codelineno-29-26 href=#__codelineno-29-26></a>â”‚  â”‚  Attack Surface: CRITICAL                                 â”‚ â”‚
<a id=__codelineno-29-27 name=__codelineno-29-27 href=#__codelineno-29-27></a>â”‚  â”‚                                                            â”‚ â”‚
<a id=__codelineno-29-28 name=__codelineno-29-28 href=#__codelineno-29-28></a>â”‚  â”‚  Exposed Services:                                        â”‚ â”‚
<a id=__codelineno-29-29 name=__codelineno-29-29 href=#__codelineno-29-29></a>â”‚  â”‚  ğŸ”´ 49503/tcp - Modem Update Server (CRITICAL)           â”‚ â”‚
<a id=__codelineno-29-30 name=__codelineno-29-30 href=#__codelineno-29-30></a>â”‚  â”‚  ğŸ”´ 80,443/tcp - HTTP/HTTPS (UNRESTRICTED!)              â”‚ â”‚
<a id=__codelineno-29-31 name=__codelineno-29-31 href=#__codelineno-29-31></a>â”‚  â”‚  ğŸŸ  4030+/tcp - Toolbox API (from APE only, MCU2)        â”‚ â”‚
<a id=__codelineno-29-32 name=__codelineno-29-32 href=#__codelineno-29-32></a>â”‚  â”‚  ğŸŸ  8081/tcp - Service Shell (restricted)                â”‚ â”‚
<a id=__codelineno-29-33 name=__codelineno-29-33 href=#__codelineno-29-33></a>â”‚  â”‚  ğŸŸ¡ 8901/tcp - iris-api / ape-deliver                    â”‚ â”‚
<a id=__codelineno-29-34 name=__codelineno-29-34 href=#__codelineno-29-34></a>â”‚  â”‚  ğŸŸ¡ 50666,50877/tcp - MQTT services (from modem)         â”‚ â”‚
<a id=__codelineno-29-35 name=__codelineno-29-35 href=#__codelineno-29-35></a>â”‚  â”‚  ğŸŸ¢ 53,67/udp - DNS/DHCP (internal services)             â”‚ â”‚
<a id=__codelineno-29-36 name=__codelineno-29-36 href=#__codelineno-29-36></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
<a id=__codelineno-29-37 name=__codelineno-29-37 href=#__codelineno-29-37></a>â”‚         â–²                â–²                 â–²                    â”‚
<a id=__codelineno-29-38 name=__codelineno-29-38 href=#__codelineno-29-38></a>â”‚         â”‚                â”‚                 â”‚                    â”‚
<a id=__codelineno-29-39 name=__codelineno-29-39 href=#__codelineno-29-39></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”            â”‚
<a id=__codelineno-29-40 name=__codelineno-29-40 href=#__codelineno-29-40></a>â”‚  â”‚ Autopilot  â”‚   â”‚   Tuner     â”‚   â”‚  Gateway  â”‚            â”‚
<a id=__codelineno-29-41 name=__codelineno-29-41 href=#__codelineno-29-41></a>â”‚  â”‚ APE .103   â”‚   â”‚   .90.30    â”‚   â”‚  .90.102  â”‚            â”‚
<a id=__codelineno-29-42 name=__codelineno-29-42 href=#__codelineno-29-42></a>â”‚  â”‚     .105   â”‚   â”‚             â”‚   â”‚           â”‚            â”‚
<a id=__codelineno-29-43 name=__codelineno-29-43 href=#__codelineno-29-43></a>â”‚  â”‚ SEMI-TRUST â”‚   â”‚ SEMI-TRUST  â”‚   â”‚  TRUSTED  â”‚            â”‚
<a id=__codelineno-29-44 name=__codelineno-29-44 href=#__codelineno-29-44></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
<a id=__codelineno-29-45 name=__codelineno-29-45 href=#__codelineno-29-45></a>â”‚                                                                 â”‚
<a id=__codelineno-29-46 name=__codelineno-29-46 href=#__codelineno-29-46></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div> <h3 id=attack-paths-by-risk>Attack Paths by Risk</h3> <h4 id=critical-attack-paths>ğŸ”´ CRITICAL Attack Paths</h4> <p><strong>Path 1: Cellular â†’ Firmware Compromise</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>Internet â†’ Cellular Modem (.60) â†’ Port 49503 â†’ Modem Update Server â†’ Push Malicious Firmware
</code></pre></div> <strong>Requirements:</strong> Modem exploit<br> <strong>Impact:</strong> Full persistent compromise<br> <strong>Likelihood:</strong> Low | <strong>Impact:</strong> Critical</p> <hr> <p><strong>Path 2: Unrestricted HTTP/HTTPS</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>??? â†’ Port 80/443 â†’ Web Exploit â†’ Code Execution â†’ Lateral Movement
</code></pre></div> <strong>Requirements:</strong> Network access (depends on routing/NAT)<br> <strong>Impact:</strong> Code execution, system compromise<br> <strong>Likelihood:</strong> Medium | <strong>Impact:</strong> High</p> <hr> <h4 id=high-attack-paths>ğŸŸ  HIGH Attack Paths</h4> <p><strong>Path 3: Autopilot â†’ Toolbox API (MCU2 only)</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>Autopilot Exploit â†’ APE .103/.105 â†’ Port 4030+ (Toolbox API) â†’ System Diagnostics â†’ Privilege Escalation
</code></pre></div> <strong>Requirements:</strong> Autopilot vulnerability<br> <strong>Impact:</strong> Deep system access, control<br> <strong>Likelihood:</strong> Medium | <strong>Impact:</strong> High<br> <strong>Status:</strong> âš ï¸ <strong>Mitigated in Model 3/Y</strong> (toolbox-api removed)</p> <hr> <p><strong>Path 4: Modem â†’ MQTT Command Injection</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>Cellular Modem (.60) â†’ Ports 50666/50877 (MQTT) â†’ Command Injection â†’ Code Execution
</code></pre></div> <strong>Requirements:</strong> Modem exploit + MQTT vulnerability<br> <strong>Impact:</strong> Remote code execution<br> <strong>Likelihood:</strong> Low | <strong>Impact:</strong> High</p> <hr> <h4 id=medium-attack-paths>ğŸŸ¡ MEDIUM Attack Paths</h4> <p><strong>Path 5: Physical â†’ CAN â†’ Service Shell</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>Physical Access â†’ OBD-II Port â†’ CAN Injection â†’ Internal Network (.90.x) â†’ Port 8081 (Service Shell) â†’ Diagnostics
</code></pre></div> <strong>Requirements:</strong> Physical access<br> <strong>Impact:</strong> Diagnostic access, limited control<br> <strong>Likelihood:</strong> Medium | <strong>Impact:</strong> Medium</p> <hr> <p><strong>Path 6: Tuner Exploit â†’ Syncterm Trigger</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>Radio Signal â†’ Tuner Exploit â†’ Port 20564 (sx-updater) â†’ syncterm Crash â†’ Denial of Service
</code></pre></div> <strong>Requirements:</strong> Tuner vulnerability<br> <strong>Impact:</strong> System instability<br> <strong>Likelihood:</strong> Low | <strong>Impact:</strong> Medium</p> <hr> <h3 id=defense-in-depth-analysis>Defense in Depth Analysis</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>Layer 1: External (Cellular/WiFi)
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>â”œâ”€ NAT/Routing (assumed)
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>â”œâ”€ Modem isolation (partial)
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>â””â”€ WiFi network segmentation
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a>
<a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a>Layer 2: Firewall (iptables)
<a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a>â”œâ”€ âœ… Modem restrictions (mostly ESTABLISHED state)
<a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>â”œâ”€ âŒ HTTP/HTTPS unrestricted (WEAKNESS)
<a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a>â”œâ”€ âœ… Service shell blocks untrusted ECUs
<a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a>â”œâ”€ âŒ Toolbox API trusts autopilot (WEAKNESS, MCU2)
<a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a>â””â”€ âœ… Most services properly scoped to internal network
<a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a>
<a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a>Layer 3: Service Authentication
<a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a>â”œâ”€ âŒ Most services have NO authentication
<a id=__codelineno-36-15 name=__codelineno-36-15 href=#__codelineno-36-15></a>â”œâ”€ ? iris-api may have token-based auth
<a id=__codelineno-36-16 name=__codelineno-36-16 href=#__codelineno-36-16></a>â”œâ”€ âœ… SSH requires key (return traffic only)
<a id=__codelineno-36-17 name=__codelineno-36-17 href=#__codelineno-36-17></a>â””â”€ âŒ Update server (49503) - no visible auth
<a id=__codelineno-36-18 name=__codelineno-36-18 href=#__codelineno-36-18></a>
<a id=__codelineno-36-19 name=__codelineno-36-19 href=#__codelineno-36-19></a>Layer 4: Application Security
<a id=__codelineno-36-20 name=__codelineno-36-20 href=#__codelineno-36-20></a>â”œâ”€ ? Update signature verification (not visible in firewall)
<a id=__codelineno-36-21 name=__codelineno-36-21 href=#__codelineno-36-21></a>â”œâ”€ ? Input validation on API services
<a id=__codelineno-36-22 name=__codelineno-36-22 href=#__codelineno-36-22></a>â””â”€ ? Exploit mitigations (ASLR, DEP, etc.)
<a id=__codelineno-36-23 name=__codelineno-36-23 href=#__codelineno-36-23></a>
<a id=__codelineno-36-24 name=__codelineno-36-24 href=#__codelineno-36-24></a>Layer 5: Monitoring &amp; Detection
<a id=__codelineno-36-25 name=__codelineno-36-25 href=#__codelineno-36-25></a>â”œâ”€ âœ… Extensive logging (50960, 5801, 50666)
<a id=__codelineno-36-26 name=__codelineno-36-26 href=#__codelineno-36-26></a>â”œâ”€ ? Anomaly detection
<a id=__codelineno-36-27 name=__codelineno-36-27 href=#__codelineno-36-27></a>â””â”€ ? Intrusion detection
</code></pre></div> <p><strong>Overall Assessment:</strong> - <strong>Strong:</strong> Firewall segmentation, logging - <strong>Weak:</strong> Authentication, HTTP/HTTPS exposure, modem update path - <strong>Missing:</strong> Application-layer security details (not visible in firewall analysis)</p> <hr> <h2 id=security-recommendations>Security Recommendations</h2> <h3 id=immediate-actions-high-priority>Immediate Actions (High Priority)</h3> <h4 id=1-restrict-httphttps-ports-80443>1. <strong>Restrict HTTP/HTTPS Ports (80/443)</strong></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=c1># BEFORE (VULNERABLE):</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>-A<span class=w> </span>CONNMAND<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=c1># AFTER (SECURE):</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>-A<span class=w> </span>CONNMAND<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.0/24<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a>-A<span class=w> </span>CONNMAND<span class=w> </span>-i<span class=w> </span>lo<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>-A<span class=w> </span>CONNMAND<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>80</span><span class=w> </span>-j<span class=w> </span>REJECT
</code></pre></div> <h4 id=2-enhance-modem-update-server-security-port-49503>2. <strong>Enhance Modem Update Server Security (Port 49503)</strong></h4> <ul> <li><strong>Add cryptographic signature verification</strong> for all firmware updates</li> <li><strong>Implement rate limiting</strong> on update attempts</li> <li><strong>Add integrity checking</strong> before firmware installation</li> <li><strong>Log all update attempts</strong> with alert on failures</li> </ul> <h4 id=3-backport-model-3y-security-improvements-to-mcu2>3. <strong>Backport Model 3/Y Security Improvements to MCU2</strong></h4> <ul> <li><strong>Remove toolbox-api</strong> (ports 4030+) or add stronger authentication</li> <li><strong>Review and update other changed services</strong> from Model 3/Y firmware</li> </ul> <h4 id=4-implement-mqtt-authentication-ports-5066650877>4. <strong>Implement MQTT Authentication (Ports 50666/50877)</strong></h4> <ul> <li>Add TLS + client certificate authentication</li> <li>Implement message signing</li> <li>Rate limit MQTT messages from modem</li> </ul> <hr> <h3 id=medium-priority>Medium Priority</h3> <h4 id=5-network-segmentation-enhancements>5. <strong>Network Segmentation Enhancements</strong></h4> <ul> <li>Isolate modem on separate VLAN with strict routing rules</li> <li>Separate autopilot network from MCU (if architecturally feasible)</li> <li>Implement network traffic monitoring between segments</li> </ul> <h4 id=6-service-shell-hardening-port-8081>6. <strong>Service Shell Hardening (Port 8081)</strong></h4> <ul> <li>Add authentication (at minimum, shared secret)</li> <li>Implement session logging with alerts</li> <li>Consider removal in production firmware (keep in service mode only)</li> </ul> <h4 id=7-autopilot-api-security>7. <strong>Autopilot API Security</strong></h4> <ul> <li>Audit ports 8443, 8888, 19004 for vulnerabilities</li> <li>Implement mutual TLS between MCU and APE</li> <li>Add input validation and rate limiting</li> </ul> <hr> <h3 id=long-term-improvements>Long-Term Improvements</h3> <h4 id=8-zero-trust-architecture>8. <strong>Zero Trust Architecture</strong></h4> <ul> <li>Implement certificate-based authentication for all inter-ECU communication</li> <li>Deploy microsegmentation with per-service firewall rules</li> <li>Add runtime integrity monitoring</li> </ul> <h4 id=9-secure-update-pipeline>9. <strong>Secure Update Pipeline</strong></h4> <ul> <li>Multi-signature requirement for firmware updates</li> <li>Rollback capability for failed updates</li> <li>Secure boot chain validation</li> </ul> <h4 id=10-monitoring-alerting>10. <strong>Monitoring &amp; Alerting</strong></h4> <ul> <li>Deploy intrusion detection system (IDS) on vehicle network</li> <li>Alert on:</li> <li>Unexpected port 49503 access</li> <li>Service shell access (port 8081)</li> <li>Toolbox API usage (port 4030+, MCU2)</li> <li>Unusual MQTT traffic patterns</li> <li>Failed authentication attempts</li> </ul> <h4 id=11-regular-security-audits>11. <strong>Regular Security Audits</strong></h4> <ul> <li>Quarterly firewall rule reviews</li> <li>Penetration testing of critical services</li> <li>Vulnerability scanning of all network services</li> <li>Third-party security assessments</li> </ul> <hr> <h2 id=appendix-comparison-with-model-3y>Appendix: Comparison with Model 3/Y</h2> <h3 id=removed-services-security-improvements>Removed Services (Security Improvements)</h3> <ul> <li>âœ… <strong>toolbox-api.iptables</strong> - High-risk diagnostic API removed</li> <li>âœ… <strong>ubloxd.iptables</strong> - u-blox GPS daemon removed</li> <li>âœ… <strong>qtcar-cluster.iptables</strong> - Cluster display service refactored</li> </ul> <h3 id=added-services-new-features>Added Services (New Features)</h3> <ul> <li><strong>car-assist.iptables</strong> - Car assistance features</li> <li><strong>lightshow-parser.iptables</strong> - Light show functionality</li> <li><strong>vaultd.iptables</strong> - Vault daemon (credential storage)</li> <li><strong>qtcar-ecallclient.iptables</strong> - Emergency call client</li> </ul> <h3 id=port-changes>Port Changes</h3> <ul> <li><strong>infohealthd:</strong> Port 20100 (MCU2) â†’ Port 4321 (Model 3/Y)</li> </ul> <h3 id=security-posture-evolution>Security Posture Evolution</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a>MCU2 (Model S/X 2024.x)           Model 3/Y (2024.x)
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>â”œâ”€ Toolbox API exposed            â”œâ”€ Toolbox API REMOVED âœ…
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a>â”œâ”€ Port 20100 (infohealthd)       â”œâ”€ Port 4321 (infohealthd)
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>â”œâ”€ More open diagnostic access    â”œâ”€ Tighter access controls
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>â””â”€ Larger attack surface          â””â”€ Reduced attack surface âœ…
</code></pre></div> <p><strong>Recommendation:</strong> Backport Model 3/Y security improvements to MCU2 firmware.</p> <hr> <h2 id=appendix-b-security-platform-gateway-server-comparison>Appendix B: Security Platform Gateway Server Comparison</h2> <h3 id=purpose>Purpose</h3> <p>This section compares the Tesla MCU2 vehicle network architecture with the Security Platform Gateway monitoring server (c.wgg.co) to highlight different security models.</p> <h3 id=security-platform-gateway-network-cwggco>Security Platform Gateway Network (c.wgg.co)</h3> <p><strong>Server Type:</strong> Cloud-based monitoring/gateway (Ubuntu Linux)<br> <strong>Environment:</strong> DigitalOcean VPS (public internet)<br> <strong>Security Model:</strong> Default-deny firewall with selective service exposure</p> <h4 id=network-interfaces-security-platform>Network Interfaces (Security Platform)</h4> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a>eth0:        178.128.115.127/20 (Public Internet)
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>eth0:        10.15.0.5/16 (DigitalOcean anchor)
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a>eth1:        10.130.53.98/16 (Private VPC)
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a>tailscale0:  100.127.14.89/32 (VPN mesh)
<a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a>lo:          127.0.0.1/8 (Localhost)
</code></pre></div> <h4 id=port-matrix-security-platform-vs-tesla-mcu2>Port Matrix (Security Platform vs Tesla MCU2)</h4> <table> <thead> <tr> <th>Port</th> <th>Service</th> <th>Security Platform Status</th> <th>Tesla MCU2 Status</th> <th>Security Comparison</th> </tr> </thead> <tbody> <tr> <td><strong>22</strong></td> <td>SSH</td> <td>âœ… Public (key-auth)</td> <td>âš ï¸ Internal only</td> <td>Security Platform: Remote access required</td> </tr> <tr> <td><strong>80</strong></td> <td>HTTP</td> <td>âœ… Public (allowed)</td> <td>âš ï¸ UNRESTRICTED</td> <td>Both: Need source filtering</td> </tr> <tr> <td><strong>443</strong></td> <td>HTTPS</td> <td>âœ… Public (NGINX)</td> <td>âš ï¸ UNRESTRICTED</td> <td>Both: TLS + auth needed</td> </tr> <tr> <td><strong>631</strong></td> <td>CUPS/IPP</td> <td>ğŸ”´ Public (CRITICAL)</td> <td>âŒ Not present</td> <td>Security Platform: Should disable</td> </tr> <tr> <td><strong>8888</strong></td> <td>Dashboard</td> <td>ğŸŸ¡ Public (JWT+Turnstile)</td> <td>âŒ Not present</td> <td>Security Platform: Monitoring UI</td> </tr> <tr> <td><strong>18789</strong></td> <td>Security Platform API</td> <td>âœ… Localhost only</td> <td>âŒ Not present</td> <td>Good: Internal isolation</td> </tr> <tr> <td><strong>25956</strong></td> <td>Updater Shell</td> <td>âŒ Not present</td> <td>ğŸ”´ Internal (exploit)</td> <td>Tesla: High-risk diagnostic</td> </tr> <tr> <td><strong>49503</strong></td> <td>Update Server</td> <td>âŒ Not present</td> <td>ğŸ”´ Modemâ†’MCU (critical)</td> <td>Tesla: Firmware update path</td> </tr> <tr> <td><strong>4030-7654</strong></td> <td>Toolbox API</td> <td>âŒ Not present</td> <td>ğŸ”´ APEâ†’MCU (removed 3/Y)</td> <td>Tesla: Removed in newer models</td> </tr> <tr> <td><strong>50666/50877</strong></td> <td>MQTT</td> <td>âŒ Not present</td> <td>ğŸŸ¡ Internal logging</td> <td>Tesla: Command injection risk</td> </tr> </tbody> </table> <h4 id=firewall-comparison>Firewall Comparison</h4> <p><strong>Security Platform Gateway (UFW/iptables):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a>Default Policy: DROP (20,419 packets blocked)
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>Allowed Services: 22, 80, 443, 8888 (explicit whitelist)
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a>VPN Integration: Tailscale bypass (authenticated)
</code></pre></div></p> <p><strong>Tesla MCU2 (iptables):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a>Default Policy: DROP
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>Allowed Services: Complex ruleset (84 files)
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a>Network Segments: 192.168.90.0/24 (internal only)
</code></pre></div></p> <h4 id=key-differences>Key Differences</h4> <table> <thead> <tr> <th>Aspect</th> <th>Security Platform Gateway</th> <th>Tesla MCU2</th> </tr> </thead> <tbody> <tr> <td><strong>Threat Model</strong></td> <td>Internet-exposed, public attacks</td> <td>Internal vehicle network, physical proximity</td> </tr> <tr> <td><strong>Authentication</strong></td> <td>JWT, SSH keys, VPN</td> <td>Mostly none (network segmentation)</td> </tr> <tr> <td><strong>Firewall Strategy</strong></td> <td>Minimal exposure</td> <td>Segmented trust zones</td> </tr> <tr> <td><strong>Update Security</strong></td> <td>Package manager (apt)</td> <td>Custom firmware with signing</td> </tr> <tr> <td><strong>Remote Access</strong></td> <td>Required (SSH, VPN)</td> <td>Prohibited (safety-critical)</td> </tr> </tbody> </table> <h4 id=security-lessons>Security Lessons</h4> <p><strong>From Tesla MCU2 â†’ Security Platform:</strong> 1. âœ… <strong>Network segmentation</strong> - Security Platform uses localhost isolation effectively 2. âœ… <strong>Service authentication</strong> - Security Platform requires JWT (Tesla often doesn't) 3. âš ï¸ <strong>CUPS exposure</strong> - Security Platform repeats Tesla's HTTP/HTTPS unrestricted mistake</p> <p><strong>From Security Platform â†’ Tesla MCU2:</strong> 1. âœ… <strong>Strong authentication</strong> - Tesla could benefit from API token systems 2. âœ… <strong>VPN access model</strong> - Tailscale-like secure diagnostics access 3. âœ… <strong>Rate limiting</strong> - Security Platform implements DDoS protection (Tesla should too)</p> <h4 id=additional-ports-found-security-platform-specific>Additional Ports Found (Security Platform-Specific)</h4> <table> <thead> <tr> <th>Port</th> <th>Protocol</th> <th>Service</th> <th>Version</th> <th>Risk</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>53</strong></td> <td>TCP/UDP</td> <td>systemd-resolved</td> <td>Ubuntu systemd</td> <td>ğŸŸ¢ Low</td> <td>Localhost DNS only (127.0.0.53, 127.0.0.54)</td> </tr> <tr> <td><strong>5353</strong></td> <td>UDP</td> <td>mDNS</td> <td>openclaw-gateway</td> <td>ğŸŸ¢ Low</td> <td>Service discovery (3 instances)</td> </tr> <tr> <td><strong>8317</strong></td> <td>TCP</td> <td>cli-proxy-api</td> <td>Security Platform</td> <td>ğŸŸ¢ Low</td> <td>Localhost-only CLI proxy</td> </tr> <tr> <td><strong>18792</strong></td> <td>TCP</td> <td>openclaw-gateway</td> <td>Security Platform</td> <td>ğŸŸ¢ Low</td> <td>Secondary API endpoint (localhost)</td> </tr> <tr> <td><strong>45729</strong></td> <td>TCP</td> <td>tailscaled</td> <td>Tailscale 1.94.1</td> <td>ğŸŸ¢ Low</td> <td>VPN control (100.127.14.89)</td> </tr> <tr> <td><strong>57654</strong></td> <td>TCP</td> <td>tailscaled (IPv6)</td> <td>Tailscale 1.94.1</td> <td>ğŸŸ¢ Low</td> <td>VPN control (fd7a:115c:a1e0::e01:e8d)</td> </tr> <tr> <td><strong>41641</strong></td> <td>UDP</td> <td>tailscaled</td> <td>Tailscale 1.94.1</td> <td>ğŸŸ¢ Low</td> <td>DERP relay (encrypted NAT traversal)</td> </tr> </tbody> </table> <p><strong>Detailed Analysis:</strong> See <code>/research/25-network-attack-surface.md</code></p> <hr> <h2 id=document-revision-history>Document Revision History</h2> <table> <thead> <tr> <th>Version</th> <th>Date</th> <th>Changes</th> <th>Author</th> </tr> </thead> <tbody> <tr> <td>1.0</td> <td>2026-02-02</td> <td>Initial comprehensive documentation</td> <td>Security Platform Security Analysis</td> </tr> <tr> <td>1.1</td> <td>2026-02-03</td> <td>Added Security Platform Gateway comparison (Appendix B)</td> <td>Security Platform Network Analysis Subagent</td> </tr> </tbody> </table> <hr> <h2 id=references>References</h2> <ul> <li><strong>Source Report:</strong> <code>/firmware/firewall-analysis-report.md</code></li> <li><strong>Firewall Rules:</strong> <code>/etc/firewall.d/</code> (84 rule files analyzed)</li> <li><strong>Service Definitions:</strong> <code>/etc/sv/</code> directory structure</li> <li><strong>Previous Analysis:</strong> <code>01-exploit-chain-summary.md</code>, <code>02-vulnerability-deep-dive.md</code>, <code>03-firmware-update-analysis.md</code></li> </ul> <hr> <p><strong>Document prepared by:</strong> Security Platform Tesla Security Research<br> <strong>Classification:</strong> Internal Technical Documentation<br> <strong>Last Updated:</strong> February 2, 2026, 20:51 UTC</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/talas9/tesla-research target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>