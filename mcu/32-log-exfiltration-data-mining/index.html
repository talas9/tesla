<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Comprehensive security analysis of Tesla Model S/X/3/Y MCU2 and Gateway"><meta name=author content="Security Researcher"><link href=https://talas9.github.io/tesla/mcu/32-log-exfiltration-data-mining/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Tesla Log Collection & Data Exfiltration Analysis - Tesla</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tesla-log-collection-data-exfiltration-analysis class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Tesla class="md-header__button md-logo" aria-label=Tesla data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tesla </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Tesla Log Collection &amp; Data Exfiltration Analysis </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=red data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/talas9/tesla title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../INDEX/ class=md-tabs__link> Complete Index </a> </li> <li class=md-tabs__item> <a href=../../core/00-master-cross-reference/ class=md-tabs__link> Core Research </a> </li> <li class=md-tabs__item> <a href=../../gateway/81-gateway-secure-configs-CRITICAL/ class=md-tabs__link> Gateway Security </a> </li> <li class=md-tabs__item> <a href=../24-vcsec-key-programming/ class=md-tabs__link> MCU Research </a> </li> <li class=md-tabs__item> <a href=../../ape/APE-SERVICES/ class=md-tabs__link> APE (Autopilot) </a> </li> <li class=md-tabs__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-tabs__link> Evidence & Audit </a> </li> <li class=md-tabs__item> <a href=../../tools/56-gateway-factory-gate-REAL/ class=md-tabs__link> Tools & Scripts </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Tesla class="md-nav__button md-logo" aria-label=Tesla data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Tesla </label> <div class=md-nav__source> <a href=https://github.com/talas9/tesla title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../INDEX/ class=md-nav__link> <span class=md-ellipsis> Complete Index </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Core Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../core/00-master-cross-reference/ class=md-nav__link> <span class=md-ellipsis> Master Cross-Reference </span> </a> </li> <li class=md-nav__item> <a href=../../core/02-gateway-can-flood-exploit/ class=md-nav__link> <span class=md-ellipsis> Gateway CAN Flood Exploit </span> </a> </li> <li class=md-nav__item> <a href=../../core/03-certificate-recovery-orphan-cars/ class=md-nav__link> <span class=md-ellipsis> Certificate Recovery </span> </a> </li> <li class=md-nav__item> <a href=../../core/04-network-ports-firewall/ class=md-nav__link> <span class=md-ellipsis> Network Topology </span> </a> </li> <li class=md-nav__item> <a href=../../core/06-usb-firmware-update/ class=md-nav__link> <span class=md-ellipsis> USB Firmware Update </span> </a> </li> <li class=md-nav__item> <a href=../../core/07-usb-map-installation/ class=md-nav__link> <span class=md-ellipsis> USB Map Installation </span> </a> </li> <li class=md-nav__item> <a href=../../core/08-key-programming-vcsec/ class=md-nav__link> <span class=md-ellipsis> Key Programming </span> </a> </li> <li class=md-nav__item> <a href=../../core/13-ota-handshake-protocol/ class=md-nav__link> <span class=md-ellipsis> OTA Protocol </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Gateway Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Gateway Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gateway/81-gateway-secure-configs-CRITICAL/ class=md-nav__link> <span class=md-ellipsis> ğŸ”’ CRITICAL: Secure Configs </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/80-ryzen-gateway-flash-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> âœ… Complete Flash Dump </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/82-odin-routines-database-UNHASHED/ class=md-nav__link> <span class=md-ellipsis> ğŸ”“ Odin Database </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/92-config-metadata-table-FOUND/ class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Config Metadata Table </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/83-odin-config-api-analysis/ class=md-nav__link> <span class=md-ellipsis> Odin Config API </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/84-gw-diag-command-reference/ class=md-nav__link> <span class=md-ellipsis> gw-diag Commands </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/88-gateway-strings-analysis/ class=md-nav__link> <span class=md-ellipsis> Gateway Strings </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/91-gateway-powerpc-disassembly-summary/ class=md-nav__link> <span class=md-ellipsis> PowerPC Disassembly </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/94-gateway-ALL-FUNCTIONS/ class=md-nav__link> <span class=md-ellipsis> All Functions </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/95-gateway-CAN-MESSAGES-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> CAN Messages Complete </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/96-gateway-DATA-TABLES/ class=md-nav__link> <span class=md-ellipsis> All Data Tables </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/97-gateway-MEMORY-MAP/ class=md-nav__link> <span class=md-ellipsis> Memory Map </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/98-SHA-256-USAGE-ANALYSIS/ class=md-nav__link> <span class=md-ellipsis> SHA-256 Usage </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/99-gateway-FIRMWARE-METADATA/ class=md-nav__link> <span class=md-ellipsis> Firmware Metadata </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/55-gateway-spc-chip-replacement/ class=md-nav__link> <span class=md-ellipsis> SPC Chip Replacement </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> MCU Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> MCU Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../24-vcsec-key-programming/ class=md-nav__link> <span class=md-ellipsis> VCSEC Key Programming </span> </a> </li> <li class=md-nav__item> <a href=../25-mcu-boot-sequence.md class=md-nav__link> <span class=md-ellipsis> Boot Sequence </span> </a> </li> <li class=md-nav__item> <a href=../28-can-flood-refined-timing/ class=md-nav__link> <span class=md-ellipsis> CAN Flood Timing </span> </a> </li> <li class=md-nav__item> <a href=../31-apparmor-sandbox-security/ class=md-nav__link> <span class=md-ellipsis> AppArmor Sandbox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> APE (Autopilot) </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> APE (Autopilot) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ape/APE-SERVICES/ class=md-nav__link> <span class=md-ellipsis> Services Documentation </span> </a> </li> <li class=md-nav__item> <a href=../../ape/APE-NETWORK-CONFIG/ class=md-nav__link> <span class=md-ellipsis> Network Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../ape/APE-FIRMWARE-EXTRACTION/ class=md-nav__link> <span class=md-ellipsis> Firmware Extraction </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Evidence & Audit </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Evidence & Audit </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-nav__link> <span class=md-ellipsis> Evidence Audit </span> </a> </li> <li class=md-nav__item> <a href=../../VERIFICATION-STATUS/ class=md-nav__link> <span class=md-ellipsis> Verification Status </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Tools & Scripts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Tools & Scripts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/56-gateway-factory-gate-REAL/ class=md-nav__link> <span class=md-ellipsis> Gateway Factory Gate </span> </a> </li> <li class=md-nav__item> <a href=../../SCRIPTS/ class=md-nav__link> <span class=md-ellipsis> Download Scripts </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=tesla-log-collection-data-exfiltration-analysis>Tesla Log Collection &amp; Data Exfiltration Analysis</h1> <p><strong>Research Date:</strong> February 3, 2026<br> <strong>Status:</strong> Comprehensive Technical Analysis<br> <strong>Sources:</strong> Firmware extraction, binary analysis, configuration parsing<br> <strong>Related Documents:</strong> 09-gateway-sdcard-log-analysis.md, tesla-hermes-research.md</p> <hr> <h2 id=executive-summary>Executive Summary</h2> <p>Tesla vehicles implement an extensive multi-layered logging and telemetry infrastructure that collects, aggregates, and uploads massive amounts of diagnostic, operational, and personal data to Tesla's cloud servers. This system operates continuously in the background with minimal user visibility or control.</p> <h3 id=critical-findings>Critical Findings</h3> <table> <thead> <tr> <th>Category</th> <th>Finding</th> </tr> </thead> <tbody> <tr> <td><strong>Logging Scope</strong></td> <td>221+ supervised services with dedicated log streams</td> </tr> <tr> <td><strong>Collection Daemons</strong></td> <td>5 Hermes-based data collection binaries (Go-based)</td> </tr> <tr> <td><strong>PII Exposure</strong></td> <td>VIN, GPS coordinates, shell history, CAN bus data</td> </tr> <tr> <td><strong>Upload Mechanism</strong></td> <td>WSS over port 443, authenticated via mTLS certificates</td> </tr> <tr> <td><strong>Retention</strong></td> <td>Varies by service; some logs compressed &amp; uploaded indefinitely</td> </tr> <tr> <td><strong>Local Storage</strong></td> <td><code>/var/log/</code>, SD card archives, <code>/home</code> user data directories</td> </tr> <tr> <td><strong>Feature Flags</strong></td> <td><code>FEATURE_prodHistoryLogsEnabled</code>, <code>FEATURE_earlyWaveCellNetworkingOk</code></td> </tr> </tbody> </table> <hr> <h2 id=1-logging-architecture-overview>1. Logging Architecture Overview</h2> <h3 id=11-supervision-log-collection-stack>1.1 Supervision &amp; Log Collection Stack</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>â”‚                    User Services (221+)                      â”‚
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>â”‚  qtcar, autopilot-api, chromium, sshd, dashcam, etc.        â”‚
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>                     â”‚ stdout/stderr
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>                     â–¼
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>â”‚                  svlogd (daemontools)                        â”‚
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>â”‚     Runit-based logging daemon with rotation &amp; filtering    â”‚
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>â”‚     Outputs: /var/log/&lt;service&gt;/current                     â”‚
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>                     â”‚
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>        â–¼            â–¼            â–¼              â–¼
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>â”‚ hermes_      â”‚ hermes_     â”‚ hermes_      â”‚ hermes_        â”‚
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>â”‚ eventlogs    â”‚ historylogs â”‚ grablogs     â”‚ fleet_streamingâ”‚
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>â”‚              â”‚             â”‚              â”‚                â”‚
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>â”‚ Real-time    â”‚ Historical  â”‚ On-demand    â”‚ Live data      â”‚
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>â”‚ event        â”‚ bulk        â”‚ file         â”‚ streaming      â”‚
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>â”‚ streaming    â”‚ upload      â”‚ retrieval    â”‚ (CAN, GPS)     â”‚
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>       â”‚              â”‚             â”‚                â”‚
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>                      â”‚
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>                      â–¼
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>           â”‚   hermes_client      â”‚
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>           â”‚  WSS Tunnel Handler  â”‚
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a>           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>                      â”‚ mTLS (port 443)
<a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a>                      â–¼
<a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>        â”‚ hermes-api.prd.{region}.vn.    â”‚
<a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a>        â”‚ cloud.tesla.com:443             â”‚
<a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a>        â”‚                                 â”‚
<a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a>        â”‚ Tesla Cloud Backend             â”‚
<a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a>        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div> <h3 id=12-core-binaries>1.2 Core Binaries</h3> <p>Located in <code>/opt/hermes/</code>:</p> <table> <thead> <tr> <th>Binary</th> <th>Size (MB)</th> <th>Purpose</th> <th>Language</th> </tr> </thead> <tbody> <tr> <td><code>hermes_client</code></td> <td>17.9</td> <td>Main WSS tunnel client, certificate management</td> <td>Go</td> </tr> <tr> <td><code>hermes_eventlogs</code></td> <td>10.9</td> <td>Real-time event log aggregation &amp; streaming</td> <td>Go</td> </tr> <tr> <td><code>hermes_historylogs</code></td> <td>8.0</td> <td>Historical log bulk uploads</td> <td>Go</td> </tr> <tr> <td><code>hermes_grablogs</code></td> <td>10.0</td> <td>On-demand log file retrieval (remote commands)</td> <td>Go</td> </tr> <tr> <td><code>hermes_fileupload</code></td> <td>7.6</td> <td>Generic file upload handler</td> <td>Go</td> </tr> <tr> <td><code>hermes_fleet_streaming</code></td> <td>11.0</td> <td>Real-time fleet data streaming</td> <td>Go</td> </tr> <tr> <td><code>hermes_livestream</code></td> <td>8.7</td> <td>Live diagnostic data streaming</td> <td>Go</td> </tr> <tr> <td><code>hermes_proxy</code></td> <td>12.0</td> <td>Local proxy for internal service communication</td> <td>Go</td> </tr> <tr> <td><code>hermes_teleforce</code></td> <td>9.8</td> <td>Remote diagnostics &amp; control</td> <td>Go</td> </tr> </tbody> </table> <p><strong>All binaries:</strong> Stripped ELF 64-bit executables, dynamically linked, built with Go (confirmed via BuildID).</p> <hr> <h2 id=2-log-collection-mechanisms>2. Log Collection Mechanisms</h2> <h3 id=21-svlogd-universal-log-daemon>2.1 svlogd - Universal Log Daemon</h3> <p><strong>Implementation:</strong> <code>runit</code> service supervision with <code>svlogd</code> log rotation.</p> <p><strong>Configuration:</strong> Each supervised service has a <code>/etc/sv/&lt;service&gt;/log/config</code> file.</p> <p><strong>Standard Configuration Pattern:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># /etc/sv/&lt;service&gt;/log/config</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=c1># Rotate when current exceeds 20MB</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>s20000000
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=c1># Keep max 10 rotated logs</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>n10
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=c1># Keep minimum 5 logs (disk space protection)</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>N5
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=c1># Compress rotated logs with gzip</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>!gzip<span class=w> </span>-c
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=c1># Product release marker (inserted at service startup)</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>0product-release:<span class=w> </span>feature-2025.26.8-6-999df00895
</code></pre></div> <p><strong>Key Parameters:</strong></p> <ul> <li><code>s&lt;bytes&gt;</code> - Maximum file size before rotation (typically 20MB)</li> <li><code>n&lt;count&gt;</code> - Maximum number of archived logs</li> <li><code>N&lt;count&gt;</code> - Minimum logs to retain (for space management)</li> <li><code>!&lt;command&gt;</code> - Post-rotation command (usually <code>gzip -c</code>)</li> <li><code>t&lt;seconds&gt;</code> - Time-based rotation (e.g., <code>t21600</code> = 6 hours for bandwidth logger)</li> <li><code>0&lt;marker&gt;</code> - Marker line to insert at service startup</li> </ul> <p><strong>Special Cases:</strong></p> <ol> <li> <p><strong>bwlogger</strong> (Bandwidth Logger): <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a># Aggregate every 6 hours
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>t21600
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>s100000  # Or when 100kB collected
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>n1       # Only 1 archive
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>N0       # No minimum
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>!/usr/local/bin/bandwidth_aggregator  # Summarize &amp; forward to syslog
</code></pre></div></p> </li> <li> <p><strong>syslog</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>s20000000    # 20MB rotation
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>n100         # Keep 100 archives (largest retention)
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>N50          # Keep minimum 50
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>!gzip -c     # Compress
</code></pre></div></p> </li> </ol> <h3 id=22-hermes-eventlogs-real-time-event-streaming>2.2 Hermes Eventlogs - Real-Time Event Streaming</h3> <p><strong>Binary:</strong> <code>/opt/hermes/hermes_eventlogs</code> (10.9 MB, Go)</p> <p><strong>Configuration:</strong> <code>/etc/hermes-eventlogs.vars</code></p> <p><strong>Service:</strong> <code>/etc/sv/hermes-eventlogs/run</code></p> <p><strong>Key Features:</strong></p> <ol> <li><strong>Rule-Based Event Filtering:</strong></li> <li>Monitors specific log files via JSON rule files in <code>/etc/hermes-eventlogs/monitor/</code></li> <li> <p>Each rule file specifies:</p> <ul> <li>Log file path</li> <li>Search patterns (regex)</li> <li>Ignore patterns</li> <li>Replacement/redaction rules</li> <li>Priority level (low/medium/high)</li> <li>Tags (including <code>senderid: vin</code>)</li> </ul> </li> <li> <p><strong>Monitored Log Files (Sample):</strong></p> </li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=err>/var/log/ice</span><span class=mi>-</span><span class=err>upda</span><span class=kc>ter</span><span class=err>/curre</span><span class=kc>nt</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=err>/var/log/shell</span><span class=mi>-</span><span class=err>his</span><span class=kc>t</span><span class=err>ory</span><span class=mi>-</span><span class=err>mo</span><span class=kc>n</span><span class=err>i</span><span class=kc>t</span><span class=err>or/curre</span><span class=kc>nt</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=err>/var/log/urge</span><span class=kc>nt</span><span class=mi>-</span><span class=err>ca</span><span class=kc>nl</span><span class=err>ogs/curre</span><span class=kc>nt</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=err>/var/log/au</span><span class=kc>t</span><span class=err>opilo</span><span class=kc>t</span><span class=mi>-</span><span class=err>api/curre</span><span class=kc>nt</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=err>/var/log/klog/curre</span><span class=kc>nt</span><span class=w> </span><span class=err>(ker</span><span class=kc>nel</span><span class=w> </span><span class=err>log)</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=err>/var/log/q</span><span class=kc>t</span><span class=err>car.curre</span><span class=kc>nt</span><span class=w> </span><span class=err>(mai</span><span class=kc>n</span><span class=w> </span><span class=err>UI)</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=err>/var/log/o</span><span class=kc>f</span><span class=err>o</span><span class=kc>n</span><span class=err>o/curre</span><span class=kc>nt</span><span class=w> </span><span class=err>(modem)</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=err>/var/log/sshd/curre</span><span class=kc>nt</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=err>/var/log/service</span><span class=mi>-</span><span class=err>ui/curre</span><span class=kc>nt</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=err>/var/log/odi</span><span class=kc>n</span><span class=mf>-e</span><span class=kc>n</span><span class=err>gi</span><span class=kc>ne</span><span class=err>/curre</span><span class=kc>nt</span><span class=w> </span><span class=err>(Au</span><span class=kc>t</span><span class=err>opilo</span><span class=kc>t</span><span class=w> </span><span class=err>visio</span><span class=kc>n</span><span class=err>)</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=err>/var/log/chromium/curre</span><span class=kc>nt</span><span class=w> </span><span class=err>(web</span><span class=w> </span><span class=err>browser)</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=err>/var/log/co</span><span class=kc>nn</span><span class=err>ma</span><span class=kc>n</span><span class=err>/curre</span><span class=kc>nt</span><span class=w> </span><span class=err>(</span><span class=kc>net</span><span class=err>work</span><span class=w> </span><span class=err>ma</span><span class=kc>na</span><span class=err>ger)</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=err>/var/log/wpa_supplica</span><span class=kc>nt</span><span class=err>/curre</span><span class=kc>nt</span><span class=w> </span><span class=err>(WiFi)</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=err>/var/log/hermes</span><span class=mi>-</span><span class=err>grablogs/curre</span><span class=kc>nt</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=err>/var/log/syslog/curre</span><span class=kc>nt</span>
</code></pre></div> <ol> <li><strong>Example Rule - Shell History Monitor:</strong></li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=p>{</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=nt>&quot;filepath&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/var/log/shell-history-monitor/current&quot;</span><span class=p>,</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>    </span><span class=nt>&quot;format&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;svlogd&quot;</span><span class=p>,</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span><span class=nt>&quot;rules&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>        </span><span class=p>{</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>            </span><span class=nt>&quot;search&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>            </span><span class=nt>&quot;ignore&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Structure needs cleaning|failed to connect|...&quot;</span><span class=p>,</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>            </span><span class=nt>&quot;replace&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>                </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;pattern&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;PID \\d+\\s*&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;replacement&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;PID&quot;</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>                </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;pattern&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;child process \\d+\\s*&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;replacement&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;child process&quot;</span><span class=w> </span><span class=p>}</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>            </span><span class=p>],</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>            </span><span class=nt>&quot;level&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;high&quot;</span><span class=p>,</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>            </span><span class=nt>&quot;tags&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;senderid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;vin&quot;</span><span class=p>}</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>    </span><span class=p>]</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=p>}</span>
</code></pre></div> <p><strong>This captures ALL shell commands executed on the vehicle with VIN tagging.</strong></p> <ol> <li><strong>Example Rule - ice-updater:</strong></li> </ol> <p>Captures update-related events: - Blacklisted URLs accessed - Non-whitelisted URLs accessed - Invalid command errors</p> <p><strong>Tagged with VIN for tracking which cars access what.</strong></p> <ol> <li><strong>Startup Parameters:</strong></li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>StartJob<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>  </span>--log-aggregation-interval<span class=o>=</span>3600s<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>  </span>--benchtop<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_EVENTLOGS_BENCHTOP</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>  </span>--compression<span class=o>=</span><span class=nb>true</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>  </span>--early-wave-enabled<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_EVENTLOGS_EARLY_WAVE</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>  </span>--source-queue<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$SOURCE_QUEUE_DIR</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>  </span>--sink-queue<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$SINK_QUEUE_DIR</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>  </span>--rule-dir<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$RULES_DIR</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>  </span>--checkpoint-dir<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$CHECKPOINT_DIR</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>  </span>--host-id<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_EVENTLOGS_SENDER_ID</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>  </span>--platform<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_EVENTLOGS_PLATFORM</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>  </span><span class=nv>$HERMES_EVENTLOGS_VIN_FLAGS</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>  </span><span class=nv>$HERMES_EVENTLOGS_TAGS</span>
</code></pre></div> <p><strong>Host ID Selection:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>if</span><span class=w> </span>is-development-car<span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>    </span><span class=nv>HERMES_EVENTLOGS_SENDER_ID</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_EVENTLOGS_VIN</span><span class=s2>&quot;</span><span class=w>  </span><span class=c1># Dev cars: VIN</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=k>else</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>    </span><span class=nv>HERMES_EVENTLOGS_SENDER_ID</span><span class=o>=</span><span class=s2>&quot;unknown&quot;</span><span class=w>  </span><span class=c1># Production: default unknown</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=k>fi</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span><span class=s2>&quot;</span><span class=nv>$HERMES_EVENTLOGS_PSEYDONUM_FILE</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>    </span><span class=nv>HERMES_EVENTLOGS_SENDER_ID</span><span class=o>=</span><span class=s2>&quot;@</span><span class=nv>$HERMES_EVENTLOGS_PSEYDONUM_FILE</span><span class=s2>&quot;</span><span class=w>  </span><span class=c1># Pseudonym if exists</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=k>fi</span>
</code></pre></div> <p><strong>Queue Management:</strong></p> <ul> <li><strong>Source Queue:</strong> <code>/home/hermes-eventlogs/source</code> (local event buffer)</li> <li><strong>Sink Queue:</strong> <code>/home/hermes-eventlogs/sink</code> (upload queue)</li> <li><strong>Checkpoints:</strong> <code>/home/hermes-eventlogs/checkpoints</code> (track log positions)</li> </ul> <h3 id=23-hermes-historylogs-bulk-historical-uploads>2.3 Hermes Historylogs - Bulk Historical Uploads</h3> <p><strong>Binary:</strong> <code>/opt/hermes/hermes_historylogs</code> (8.0 MB, Go)</p> <p><strong>Configuration:</strong> <code>/etc/hermes-historylogs.vars</code></p> <p><strong>Service:</strong> <code>/etc/sv/hermes-historylogs/run</code></p> <p><strong>Feature Flags:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Only runs in production if feature flag enabled</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=nv>prodlogs_enabled</span><span class=o>=</span><span class=k>$(</span>readDv<span class=w> </span>FEATURE_prodHistoryLogsEnabled<span class=k>)</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$prodlogs_enabled</span><span class=s2>&quot;</span><span class=w> </span>!<span class=o>=</span><span class=w> </span><span class=s1>&#39;&quot;true&quot;&#39;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>    </span>sv<span class=w> </span>once<span class=w> </span>hermes-historylogs<span class=p>;</span><span class=w> </span><span class=nb>exit</span><span class=w> </span><span class=m>0</span><span class=p>;</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=k>fi</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c1># Early wave networking check</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=nv>early_wave_enabled</span><span class=o>=</span><span class=k>$(</span>lv<span class=w> </span>FEATURE_earlyWaveCellNetworkingOk<span class=k>)</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$early_wave_enabled</span><span class=s2>&quot;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&quot;true&quot;&#39;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>    </span><span class=nv>HERMES_HISTORYLOGS_EARLY_WAVE</span><span class=o>=</span>true<span class=p>;</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=k>fi</span>
</code></pre></div> <p><strong>Monitored Files (50+ logs):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;/var/log/hermes-client/current&quot;</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/hermes-eventlogs/current&quot;</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/hermes-proxy/current&quot;</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/a2dpbridge/current&quot;</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/audiod/current&quot;</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/autopilot-api/current&quot;</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/btd/current&quot;</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/chromium/current&quot;</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/connman/current&quot;</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/dashcam/current&quot;</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/klog/current&quot;</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/syslog/current&quot;</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/updater-envoy/current&quot;</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/wifi-stats/current&quot;</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/qtcar/current&quot;</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/modemvm-logger/current&quot;</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/linuxvm-logger/current&quot;</span>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/shell-history-monitor/current&quot;</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/thermald/current&quot;</span>
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=c1># ... 30+ more services</span>
</code></pre></div> <p><strong>Conditional Logs (Game Apps, Diagnostics):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-d<span class=w> </span><span class=s2>&quot;/var/log/app-backgammon&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>    </span><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/app-backgammon/current&quot;</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=k>fi</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-d<span class=w> </span><span class=s2>&quot;/var/log/ice-updater&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>    </span><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/ice-updater/current&quot;</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=k>fi</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-d<span class=w> </span><span class=s2>&quot;/var/log/hermes-livestream&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>    </span><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/hermes-livestream/current&quot;</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=k>fi</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-d<span class=w> </span><span class=s2>&quot;/var/log/urgent-canlogs&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>    </span><span class=nv>HERMES_HISTORYLOGS_FILES</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_FILES</span><span class=s2>:/var/log/urgent-canlogs/current&quot;</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=k>fi</span>
</code></pre></div> <p><strong>Metadata Fields:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>--field<span class=w> </span><span class=s2>&quot;platform=</span><span class=si>${</span><span class=nv>HERMES_HISTORYLOGS_PLATFORM</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>--field<span class=w> </span><span class=s2>&quot;hw=</span><span class=si>${</span><span class=nv>HARDWARE_REVISION</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>--field<span class=w> </span><span class=s2>&quot;boardname=</span><span class=si>${</span><span class=nv>BOARD_NAME</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>--field<span class=w> </span><span class=s2>&quot;fw=</span><span class=si>${</span><span class=nv>PRODUCT_RELEASE</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>--field<span class=w> </span><span class=s2>&quot;release-scope=</span><span class=si>${</span><span class=nv>RELEASE_SCOPE</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>--field<span class=w> </span><span class=s2>&quot;boot-id=</span><span class=si>${</span><span class=nv>BOOT_ID</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>--field<span class=w> </span><span class=s2>&quot;dashw=</span><span class=si>${</span><span class=nv>DAS_HW</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>--field<span class=w> </span><span class=s2>&quot;hermesenv=</span><span class=si>${</span><span class=nv>HERMES_ENV</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>--field<span class=w> </span><span class=s2>&quot;test-id=</span><span class=si>${</span><span class=nv>TEST_ID</span><span class=si>}</span><span class=s2>&quot;</span>
</code></pre></div> <p><strong>Start Marker:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=nv>START_MARKER</span><span class=o>=</span><span class=s2>&quot; product-release: </span><span class=si>${</span><span class=nv>PRODUCT_RELEASE</span><span class=si>}</span>$<span class=s2>&quot;</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=nv>START_OFFSET</span><span class=o>=</span><span class=s2>&quot;-2718282&quot;</span><span class=w>  </span><span class=c1># ~31.5 days before current time</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=c1># Development cars can override:</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=k>if</span><span class=w> </span>!<span class=w> </span>is-fused<span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span><span class=s2>&quot;/var/run/notetaker/start_marker&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=w>        </span><span class=nv>START_MARKER</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>cat<span class=w> </span>/var/run/notetaker/start_marker<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=w>    </span><span class=k>fi</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=k>fi</span>
</code></pre></div> <p><strong>Resource Limits:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=nb>ulimit</span><span class=w> </span>-f<span class=w> </span><span class=m>512000</span><span class=w>  </span><span class=c1># Max 512MB per file</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>CreateMemoryCgroup<span class=w> </span><span class=s2>&quot;hermes_log&quot;</span><span class=w> </span>400M<span class=w>  </span><span class=c1># 400MB memory limit</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>EnterCpuCgroup<span class=w> </span><span class=s2>&quot;hermes_log&quot;</span>
</code></pre></div> <h3 id=24-hermes-grablogs-on-demand-remote-file-retrieval>2.4 Hermes Grablogs - On-Demand Remote File Retrieval</h3> <p><strong>Binary:</strong> <code>/opt/hermes/hermes_grablogs</code> (10.0 MB, Go)</p> <p><strong>Service:</strong> <code>/etc/sv/hermes-grablogs/run</code></p> <p><strong>Purpose:</strong> Tesla backend can remotely request specific log files from the vehicle.</p> <p><strong>Allowed Paths:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;--allowed-paths=/var/log/&quot;</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/audiod/audiologs/&quot;</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/odin/HRL/&quot;</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/odin/data_upload/archive/&quot;</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/odin/img_capture/&quot;</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/qtcluster/.Tesla/data/screenshots/&quot;</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/tesla/.Tesla/data/drivenotes/&quot;</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/tesla/.Tesla/data/screenshots/&quot;</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/tesla/.crashlogs/&quot;</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/.drmlogs/&quot;</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/tesla/.paniclogs/&quot;</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/tesla/.crashlogs_uploaded/&quot;</span>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/.drmlogs_uploaded/&quot;</span>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/tesla/.paniclogs_uploaded/&quot;</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/tesla/irislogs/&quot;</span>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/mnt/mmcblk0p1/bootlog.*&quot;</span>
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a>
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=c1># Engineering builds: entire home directories</span>
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$HERMES_ENV</span><span class=s2>&quot;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;eng&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=w>    </span><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/audiod/&quot;</span>
<a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>    </span><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/gpsmanager/&quot;</span>
<a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=w>    </span><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/phantom/&quot;</span>
<a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=w>    </span><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/qtcluster/&quot;</span>
<a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a><span class=w>    </span><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/home/tesla/&quot;</span>
<a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a><span class=w>    </span><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/var/lib/btd/&quot;</span>
<a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a><span class=w>    </span><span class=nv>ALLOWED_PATHS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$ALLOWED_PATHS</span><span class=s2>:/var/run-overlay&quot;</span>
<a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a><span class=k>fi</span>
</code></pre></div> <p><strong>External Log Retrievers:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=nv>EXTERNAL_LOGGERS</span><span class=o>=</span><span class=s2>&quot;--external-loggers=gw:/usr/local/bin/hermes-grablogs-gw&quot;</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=nv>EXTERNAL_LOGGERS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$EXTERNAL_LOGGERS</span><span class=s2>;modem:/usr/local/bin/hermes-grablogs-modem&quot;</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=nv>EXTERNAL_LOGGERS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$EXTERNAL_LOGGERS</span><span class=s2>;canlogs:/usr/local/bin/hermes-grablogs-canlogs&quot;</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=nv>EXTERNAL_LOGGERS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$EXTERNAL_LOGGERS</span><span class=s2>;hrl:/usr/local/bin/hermes-grablogs-hrl&quot;</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=nv>EXTERNAL_LOGGERS</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$EXTERNAL_LOGGERS</span><span class=s2>;updhrl:/usr/local/bin/hermes-grablogs-updater-hrl&quot;</span>
</code></pre></div> <p><strong>Example: CAN Log Retrieval</strong></p> <p><code>/usr/local/bin/hermes-grablogs-canlogs</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=ch>#!/bin/sh</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=nv>LOG_PATH</span><span class=o>=</span><span class=nv>$1</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=nv>OUTPUT_DIR</span><span class=o>=</span><span class=nv>$2</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=nv>START</span><span class=o>=</span><span class=nv>$3</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=nv>END</span><span class=o>=</span><span class=nv>$4</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=o>[</span><span class=w> </span>-n<span class=w> </span><span class=s2>&quot;</span><span class=nv>$LOG_PATH</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>die<span class=w> </span><span class=s2>&quot;No input path specified&quot;</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=o>[</span><span class=w> </span>-d<span class=w> </span><span class=s2>&quot;</span><span class=nv>$OUTPUT_DIR</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>die<span class=w> </span><span class=s2>&quot;No output directory specified&quot;</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=o>[</span><span class=w> </span>-n<span class=w> </span><span class=s2>&quot;</span><span class=nv>$START</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>die<span class=w> </span><span class=s2>&quot;No start datetime specified&quot;</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=o>[</span><span class=w> </span>-n<span class=w> </span><span class=s2>&quot;</span><span class=nv>$END</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>die<span class=w> </span><span class=s2>&quot;No end datetime specified&quot;</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$START</span><span class=s2>&quot;</span><span class=w> </span>-lt<span class=w> </span><span class=s2>&quot;</span><span class=nv>$END</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>die<span class=w> </span><span class=s2>&quot;Start datetime before end&quot;</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=k>$((</span><span class=nv>END</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nv>START</span><span class=k>))</span><span class=s2>&quot;</span><span class=w> </span>-lt<span class=w> </span><span class=m>605000</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>die<span class=w> </span><span class=s2>&quot;Datetime range too large&quot;</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>/usr/bin/canlogs<span class=w> </span>-start<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$START</span><span class=s2>&quot;</span><span class=w> </span>-end<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$END</span><span class=s2>&quot;</span><span class=w> </span>-output<span class=o>=</span>raw<span class=w> </span>&gt;<span class=w> </span><span class=s2>&quot;</span><span class=nv>$OUTPUT_DIR</span><span class=s2>&quot;</span>/<span class=s2>&quot;</span><span class=nv>$LOG_PATH</span><span class=s2>&quot;</span>
</code></pre></div> <p><strong>Range Limit:</strong> Max 605,000 seconds (~7 days) of CAN logs per request.</p> <p><strong>Example: Gateway Log Retrieval</strong></p> <p><code>/usr/local/bin/hermes-grablogs-gw</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=ch>#!/bin/sh</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=nv>LOG_PATH</span><span class=o>=</span><span class=nv>$1</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=nv>OUTPUT_DIR</span><span class=o>=</span><span class=nv>$2</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=o>[</span><span class=w> </span>-n<span class=w> </span><span class=s2>&quot;</span><span class=nv>$LOG_PATH</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>die<span class=w> </span><span class=s2>&quot;No input path specified&quot;</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=o>[</span><span class=w> </span>-d<span class=w> </span><span class=s2>&quot;</span><span class=nv>$OUTPUT_DIR</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>die<span class=w> </span><span class=s2>&quot;No output directory specified&quot;</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>/usr/local/bin/gwxfer<span class=w> </span>gw:<span class=s2>&quot;</span><span class=nv>$LOG_PATH</span><span class=s2>&quot;</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$OUTPUT</span><span class=s2>&quot;</span>
</code></pre></div> <p>Uses <code>gwxfer</code> to pull logs from the Gateway ECU over the CAN bus.</p> <hr> <h2 id=3-personally-identifiable-information-pii-in-logs>3. Personally Identifiable Information (PII) in Logs</h2> <h3 id=31-vin-vehicle-identification-number>3.1 VIN (Vehicle Identification Number)</h3> <p><strong>Presence:</strong> Ubiquitous - embedded as tag in nearly all log uploads.</p> <p><strong>Locations:</strong></p> <ul> <li><strong>Event Tags:</strong> <code>"senderid": "vin"</code> in hermes_eventlogs rules</li> <li><strong>Pseudonym System:</strong> <code>/var/etc/.pseudonym</code> (VIN-derived 17-character identifier)</li> <li><strong>Certificate Identity:</strong> Car certificate CN field contains VIN</li> <li><strong>Log Metadata:</strong> VIN passed via <code>--vin</code> flag to historylogs/eventlogs</li> </ul> <p><strong>Pseudonym Generation:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1># /etc/canlogs.vars</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>generate_pseudonym<span class=o>()</span><span class=w> </span><span class=o>{</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=w>    </span><span class=c1># Validates VIN via certificate check</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>    </span><span class=k>if</span><span class=w> </span>!<span class=w> </span>vcert<span class=w> </span>--name<span class=w> </span>car<span class=w> </span>--identity<span class=w> </span><span class=s2>&quot;</span><span class=k>$(</span>cat<span class=w> </span><span class=si>${</span><span class=nv>VIN_FILE</span><span class=si>}</span><span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=w>         </span>--allow-expired<span class=w> </span>--trust-chain<span class=w> </span><span class=s2>&quot;</span><span class=nv>$TESLA_CERTIFICATES_COMBINED_PRODUCTS</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=w>         </span>check-cert<span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=w> </span><span class=m>2</span>&gt;<span class=p>&amp;</span><span class=m>1</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=w>        </span><span class=nv>$LOG</span><span class=w> </span><span class=s2>&quot;invalid hermes cred for vin&quot;</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=m>1</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=w>    </span><span class=k>fi</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=w>    </span><span class=c1># Generate 17-char pseudonym preserving model character at position 4</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=w>    </span><span class=k>for</span><span class=w> </span>i<span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>$(</span>seq<span class=w> </span><span class=m>17</span><span class=k>)</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$i</span><span class=s2>&quot;</span><span class=w> </span>-eq<span class=w> </span><span class=m>4</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=w>            </span><span class=nv>model</span><span class=o>=</span><span class=k>$(</span>cut<span class=w> </span>-c4<span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>VIN_FILE</span><span class=si>}</span><span class=s2>&quot;</span><span class=k>)</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=w>            </span><span class=nv>pseudonym</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>pseudonym</span><span class=si>}${</span><span class=nv>model</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=w>        </span><span class=k>else</span>
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=w>            </span><span class=nv>pseudonym</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>pseudonym</span><span class=si>}</span><span class=k>$(</span>generate_pnym_char<span class=k>)</span><span class=s2>&quot;</span><span class=w>  </span><span class=c1># Random A-Z0-9</span>
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=w>        </span><span class=k>fi</span>
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a><span class=w>    </span><span class=k>done</span>
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$pseudonym</span><span class=s2>&quot;</span>
<a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a><span class=o>}</span>
</code></pre></div> <p><strong>Pseudonym Usage:</strong></p> <ul> <li>Non-development cars can use pseudonym instead of VIN for event sender ID</li> <li>Pseudonym is still linkable to VIN via certificate validation</li> <li>Only provides minimal obfuscation, not true anonymization</li> </ul> <h3 id=32-gps-location-data>3.2 GPS Location Data</h3> <p><strong>Sources:</strong></p> <ol> <li><strong>GPS Manager Logs:</strong> <code>/var/log/gpsmanager/current</code> (if service exists)</li> <li><strong>CAN Logs:</strong> GPS coordinates logged via <code>canlogs</code> utility</li> <li><strong>Autopilot API:</strong> <code>/var/log/autopilot-api/current</code> - navigation &amp; route data</li> <li><strong>Odin Engine:</strong> <code>/var/log/odin-engine/current</code> - vision system with location context</li> <li><strong>Map Region:</strong> Config ID 66 <code>mapRegion</code> in gateway logs</li> <li><strong>Hermes Livestream:</strong> Real-time GPS streaming capability</li> </ol> <p><strong>Binary Evidence:</strong></p> <p><code>strings hermes_eventlogs</code> output contains: <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>location
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>GPS
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>latitude
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>longitude
</code></pre></div></p> <p><strong>CAN Log GPS Access:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>/usr/bin/canlogs<span class=w> </span>-start<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$START</span><span class=s2>&quot;</span><span class=w> </span>-end<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$END</span><span class=s2>&quot;</span><span class=w> </span>-output<span class=o>=</span>raw
</code></pre></div> <p>Retrieves raw CAN bus data including GPS signals.</p> <h3 id=33-shell-command-history>3.3 Shell Command History</h3> <p><strong>Service:</strong> <code>shell-history-monitor</code></p> <p><strong>Log:</strong> <code>/var/log/shell-history-monitor/current</code></p> <p><strong>Eventlog Rule:</strong> HIGH priority, tagged with VIN</p> <p><strong>Monitored:</strong> All shell commands executed on the vehicle (via <code>.ash_history</code>, SSH sessions, service-shell, etc.)</p> <p><strong>Privacy Impact:</strong> Tesla can see: - Service mode commands - Diagnostic operations - Any root/user shell activity - Development/debugging sessions</p> <h3 id=34-network-activity>3.4 Network Activity</h3> <p><strong>Monitored Services:</strong></p> <ul> <li><strong>connman:</strong> <code>/var/log/connman/current</code> - connection manager (WiFi, cellular)</li> <li><strong>wpa_supplicant:</strong> <code>/var/log/wpa_supplicant/current</code> - WiFi credentials &amp; SSID access</li> <li><strong>ofono:</strong> <code>/var/log/ofono/current</code> - cellular modem activity</li> <li><strong>dnsmasq:</strong> <code>/var/log/dnsmasq/current</code> - DNS queries (if service active)</li> <li><strong>qtcar-connman:</strong> <code>/var/log/qtcar-connman/current</code> - Qt UI network layer</li> </ul> <p><strong>Exposed Data:</strong></p> <ul> <li>WiFi SSIDs connected to</li> <li>WiFi signal strength &amp; quality</li> <li>Cellular tower connections</li> <li>DNS queries (domain names accessed)</li> <li>IP addresses</li> <li>Network bandwidth usage (via <code>bwlogger</code>)</li> </ul> <p><strong>Bandwidth Logger:</strong></p> <p><code>/etc/sv/bwlogger/log/config</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a># Aggregate every 6 hours
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>t21600
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>s100000
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>n1
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>N0
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>!/usr/local/bin/bandwidth_aggregator
</code></pre></div> <p>Summarizes network usage per owner and re-logs to syslog (uploaded via historylogs).</p> <h3 id=35-chromium-browser-activity>3.5 Chromium Browser Activity</h3> <p><strong>Log:</strong> <code>/var/log/chromium/current</code></p> <p><strong>Contains:</strong></p> <ul> <li>URLs visited (if logged at debug level)</li> <li>Browser errors</li> <li>Navigation events</li> <li>Form submissions (errors)</li> <li>JavaScript exceptions</li> </ul> <p><strong>Monitored Apps:</strong></p> <ul> <li><code>/var/log/chromium-webapp-adapter/current</code></li> <li><code>/var/log/chromium-fullscreen/current</code></li> <li><code>/var/log/chromium-odin/current</code></li> <li><code>/var/log/chromium-app/current</code></li> </ul> <h3 id=36-user-data-directories>3.6 User Data Directories</h3> <p><strong>Remotely Accessible via hermes_grablogs:</strong></p> <ul> <li><code>/home/tesla/.Tesla/data/drivenotes/</code> - User-created drive notes</li> <li><code>/home/tesla/.Tesla/data/screenshots/</code> - User screenshots</li> <li><code>/home/qtcluster/.Tesla/data/screenshots/</code> - Cluster screenshots</li> <li><code>/home/odin/img_capture/</code> - Autopilot captured images</li> <li><code>/home/tesla/.crashlogs/</code> - Application crash logs</li> <li><code>/home/tesla/.paniclogs/</code> - Kernel panic logs</li> </ul> <p><strong>Engineering Builds:</strong> Entire <code>/home</code> directories accessible.</p> <h3 id=37-can-bus-data>3.7 CAN Bus Data</h3> <p><strong>Services:</strong></p> <ul> <li><code>/var/log/urgent-canlogs/current</code> - High-priority CAN events</li> <li><code>/var/log/canlogs-periodic/current</code> - Periodic CAN logging</li> <li><code>canlogs</code> utility - On-demand CAN log extraction</li> </ul> <p><strong>Exposed Data:</strong></p> <ul> <li>Battery state (SOC, voltage, temperature, cell balancing)</li> <li>Speed, acceleration, braking</li> <li>Steering angle, torque</li> <li>HVAC settings</li> <li>Door open/close events</li> <li>Seatbelt status</li> <li>Autopilot engagement</li> <li>Motor torque, power consumption</li> </ul> <p><strong>Remote CAN Log Requests:</strong></p> <p>Tesla can request up to 7 days of CAN logs via <code>hermes-grablogs-canlogs</code> and <code>hermes-grablogs-hrl</code> (high-resolution logs).</p> <h3 id=38-kernel-system-events>3.8 Kernel &amp; System Events</h3> <p><strong>Log:</strong> <code>/var/log/klog/current</code> (kernel log)</p> <p><strong>Monitored Events:</strong></p> <ul> <li>AppArmor denials (security policy violations)</li> <li>Seccomp violations (syscall filtering)</li> <li>Segmentation faults (app crashes with PIDs)</li> <li>Out-of-memory killer events</li> <li>Filesystem errors</li> <li>Memory cgroup OOM events</li> <li><code>nosymfollow</code> denials</li> </ul> <p><strong>Rule Example:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=p>{</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=w>    </span><span class=nt>&quot;search&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;apparmor=\&quot;[\\S]+\&quot;&quot;</span><span class=p>,</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=w>    </span><span class=nt>&quot;ignore&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;apparmor=\&quot;STATUS\&quot;&quot;</span><span class=p>,</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=w>    </span><span class=nt>&quot;replace&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=w>        </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;pattern&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;(^\\d{4}-\\d{2}-\\d{2}_\\d{2}:\\d{2}:\\d{2}.\\d+-\\d+).*apparmor=&quot;</span><span class=p>,</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=w>          </span><span class=nt>&quot;replacement&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;$1 apparmor=&quot;</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=w>        </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;pattern&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;pid=[0-9]+\\s*&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;replacement&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=w> </span><span class=p>}</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=w>    </span><span class=p>],</span>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=w>    </span><span class=nt>&quot;level&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;low&quot;</span><span class=p>,</span>
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=w>    </span><span class=nt>&quot;tags&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;senderid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;vin&quot;</span><span class=p>}</span>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=p>}</span>
</code></pre></div> <p>PIDs redacted but events still logged with VIN.</p> <hr> <h2 id=4-log-rotation-retention>4. Log Rotation &amp; Retention</h2> <h3 id=41-local-rotation-svlogd>4.1 Local Rotation (svlogd)</h3> <p><strong>Standard Pattern:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>/var/log/&lt;service&gt;/
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>â”œâ”€â”€ current         # Active log (max 20MB)
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>â”œâ”€â”€ @&lt;timestamp&gt;.s  # Rotated, compressed with gzip
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>â”œâ”€â”€ @&lt;timestamp&gt;.s
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>â”œâ”€â”€ ...
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>â””â”€â”€ lock            # svlogd lock file
</code></pre></div> <p><strong>Typical Retention:</strong></p> <ul> <li><strong>Most Services:</strong> 10 rotated logs Ã— 20MB = 200MB max</li> <li><strong>Syslog:</strong> 100 rotated logs Ã— 20MB = 2GB max</li> <li><strong>Minimum Retention:</strong> 5 logs (N5 config) to protect against disk full</li> <li><strong>Bandwidth Logger:</strong> 1 rotated log (deleted after aggregation)</li> </ul> <p><strong>Rotation Triggers:</strong></p> <ol> <li>Size-based: <code>s20000000</code> (20MB)</li> <li>Time-based: <code>t21600</code> (6 hours for special services)</li> <li>Hybrid: Both size AND time for bandwidth logger</li> </ol> <h3 id=42-upload-deletion>4.2 Upload &amp; Deletion</h3> <p><strong>hermes_historylogs Behavior:</strong></p> <ul> <li>Reads logs from <code>START_MARKER</code> position (typically <code>product-release:</code> line)</li> <li>Default start offset: <code>-2718282</code> seconds (~31.5 days ago)</li> <li>Uses checkpoints in <code>/home/hermes-eventlogs/checkpoints/</code> to track upload position</li> <li>Does NOT delete logs after upload (relies on svlogd rotation)</li> </ul> <p><strong>hermes_eventlogs Behavior:</strong></p> <ul> <li>Real-time streaming with source/sink queues</li> <li>Queues in <code>/home/hermes-eventlogs/source</code> and <code>/home/hermes-eventlogs/sink</code></li> <li>Checkpoint tracking prevents duplicate uploads</li> <li>Aggregation interval: 3600s (1 hour)</li> </ul> <p><strong>Remote Cleanup:</strong></p> <p>Tesla can remotely request log deletion via commands sent through hermes_client, but no evidence of automatic deletion policies found in configs.</p> <h3 id=43-sd-card-logging-gateway>4.3 SD Card Logging (Gateway)</h3> <p><strong>Log Location:</strong> <code>/mnt/mmcblk0p1/</code> (SD card on Gateway ECU)</p> <p><strong>Accessible via:</strong> <code>hermes-grablogs-gw</code> and <code>gwxfer</code> utility</p> <p><strong>Files:</strong></p> <ul> <li><code>bootlog.*</code> - Gateway boot logs</li> <li>Firmware update logs</li> <li>CAN bridge logs</li> <li>Gateway diagnostic logs</li> </ul> <p><strong>Retrieval:</strong> Tesla can pull these logs remotely via Hermes.</p> <hr> <h2 id=5-diagnostic-data-collection>5. Diagnostic Data Collection</h2> <h3 id=51-crash-panic-logs>5.1 Crash &amp; Panic Logs</h3> <p><strong>Crash Logs:</strong></p> <ul> <li><code>/home/tesla/.crashlogs/</code> - Application crash dumps</li> <li><code>/home/tesla/.crashlogs_uploaded/</code> - Already uploaded crashes</li> <li><code>/var/log/paniclog/current</code> - Kernel panic monitor</li> </ul> <p><strong>DRM Logs:</strong></p> <ul> <li><code>/home/.drmlogs/</code> - DRM/media decryption failures</li> <li><code>/home/.drmlogs_uploaded/</code> - Uploaded DRM logs</li> </ul> <p><strong>Collection Script:</strong></p> <p><code>/usr/local/bin/crashlog</code> - Automatically collects crash dumps and moves them to upload directories.</p> <h3 id=52-update-logs>5.2 Update Logs</h3> <p><strong>Services:</strong></p> <ul> <li><code>/var/log/ice-updater/current</code> - Main MCU updater</li> <li><code>/var/log/sx-updater/current</code> - Secondary MCU updater (if present)</li> <li><code>/var/log/zen-updater/current</code> - CID updater (older vehicles)</li> <li><code>/var/log/gadget-updater/current</code> - Gateway updater</li> <li><code>/var/log/updater-envoy/current</code> - Update orchestration</li> <li><code>/var/log/ice-fpt-update.log</code> - FPT firmware update</li> </ul> <p><strong>Monitored Events:</strong></p> <ul> <li>Update start/stop</li> <li>Download progress</li> <li>Installation status</li> <li>Errors &amp; failures</li> <li>URLs accessed during updates</li> </ul> <h3 id=53-autopilot-odin>5.3 Autopilot &amp; Odin</h3> <p><strong>Odin Engine:</strong></p> <ul> <li><code>/var/log/odin-engine/current</code> - Vision processing</li> <li><code>/home/odin/HRL/</code> - High-resolution logs (detailed autopilot data)</li> <li><code>/home/odin/data_upload/archive/</code> - Archived autopilot data</li> <li><code>/home/odin/img_capture/</code> - Captured images from cameras</li> </ul> <p><strong>Autopilot API:</strong></p> <ul> <li><code>/var/log/autopilot-api/current</code> - API calls between UI and autopilot</li> </ul> <p><strong>Dashcam:</strong></p> <ul> <li><code>/var/log/dashcam/current</code></li> <li><code>/var/log/dashcam-front/current</code></li> <li><code>/var/log/dashcam-back/current</code></li> <li><code>/var/log/dashcam-server/current</code></li> <li><code>/var/log/backup-camera/current</code></li> </ul> <p><strong>Camera Services:</strong></p> <ul> <li><code>/var/log/left-repeater-camera/current</code></li> <li><code>/var/log/webcam/current</code> (cabin camera)</li> </ul> <h3 id=54-thermal-power-management>5.4 Thermal &amp; Power Management</h3> <p><strong>Services:</strong></p> <ul> <li><code>/var/log/thermald/current</code> - Thermal management</li> <li><code>/var/log/emmc-monitor/current</code> - eMMC health monitoring</li> <li><code>/var/log/cgroup-monitor/current</code> - Resource usage</li> <li><code>/var/log/cgroup-event-monitor/current</code> - Cgroup events</li> <li><code>/var/log/qtcar-energymonitor/current</code> - Power consumption</li> </ul> <h3 id=55-audio-media>5.5 Audio &amp; Media</h3> <p><strong>Services:</strong></p> <ul> <li><code>/var/log/audiod/current</code> - Audio daemon</li> <li><code>/home/audiod/audiologs/</code> - Detailed audio logs</li> <li><code>/var/log/tunerbridge/current</code> - FM/AM tuner</li> <li><code>/var/log/teslabeats/current</code> - Tesla streaming music</li> <li><code>/var/log/qtcar-spotifyserver/current</code> - Spotify integration</li> </ul> <h3 id=56-manufacturing-factory>5.6 Manufacturing &amp; Factory</h3> <p><strong>Services:</strong></p> <ul> <li><code>/var/log/alertd/current</code> - Factory alert daemon</li> <li><code>/var/log/service-ui/current</code> - Service mode UI</li> <li><code>/var/log/vod/current</code> - Vehicle Operations Daemon (factory)</li> </ul> <p><strong>Firewall Rules:</strong></p> <p>Special firewall rules for factory/manufacturing logger services:</p> <ul> <li><code>/etc/firewall.d/gtw-logger.iptables</code></li> <li><code>/etc/firewall.d/modemvm-logger.iptables</code></li> <li><code>/etc/firewall.d/linuxvm-logger.iptables</code></li> <li><code>/etc/firewall.d/bwlogger.iptables</code></li> </ul> <hr> <h2 id=6-upload-infrastructure>6. Upload Infrastructure</h2> <h3 id=61-hermes-websocket-endpoints>6.1 Hermes WebSocket Endpoints</h3> <p><strong>Configuration:</strong> <code>/etc/hermes-urls.vars</code></p> <p><strong>Production Endpoints:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=nv>HERMES_ENV</span><span class=o>=</span>prd
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=nv>HERMES_REGION</span><span class=o>=</span>na<span class=w>  </span><span class=c1># or &#39;eu&#39; for EMEA cars</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=nv>HERMES_DOMAIN_SUFFIX</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_REGION</span><span class=s2>.vn.cloud.tesla.com&quot;</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=nv>HERMES_CMD_SERVER</span><span class=o>=</span><span class=s2>&quot;wss://hermes-api.</span><span class=nv>$HERMES_ENV</span><span class=s2>.</span><span class=nv>$HERMES_DOMAIN_SUFFIX</span><span class=s2>:443&quot;</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=nv>HERMES_STREAM_SERVER</span><span class=o>=</span><span class=s2>&quot;wss://hermes-stream-api.</span><span class=nv>$HERMES_ENV</span><span class=s2>.</span><span class=nv>$HERMES_DOMAIN_SUFFIX</span><span class=s2>:443&quot;</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=nv>HERMES_API_SERVER</span><span class=o>=</span><span class=s2>&quot;device-api.</span><span class=nv>$HERMES_ENV</span><span class=s2>.</span><span class=nv>$HERMES_DOMAIN_SUFFIX</span><span class=s2>&quot;</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=nv>HERMES_WEBAPP_SERVER</span><span class=o>=</span><span class=s2>&quot;web-api.</span><span class=nv>$HERMES_ENV</span><span class=s2>.</span><span class=nv>$HERMES_DOMAIN_SUFFIX</span><span class=s2>&quot;</span>
</code></pre></div> <p><strong>Resolved Endpoints:</strong></p> <ul> <li><code>wss://hermes-api.prd.na.vn.cloud.tesla.com:443</code> (command channel)</li> <li><code>wss://hermes-stream-api.prd.na.vn.cloud.tesla.com:443</code> (streaming channel)</li> </ul> <p><strong>China Variant:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=k>if</span><span class=w> </span>/usr/bin/is-china-car<span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=w>    </span><span class=nv>HERMES_CMD_SERVER</span><span class=o>=</span><span class=s2>&quot;wss://hermes-prd.vn.cloud.tesla.cn:443&quot;</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=w>    </span><span class=nv>HERMES_STREAM_SERVER</span><span class=o>=</span><span class=s2>&quot;wss://hermes-stream-prd.vn.cloud.tesla.cn:443&quot;</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=k>fi</span>
</code></pre></div> <p><strong>Manufacturing (Factory):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=nv>HERMES_ENV</span><span class=o>=</span>mfg
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=nv>HERMES_CMD_SERVER</span><span class=o>=</span><span class=s2>&quot;wss://hermes-prd1.i.tslans.net:443&quot;</span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=nv>HERMES_STREAM_SERVER</span><span class=o>=</span><span class=s2>&quot;wss://hermes-stream-prd1.i.tslans.net:443&quot;</span>
</code></pre></div> <p><strong>Engineering/Development:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=nv>HERMES_ENV</span><span class=o>=</span>eng
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=nv>HERMES_LOG_LEVEL</span><span class=o>=</span>debug
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=nv>HERMES_CMD_SERVER</span><span class=o>=</span><span class=s2>&quot;wss://hermes-api.</span><span class=nv>$HERMES_ENV</span><span class=s2>.</span><span class=nv>$HERMES_DOMAIN_SUFFIX</span><span class=s2>:443&quot;</span>
</code></pre></div> <h3 id=62-authentication>6.2 Authentication</h3> <p><strong>Method:</strong> Mutual TLS (mTLS)</p> <p><strong>Certificate Storage:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>/var/lib/car_creds/
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>â”œâ”€â”€ car.crt       # Vehicle certificate (VIN in CN field)
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>â”œâ”€â”€ car.key       # Private key
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>â””â”€â”€ ca.crt        # Tesla CA chain
</code></pre></div> <p><strong>Certificate Configuration:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span><span class=s2>&quot;</span><span class=nv>$HERMES_CERT</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>[</span><span class=w> </span>-f<span class=w> </span><span class=s2>&quot;</span><span class=nv>$HERMES_KEY</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=w>    </span>sv<span class=w> </span>-w<span class=w> </span><span class=m>30</span><span class=w> </span>start<span class=w> </span>hermes-client<span class=w> </span><span class=o>||</span><span class=w> </span><span class=nb>exit</span><span class=w> </span><span class=m>1</span><span class=p>;</span>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=k>fi</span>
</code></pre></div> <p><strong>CA Trust:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=nv>HERMES_CA</span><span class=o>=</span><span class=nv>$TESLA_CERTIFICATES_COMBINED_SERVICES_PRD</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=c1># Defined in /etc/tesla-certificates.vars</span>
</code></pre></div> <h3 id=63-connection-monitoring>6.3 Connection Monitoring</h3> <p><strong>Link State Monitoring:</strong></p> <p>Hermes services can monitor connection state via file watchers:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>--missing<span class=w> </span>connection-file-monitor-status-dir
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>--connection-file-monitor-cell-filename
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>--connection-file-monitor-wifi-filename
</code></pre></div> <p><strong>Cell Network Rate Limiting:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>--cell-events-per-second<span class=w> </span>&lt;value&gt;
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>--cell-burst-size-events<span class=w> </span>&lt;value&gt;
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>--cell-event-level-threshold<span class=w> </span>&lt;priority&gt;
</code></pre></div> <p>Limits upload rate over cellular to conserve bandwidth.</p> <p><strong>Early Wave Feature:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>--early-wave-enabled<span class=o>=</span><span class=s2>&quot;</span><span class=nv>$HERMES_HISTORYLOGS_EARLY_WAVE</span><span class=s2>&quot;</span>
</code></pre></div> <p>Allows "early wave" vehicles (beta testers) to upload more aggressively.</p> <hr> <h2 id=7-local-log-parsing-analysis-opportunities>7. Local Log Parsing &amp; Analysis Opportunities</h2> <h3 id=71-accessible-log-locations>7.1 Accessible Log Locations</h3> <p><strong>On-Vehicle Access (if shell available):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>/var/log/                    # All service logs
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>/home/hermes-eventlogs/      # Event queues &amp; checkpoints
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>/home/tesla/.Tesla/          # User data
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>/home/odin/                  # Autopilot data
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>/mnt/mmcblk0p1/              # Gateway SD card (if mounted)
</code></pre></div> <h3 id=72-log-format>7.2 Log Format</h3> <p><strong>svlogd Format:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>YYYY-MM-DD_HH:MM:SS.microseconds-offset &lt;process&gt;: &lt;message&gt;
</code></pre></div> <p>Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>2025-02-03_04:08:20.123456-0800 qtcar: MainWindow initialized
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>2025-02-03_04:08:21.654321-0800 hermes-client: Connected to wss://hermes-api.prd.na.vn.cloud.tesla.com:443
</code></pre></div> <h3 id=73-parsing-scripts>7.3 Parsing Scripts</h3> <p><strong>Gateway Log Parser:</strong> <code>/research/scripts/parse_gateway_sd_log.py</code></p> <p>Example usage in <code>09-gateway-sdcard-log-analysis.md</code>:</p> <ul> <li>Parses TFTP transfers</li> <li>Extracts config IDs</li> <li>Maps update sequences</li> </ul> <p><strong>Similar Approach for MCU Logs:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=kn>import</span><span class=w> </span><span class=nn>re</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=kn>from</span><span class=w> </span><span class=nn>datetime</span><span class=w> </span><span class=kn>import</span> <span class=n>datetime</span>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=n>log_pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^(\d</span><span class=si>{4}</span><span class=s1>-\d</span><span class=si>{2}</span><span class=s1>-\d</span><span class=si>{2}</span><span class=s1>)_(\d</span><span class=si>{2}</span><span class=s1>:\d</span><span class=si>{2}</span><span class=s1>:\d</span><span class=si>{2}</span><span class=s1>\.\d+)([-+]\d</span><span class=si>{4}</span><span class=s1>)\s+(\S+):\s+(.*)$&#39;</span><span class=p>)</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=k>def</span><span class=w> </span><span class=nf>parse_svlogd_line</span><span class=p>(</span><span class=n>line</span><span class=p>):</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>    <span class=n>match</span> <span class=o>=</span> <span class=n>log_pattern</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a>    <span class=k>if</span> <span class=n>match</span><span class=p>:</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>        <span class=n>date</span><span class=p>,</span> <span class=n>time</span><span class=p>,</span> <span class=n>tz</span><span class=p>,</span> <span class=n>process</span><span class=p>,</span> <span class=n>message</span> <span class=o>=</span> <span class=n>match</span><span class=o>.</span><span class=n>groups</span><span class=p>()</span>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>        <span class=n>timestamp</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>date</span><span class=si>}</span><span class=s2>T</span><span class=si>{</span><span class=n>time</span><span class=si>}{</span><span class=n>tz</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>        <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>timestamp</span><span class=p>,</span>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a>            <span class=s1>&#39;process&#39;</span><span class=p>:</span> <span class=n>process</span><span class=p>,</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a>            <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=n>message</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a>        <span class=p>}</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a>    <span class=k>return</span> <span class=kc>None</span>
</code></pre></div> <h3 id=74-redaction-detection>7.4 Redaction Detection</h3> <p><strong>Analyzing hermes-eventlogs Rules:</strong></p> <p>Extract PII redaction patterns to reverse-engineer what data is collected:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a>grep<span class=w> </span>-r<span class=w> </span><span class=s2>&quot;replace&quot;</span><span class=w> </span>/etc/hermes-eventlogs/monitor/*.current<span class=w> </span><span class=p>|</span><span class=w> </span>jq<span class=w> </span>.
</code></pre></div> <p>Example findings:</p> <ul> <li>PIDs redacted â†’ crash data collected but anonymized</li> <li>VIN preserved â†’ vehicle identification maintained</li> <li>Process names preserved â†’ service activity tracked</li> </ul> <h3 id=75-checkpoint-analysis>7.5 Checkpoint Analysis</h3> <p><strong>Checkpoint Files:</strong> <code>/home/hermes-eventlogs/checkpoints/</code></p> <p>Structure (hypothetical):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=p>{</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=w>  </span><span class=nt>&quot;/var/log/syslog/current&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=w>    </span><span class=nt>&quot;position&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1234567</span><span class=p>,</span>
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=w>    </span><span class=nt>&quot;last_upload&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2025-02-03T04:00:00Z&quot;</span>
<a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=p>}</span>
</code></pre></div> <p><strong>Use:</strong> Identify which logs have been uploaded and how much data has been exfiltrated.</p> <hr> <h2 id=8-sd-card-log-structure-gateway>8. SD Card Log Structure (Gateway)</h2> <p><strong>Based on:</strong> <code>09-gateway-sdcard-log-analysis.md</code></p> <h3 id=81-gateway-sd-card-layout>8.1 Gateway SD Card Layout</h3> <p><strong>Mount Point:</strong> <code>/mnt/mmcblk0p1/</code> (on Gateway ECU)</p> <p><strong>Files:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a>/mnt/mmcblk0p1/
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>â”œâ”€â”€ bootlog.&lt;timestamp&gt;      # Gateway boot sequence
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a>â”œâ”€â”€ gwapp.log               # Gateway application logs
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a>â”œâ”€â”€ update_&lt;version&gt;.log    # OTA update logs
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a>â”œâ”€â”€ cbreaker.map            # Circuit breaker configuration map
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a>â””â”€â”€ signed_metadata_map.tsv # Firmware metadata
</code></pre></div> <h3 id=82-log-contents>8.2 Log Contents</h3> <p><strong>TFTP Transfer Logs:</strong></p> <p>Records of all firmware files downloaded during OTA:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a>HPick 11:15:45.708: HPick tftp src:gtw3/192/cbreaker.map dest:cbreaker.map, attempt #1
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>HPick 11:15:45.772: HPick tftp src:signed_metadata_map.tsv dest:map.tsv, attempt #1
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a>HPick 11:15:58.992: HPick tftp src:gtw3/191/gwapp.img dest:000c, attempt #1
</code></pre></div> <p><strong>Config Updates:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a>id=15 name=devSecurityLevel len=1 last_value=3
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>id=29 name=autopilot len=1 last_value=4
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a>id=37 name=prodCodeKey len=32 last_value=&#39;&lt;binary&gt;&#39;
<a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a>id=38 name=prodCmdKey len=32 last_value=&#39;&lt;binary&gt;&#39;
<a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a>id=66 name=mapRegion len=1 last_value=0
</code></pre></div> <p><strong>Error Tracking:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a>Error keyword counts:
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>- err: 68
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a>- mismatch: 36
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a>- error: 7
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a>- refused: 2
</code></pre></div> <h3 id=83-retrieval-methods>8.3 Retrieval Methods</h3> <ol> <li><strong>Remote (via Hermes):</strong></li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a>/usr/local/bin/gwxfer<span class=w> </span>gw:<span class=s2>&quot;/mnt/mmcblk0p1/bootlog.*&quot;</span><span class=w> </span>/tmp/output/
</code></pre></div> <p>Tesla can request these files via <code>hermes-grablogs-gw</code>.</p> <ol> <li><strong>Local (if shell access):</strong></li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a>mount<span class=w> </span>/dev/mmcblk0p1<span class=w> </span>/mnt/sd
<a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>cat<span class=w> </span>/mnt/sd/bootlog.*
</code></pre></div> <h3 id=84-analysis-value>8.4 Analysis Value</h3> <p><strong>Security Research:</strong></p> <ul> <li>Firmware versions deployed</li> <li>Update sequences</li> <li>Error conditions</li> <li>Security key rotation events (prodCodeKey, prodCmdKey updates)</li> </ul> <p><strong>Privacy Research:</strong></p> <ul> <li>VIN appears in logs</li> <li>Map region reveals geographic location</li> <li>Config IDs reveal hardware configuration</li> </ul> <hr> <h2 id=9-privacy-security-implications>9. Privacy &amp; Security Implications</h2> <h3 id=91-summary-of-pii-exposure>9.1 Summary of PII Exposure</h3> <table> <thead> <tr> <th>Data Type</th> <th>Exposure Level</th> <th>Upload Mechanism</th> <th>Retention</th> </tr> </thead> <tbody> <tr> <td><strong>VIN</strong></td> <td>High - Direct identifier</td> <td>All Hermes uploads</td> <td>Indefinite</td> </tr> <tr> <td><strong>GPS Location</strong></td> <td>High - Precise coordinates</td> <td>CAN logs, autopilot logs</td> <td>31+ days</td> </tr> <tr> <td><strong>Shell Commands</strong></td> <td>High - Full command history</td> <td>eventlogs (shell-history-monitor)</td> <td>Real-time upload</td> </tr> <tr> <td><strong>WiFi SSIDs</strong></td> <td>Medium - Location proxy</td> <td>connman, wpa_supplicant logs</td> <td>31+ days</td> </tr> <tr> <td><strong>Network Traffic</strong></td> <td>Medium - Metadata only</td> <td>connman, bandwidth logger</td> <td>Aggregated, 6h</td> </tr> <tr> <td><strong>Browser History</strong></td> <td>Medium - URLs (if debug mode)</td> <td>chromium logs</td> <td>31+ days</td> </tr> <tr> <td><strong>CAN Bus Data</strong></td> <td>High - Driving behavior</td> <td>canlogs, urgent-canlogs</td> <td>On-demand (7d max)</td> </tr> <tr> <td><strong>Crash Dumps</strong></td> <td>Medium - App state</td> <td>crashlogs, paniclogs</td> <td>Indefinite</td> </tr> <tr> <td><strong>Camera Images</strong></td> <td>High - Visual data</td> <td>Odin img_capture</td> <td>On-demand</td> </tr> <tr> <td><strong>User Notes/Screenshots</strong></td> <td>High - Personal content</td> <td>hermes_grablogs allowed paths</td> <td>On-demand</td> </tr> </tbody> </table> <h3 id=92-feature-flag-controls>9.2 Feature Flag Controls</h3> <p><strong>Disable Production Log Uploads:</strong></p> <p>Setting <code>FEATURE_prodHistoryLogsEnabled</code> to <code>false</code> would disable <code>hermes_historylogs</code> in production.</p> <p><strong>However:</strong></p> <ul> <li><code>hermes_eventlogs</code> still runs (real-time events)</li> <li><code>hermes_grablogs</code> still allows on-demand retrieval</li> <li>No user-accessible interface to toggle these flags</li> </ul> <p><strong>Early Wave Opt-In:</strong></p> <p><code>FEATURE_earlyWaveCellNetworkingOk</code> allows more aggressive cellular uploads.</p> <p><strong>Test Drive Mode:</strong></p> <p>Affects pseudonym enforcement:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=nv>isTestDriveModeEnabled</span><span class=o>=</span><span class=k>$(</span>/usr/local/bin/lv<span class=w> </span>FEATURE_enableTestDriveMode<span class=k>)</span>
<a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>isTestDriveModeEnabled</span><span class=si>}</span><span class=s2>&quot;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&quot;true&quot;&#39;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>!<span class=w> </span>/usr/bin/is-delivered<span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=w>    </span><span class=c1># Allow pseudonym-based uploads before delivery</span>
<a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=k>fi</span>
</code></pre></div> <h3 id=93-lack-of-user-control>9.3 Lack of User Control</h3> <p><strong>No Opt-Out:</strong></p> <ul> <li>No in-vehicle UI to disable telemetry</li> <li>No consent prompts for log uploads</li> <li>No visibility into what data is uploaded</li> </ul> <p><strong>"Orphan Car" Dependency:</strong></p> <ul> <li>Disabling Hermes (certificate expiry) breaks remote features:</li> <li>Mobile app control</li> <li>OTA updates</li> <li>Remote diagnostics</li> <li>Forcing users to maintain connectivity for basic functionality</li> </ul> <h3 id=94-third-party-service-integration>9.4 Third-Party Service Integration</h3> <p><strong>Evidence of External Services:</strong></p> <ul> <li>Spotify logging (<code>qtcar-spotifyserver</code>)</li> <li>FM tuner logs (<code>tunerbridge</code>)</li> <li>Streaming music (<code>teslabeats</code>)</li> </ul> <p><strong>Question:</strong> Are these third-party service logs also uploaded to Tesla?</p> <p><strong>Answer:</strong> Yes, based on <code>HERMES_HISTORYLOGS_FILES</code> inclusion.</p> <hr> <h2 id=10-exploitation-mitigation>10. Exploitation &amp; Mitigation</h2> <h3 id=101-attack-vectors>10.1 Attack Vectors</h3> <p><strong>1. Hermes Certificate Theft:</strong></p> <ul> <li>If attacker extracts <code>/var/lib/car_creds/car.key</code> and <code>car.crt</code></li> <li>Can impersonate vehicle to Tesla backend</li> <li>Upload fake telemetry data</li> <li>Potentially intercept commands intended for that VIN</li> </ul> <p><strong>2. Log Injection:</strong></p> <ul> <li>If attacker gains shell access</li> <li>Can inject fake log entries into monitored files</li> <li>Could trigger false alerts or hide malicious activity</li> </ul> <p><strong>3. Queue Poisoning:</strong></p> <ul> <li>Corrupt <code>/home/hermes-eventlogs/sink</code> queue</li> <li>Cause denial of service for log uploads</li> <li>Potentially crash hermes_eventlogs daemon</li> </ul> <p><strong>4. Checkpoint Manipulation:</strong></p> <ul> <li>Modify <code>/home/hermes-eventlogs/checkpoints/</code></li> <li>Force re-upload of old logs (DoS on bandwidth)</li> <li>Or prevent new logs from uploading (hide activity)</li> </ul> <h3 id=102-privacy-mitigation-strategies>10.2 Privacy Mitigation Strategies</h3> <p><strong>For Researchers:</strong></p> <ol> <li><strong>Monitor <code>/var/log/hermes-*/current</code>:</strong></li> <li>Track what data is being uploaded</li> <li> <p>Identify sensitive log entries before upload</p> </li> <li> <p><strong>Block Hermes Endpoints:</strong></p> </li> <li>Firewall rules to block <code>*.vn.cloud.tesla.com</code></li> <li> <p>Prevents uploads but breaks remote features</p> </li> <li> <p><strong>Certificate Expiry:</strong></p> </li> <li>Allow certificate to expire naturally</li> <li> <p>Vehicle becomes "orphan" but telemetry stops</p> </li> <li> <p><strong>svlogd Config Modification:</strong></p> </li> <li>Change <code>/etc/sv/*/log/config</code> to reduce retention</li> <li>Set <code>n0</code> to disable rotation archives</li> <li> <p><strong>Risk:</strong> System instability if disk fills</p> </li> <li> <p><strong>Disable Hermes Services:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a>sv<span class=w> </span>down<span class=w> </span>hermes-eventlogs
<a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a>sv<span class=w> </span>down<span class=w> </span>hermes-historylogs
<a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a>sv<span class=w> </span>down<span class=w> </span>hermes-grablogs
</code></pre></div></p> </li> <li><strong>Risk:</strong> Breaks OTA updates and remote features</li> </ol> <p><strong>For Owners (without root):</strong></p> <ul> <li>No effective privacy controls available</li> <li>Must trust Tesla's data handling policies</li> <li>Consider impact when connecting to home WiFi (SSID exposure)</li> </ul> <hr> <h2 id=11-conclusions>11. Conclusions</h2> <h3 id=111-key-takeaways>11.1 Key Takeaways</h3> <ol> <li><strong>Comprehensive Surveillance:</strong> Tesla collects extensive telemetry from 221+ supervised services, including:</li> <li>Real-time shell command monitoring</li> <li>GPS location history</li> <li>CAN bus data (driving behavior, battery state)</li> <li>Network activity (WiFi SSIDs, bandwidth usage)</li> <li>Browser activity</li> <li> <p>User-created content (notes, screenshots)</p> </li> <li> <p><strong>VIN Linkage:</strong> Nearly all uploaded data is tagged with VIN, creating a persistent, identifiable record.</p> </li> <li> <p><strong>Minimal User Control:</strong> No in-vehicle interface to opt out or limit telemetry collection.</p> </li> <li> <p><strong>Remote Access:</strong> Tesla can remotely request:</p> </li> <li>Up to 7 days of CAN logs</li> <li>Arbitrary files from <code>/var/log/</code> and user directories</li> <li>Gateway SD card logs</li> <li> <p>Autopilot camera captures</p> </li> <li> <p><strong>Retention:</strong> Local logs retained for 31+ days; cloud retention policy unknown.</p> </li> <li> <p><strong>Obfuscation, Not Anonymization:</strong> Pseudonym system provides minimal privacy benefit; still linkable to VIN.</p> </li> </ol> <h3 id=112-research-gaps>11.2 Research Gaps</h3> <ul> <li>Cloud-side retention policies (how long does Tesla keep uploaded logs?)</li> <li>Third-party data sharing (are logs shared with suppliers, insurance, law enforcement?)</li> <li>Manufacturing vs. production log differences</li> <li>China-specific logging variations</li> <li>Exact triggering conditions for <code>hermes_grablogs</code> remote requests</li> </ul> <h3 id=113-recommendations>11.3 Recommendations</h3> <p><strong>For Tesla:</strong></p> <ol> <li>Implement user-facing telemetry controls</li> <li>Provide transparency reports on data collection</li> <li>Minimize PII in logs (e.g., hash VINs, redact GPS coordinates)</li> <li>Time-limit cloud retention</li> <li>Obtain explicit consent for sensitive data collection (camera images, shell history)</li> </ol> <p><strong>For Researchers:</strong></p> <ol> <li>Analyze network traffic to confirm upload contents</li> <li>Reverse-engineer Hermes binary protocols for deeper understanding</li> <li>Develop tools to audit local log queues before upload</li> <li>Investigate legal frameworks around automotive telemetry</li> </ol> <p><strong>For Regulators:</strong></p> <ol> <li>Require automotive OEMs to disclose telemetry scope</li> <li>Mandate user opt-out mechanisms</li> <li>Establish retention limits for location data</li> <li>Audit third-party data sharing practices</li> </ol> <hr> <h2 id=12-technical-appendices>12. Technical Appendices</h2> <h3 id=appendix-a-complete-hermes-service-list>Appendix A: Complete Hermes Service List</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a>/etc/sv/hermes-client/
<a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a>/etc/sv/hermes-eventlogs/
<a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a>/etc/sv/hermes-historylogs/
<a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a>/etc/sv/hermes-grablogs/
<a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a>/etc/sv/hermes-proxy/
<a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a>/etc/sv/hermes-teleforce/
<a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a>/etc/sv/hermes-fleet-streaming/
<a id=__codelineno-48-8 name=__codelineno-48-8 href=#__codelineno-48-8></a>/etc/sv/hermes-livestream/
<a id=__codelineno-48-9 name=__codelineno-48-9 href=#__codelineno-48-9></a>/etc/sv/hermes-dynamic-triggers/
</code></pre></div> <h3 id=appendix-b-all-monitored-log-files-hermes_historylogs>Appendix B: All Monitored Log Files (hermes_historylogs)</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a>/var/log/a2dpbridge/current
<a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a>/var/log/alertd/current
<a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a>/var/log/app-*/current (backgammon, purple, chess, 2048, cobalt, topaz, etc.)
<a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a>/var/log/audiod/current
<a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a>/var/log/autopilot-api/current
<a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a>/var/log/authd/current
<a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a>/var/log/avb_streamhandler/current
<a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a>/var/log/backup-camera/current
<a id=__codelineno-49-9 name=__codelineno-49-9 href=#__codelineno-49-9></a>/var/log/bsa_server/current
<a id=__codelineno-49-10 name=__codelineno-49-10 href=#__codelineno-49-10></a>/var/log/btd/current
<a id=__codelineno-49-11 name=__codelineno-49-11 href=#__codelineno-49-11></a>/var/log/canlogs-periodic/current
<a id=__codelineno-49-12 name=__codelineno-49-12 href=#__codelineno-49-12></a>/var/log/car-assist/current
<a id=__codelineno-49-13 name=__codelineno-49-13 href=#__codelineno-49-13></a>/var/log/cgroup-event-monitor/current
<a id=__codelineno-49-14 name=__codelineno-49-14 href=#__codelineno-49-14></a>/var/log/cgroup-monitor/current
<a id=__codelineno-49-15 name=__codelineno-49-15 href=#__codelineno-49-15></a>/var/log/chromium/current
<a id=__codelineno-49-16 name=__codelineno-49-16 href=#__codelineno-49-16></a>/var/log/chromium-adapter/current
<a id=__codelineno-49-17 name=__codelineno-49-17 href=#__codelineno-49-17></a>/var/log/chromium-app/current
<a id=__codelineno-49-18 name=__codelineno-49-18 href=#__codelineno-49-18></a>/var/log/chromium-fullscreen/current
<a id=__codelineno-49-19 name=__codelineno-49-19 href=#__codelineno-49-19></a>/var/log/chromium-odin/current
<a id=__codelineno-49-20 name=__codelineno-49-20 href=#__codelineno-49-20></a>/var/log/chromium-webapp-adapter/current
<a id=__codelineno-49-21 name=__codelineno-49-21 href=#__codelineno-49-21></a>/var/log/command-router/current
<a id=__codelineno-49-22 name=__codelineno-49-22 href=#__codelineno-49-22></a>/var/log/connman/current
<a id=__codelineno-49-23 name=__codelineno-49-23 href=#__codelineno-49-23></a>/var/log/daemon_cl/current
<a id=__codelineno-49-24 name=__codelineno-49-24 href=#__codelineno-49-24></a>/var/log/dashcam/current
<a id=__codelineno-49-25 name=__codelineno-49-25 href=#__codelineno-49-25></a>/var/log/dnsmasq/current
<a id=__codelineno-49-26 name=__codelineno-49-26 href=#__codelineno-49-26></a>/var/log/drmlog/current
<a id=__codelineno-49-27 name=__codelineno-49-27 href=#__codelineno-49-27></a>/var/log/emmc-monitor/current
<a id=__codelineno-49-28 name=__codelineno-49-28 href=#__codelineno-49-28></a>/var/log/escalator/current
<a id=__codelineno-49-29 name=__codelineno-49-29 href=#__codelineno-49-29></a>/var/log/gadget-updater/current
<a id=__codelineno-49-30 name=__codelineno-49-30 href=#__codelineno-49-30></a>/var/log/hermes-dynamic-triggers/current
<a id=__codelineno-49-31 name=__codelineno-49-31 href=#__codelineno-49-31></a>/var/log/hermes-fleet-streaming/current
<a id=__codelineno-49-32 name=__codelineno-49-32 href=#__codelineno-49-32></a>/var/log/hermes-grablogs/current
<a id=__codelineno-49-33 name=__codelineno-49-33 href=#__codelineno-49-33></a>/var/log/hermes-livestream/current
<a id=__codelineno-49-34 name=__codelineno-49-34 href=#__codelineno-49-34></a>/var/log/ice-display-monitor/current
<a id=__codelineno-49-35 name=__codelineno-49-35 href=#__codelineno-49-35></a>/var/log/ice-fpt-update.log
<a id=__codelineno-49-36 name=__codelineno-49-36 href=#__codelineno-49-36></a>/var/log/ice-updater/current
<a id=__codelineno-49-37 name=__codelineno-49-37 href=#__codelineno-49-37></a>/var/log/inductivechargerd/current
<a id=__codelineno-49-38 name=__codelineno-49-38 href=#__codelineno-49-38></a>/var/log/infohealthd/current
<a id=__codelineno-49-39 name=__codelineno-49-39 href=#__codelineno-49-39></a>/var/log/klog/current
<a id=__codelineno-49-40 name=__codelineno-49-40 href=#__codelineno-49-40></a>/var/log/linuxvm-logger/current
<a id=__codelineno-49-41 name=__codelineno-49-41 href=#__codelineno-49-41></a>/var/log/ltng/current
<a id=__codelineno-49-42 name=__codelineno-49-42 href=#__codelineno-49-42></a>/var/log/mic-bridge/current
<a id=__codelineno-49-43 name=__codelineno-49-43 href=#__codelineno-49-43></a>/var/log/modemvm-logger/current
<a id=__codelineno-49-44 name=__codelineno-49-44 href=#__codelineno-49-44></a>/var/log/mounterd/current
<a id=__codelineno-49-45 name=__codelineno-49-45 href=#__codelineno-49-45></a>/var/log/odin-engine/current
<a id=__codelineno-49-46 name=__codelineno-49-46 href=#__codelineno-49-46></a>/var/log/ofono/current
<a id=__codelineno-49-47 name=__codelineno-49-47 href=#__codelineno-49-47></a>/var/log/owners-manual/current
<a id=__codelineno-49-48 name=__codelineno-49-48 href=#__codelineno-49-48></a>/var/log/owners-manual-adapter/current
<a id=__codelineno-49-49 name=__codelineno-49-49 href=#__codelineno-49-49></a>/var/log/paniclog/current
<a id=__codelineno-49-50 name=__codelineno-49-50 href=#__codelineno-49-50></a>/var/log/qtcar/current
<a id=__codelineno-49-51 name=__codelineno-49-51 href=#__codelineno-49-51></a>/var/log/qtcar-accountmanager/current
<a id=__codelineno-49-52 name=__codelineno-49-52 href=#__codelineno-49-52></a>/var/log/qtcar-carserver/current
<a id=__codelineno-49-53 name=__codelineno-49-53 href=#__codelineno-49-53></a>/var/log/qtcar-connman/current
<a id=__codelineno-49-54 name=__codelineno-49-54 href=#__codelineno-49-54></a>/var/log/qtcar-energymonitor/current
<a id=__codelineno-49-55 name=__codelineno-49-55 href=#__codelineno-49-55></a>/var/log/qtcar-evlogservice/current
<a id=__codelineno-49-56 name=__codelineno-49-56 href=#__codelineno-49-56></a>/var/log/qtcar-gpsmanager/current
<a id=__codelineno-49-57 name=__codelineno-49-57 href=#__codelineno-49-57></a>/var/log/qtcar-tmserver/current
<a id=__codelineno-49-58 name=__codelineno-49-58 href=#__codelineno-49-58></a>/var/log/release-notes/current
<a id=__codelineno-49-59 name=__codelineno-49-59 href=#__codelineno-49-59></a>/var/log/release-notes-adapter/current
<a id=__codelineno-49-60 name=__codelineno-49-60 href=#__codelineno-49-60></a>/var/log/service-ui/current
<a id=__codelineno-49-61 name=__codelineno-49-61 href=#__codelineno-49-61></a>/var/log/shell-history-monitor/current
<a id=__codelineno-49-62 name=__codelineno-49-62 href=#__codelineno-49-62></a>/var/log/sx-updater/current
<a id=__codelineno-49-63 name=__codelineno-49-63 href=#__codelineno-49-63></a>/var/log/syslog/current
<a id=__codelineno-49-64 name=__codelineno-49-64 href=#__codelineno-49-64></a>/var/log/tesla-tts-service/current
<a id=__codelineno-49-65 name=__codelineno-49-65 href=#__codelineno-49-65></a>/var/log/thermald/current
<a id=__codelineno-49-66 name=__codelineno-49-66 href=#__codelineno-49-66></a>/var/log/tunerbridge/current
<a id=__codelineno-49-67 name=__codelineno-49-67 href=#__codelineno-49-67></a>/var/log/tunaman/current
<a id=__codelineno-49-68 name=__codelineno-49-68 href=#__codelineno-49-68></a>/var/log/ubloxd/current
<a id=__codelineno-49-69 name=__codelineno-49-69 href=#__codelineno-49-69></a>/var/log/updater-envoy/current
<a id=__codelineno-49-70 name=__codelineno-49-70 href=#__codelineno-49-70></a>/var/log/urgent-canlogs/current
<a id=__codelineno-49-71 name=__codelineno-49-71 href=#__codelineno-49-71></a>/var/log/usbupdate-server/current
<a id=__codelineno-49-72 name=__codelineno-49-72 href=#__codelineno-49-72></a>/var/log/valhalla/current
<a id=__codelineno-49-73 name=__codelineno-49-73 href=#__codelineno-49-73></a>/var/log/vaultd/current
<a id=__codelineno-49-74 name=__codelineno-49-74 href=#__codelineno-49-74></a>/var/log/vod/current
<a id=__codelineno-49-75 name=__codelineno-49-75 href=#__codelineno-49-75></a>/var/log/watchdog/current
<a id=__codelineno-49-76 name=__codelineno-49-76 href=#__codelineno-49-76></a>/var/log/webcam/current
<a id=__codelineno-49-77 name=__codelineno-49-77 href=#__codelineno-49-77></a>/var/log/wifi-stats/current
<a id=__codelineno-49-78 name=__codelineno-49-78 href=#__codelineno-49-78></a>/var/log/wpa_supplicant/current
<a id=__codelineno-49-79 name=__codelineno-49-79 href=#__codelineno-49-79></a>/var/log/x/current
</code></pre></div> <h3 id=appendix-c-svlogd-configuration-commands>Appendix C: svlogd Configuration Commands</h3> <table> <thead> <tr> <th>Directive</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td><code>s&lt;bytes&gt;</code></td> <td>Rotate when current exceeds <code>&lt;bytes&gt;</code></td> </tr> <tr> <td><code>n&lt;count&gt;</code></td> <td>Keep max <code>&lt;count&gt;</code> rotated logs</td> </tr> <tr> <td><code>N&lt;count&gt;</code></td> <td>Keep min <code>&lt;count&gt;</code> logs (space protection)</td> </tr> <tr> <td><code>t&lt;seconds&gt;</code></td> <td>Rotate every <code>&lt;seconds&gt;</code></td> </tr> <tr> <td><code>!&lt;cmd&gt;</code></td> <td>Run <code>&lt;cmd&gt;</code> on rotation (receives rotated file on stdin)</td> </tr> <tr> <td><code>-&lt;pattern&gt;</code></td> <td>Exclude lines matching <code>&lt;pattern&gt;</code></td> </tr> <tr> <td><code>+&lt;pattern&gt;</code></td> <td>Include only lines matching <code>&lt;pattern&gt;</code></td> </tr> <tr> <td><code>0&lt;text&gt;</code></td> <td>Insert <code>&lt;text&gt;</code> at service startup</td> </tr> </tbody> </table> <h3 id=appendix-d-feature-flags>Appendix D: Feature Flags</h3> <table> <thead> <tr> <th>Flag</th> <th>Purpose</th> <th>Impact</th> </tr> </thead> <tbody> <tr> <td><code>FEATURE_prodHistoryLogsEnabled</code></td> <td>Enable historical log uploads in production</td> <td>If false, hermes_historylogs exits</td> </tr> <tr> <td><code>FEATURE_earlyWaveCellNetworkingOk</code></td> <td>Enable early wave cellular uploads</td> <td>More aggressive cellular data usage</td> </tr> <tr> <td><code>FEATURE_enableTestDriveMode</code></td> <td>Test drive mode (pre-delivery)</td> <td>Affects pseudonym enforcement</td> </tr> <tr> <td><code>HERMES_EVENTLOGS_DISABLE</code></td> <td>Disable eventlogs service</td> <td>Emergency kill switch</td> </tr> </tbody> </table> <h3 id=appendix-e-binary-analysis-strings-sample>Appendix E: Binary Analysis Strings (Sample)</h3> <p><strong>hermes_eventlogs:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a>location
<a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a>GPS
<a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a>latitude
<a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a>longitude
<a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a>VIN
<a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a>telemetry
<a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a>/var/log/
<a id=__codelineno-50-8 name=__codelineno-50-8 href=#__codelineno-50-8></a>senderid
<a id=__codelineno-50-9 name=__codelineno-50-9 href=#__codelineno-50-9></a>vin
<a id=__codelineno-50-10 name=__codelineno-50-10 href=#__codelineno-50-10></a>platform
<a id=__codelineno-50-11 name=__codelineno-50-11 href=#__codelineno-50-11></a>firmware-version
<a id=__codelineno-50-12 name=__codelineno-50-12 href=#__codelineno-50-12></a>hermes_client_stopped
<a id=__codelineno-50-13 name=__codelineno-50-13 href=#__codelineno-50-13></a>hermes_client_disconnected
<a id=__codelineno-50-14 name=__codelineno-50-14 href=#__codelineno-50-14></a>connection_status_change
<a id=__codelineno-50-15 name=__codelineno-50-15 href=#__codelineno-50-15></a>cell_rate_limit_exceeded
<a id=__codelineno-50-16 name=__codelineno-50-16 href=#__codelineno-50-16></a>failed_to_enqueue_events
<a id=__codelineno-50-17 name=__codelineno-50-17 href=#__codelineno-50-17></a>deleting_corrupted_queue
</code></pre></div> <p><strong>hermes_historylogs:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a>/var/log/
<a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>VIN
<a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a>upload
<a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a>file-paths
<a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a>start-marker
<a id=__codelineno-51-6 name=__codelineno-51-6 href=#__codelineno-51-6></a>start-offset
<a id=__codelineno-51-7 name=__codelineno-51-7 href=#__codelineno-51-7></a>platform
<a id=__codelineno-51-8 name=__codelineno-51-8 href=#__codelineno-51-8></a>boot-id
<a id=__codelineno-51-9 name=__codelineno-51-9 href=#__codelineno-51-9></a>fw
<a id=__codelineno-51-10 name=__codelineno-51-10 href=#__codelineno-51-10></a>release-scope
<a id=__codelineno-51-11 name=__codelineno-51-11 href=#__codelineno-51-11></a>hermesenv
</code></pre></div> <hr> <h2 id=references>References</h2> <ol> <li>Firmware dumps: <code>/firmware/model3y-extracted/</code>, <code>/firmware/mcu2-extracted/</code></li> <li>Gateway log analysis: <code>/research/09-gateway-sdcard-log-analysis.md</code></li> <li>Hermes research: <code>/workspace/workspace/tesla-hermes-research.md</code></li> <li>Configuration files:</li> <li><code>/etc/hermes-eventlogs.vars</code></li> <li><code>/etc/hermes-historylogs.vars</code></li> <li><code>/etc/hermes-urls.vars</code></li> <li><code>/etc/canlogs.vars</code></li> <li>Service definitions: <code>/etc/sv/hermes-*/run</code></li> <li>Binary analysis: <code>/opt/hermes/hermes_*</code> (strings, file analysis)</li> </ol> <hr> <p><strong>Document Version:</strong> 1.0<br> <strong>Last Updated:</strong> February 3, 2026, 04:08 UTC<br> <strong>Analyst:</strong> Security Platform Research Subagent</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/talas9/tesla target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>