<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Comprehensive security analysis of Tesla Model S/X/3/Y MCU2 and Gateway"><meta name=author content="Security Researcher"><link href=https://talas9.github.io/tesla-research/ape/44-mcu-networking-deep-dive/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>MCU2 Network Security Deep Dive - Tesla MCU2 Security Research</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#mcu2-network-security-deep-dive class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Tesla MCU2 Security Research" class="md-header__button md-logo" aria-label="Tesla MCU2 Security Research" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tesla MCU2 Security Research </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> MCU2 Network Security Deep Dive </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=red data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/talas9/tesla-research title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla-research </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../INDEX/ class=md-tabs__link> Complete Index </a> </li> <li class=md-tabs__item> <a href=../../DEPLOYMENT/ class=md-tabs__link> Deployment Guide </a> </li> <li class=md-tabs__item> <a href=../../core/00-master-cross-reference/ class=md-tabs__link> Core Research </a> </li> <li class=md-tabs__item> <a href=../../gateway/81-gateway-secure-configs-CRITICAL/ class=md-tabs__link> Gateway Security </a> </li> <li class=md-tabs__item> <a href=../../mcu/24-mcu-architecture.md class=md-tabs__link> MCU Research </a> </li> <li class=md-tabs__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-tabs__link> Evidence & Audit </a> </li> <li class=md-tabs__item> <a href=../../tools/56-tools-gateway-database-query.md class=md-tabs__link> Tools & Scripts </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Tesla MCU2 Security Research" class="md-nav__button md-logo" aria-label="Tesla MCU2 Security Research" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Tesla MCU2 Security Research </label> <div class=md-nav__source> <a href=https://github.com/talas9/tesla-research title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla-research </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../INDEX/ class=md-nav__link> <span class=md-ellipsis> Complete Index </span> </a> </li> <li class=md-nav__item> <a href=../../DEPLOYMENT/ class=md-nav__link> <span class=md-ellipsis> Deployment Guide </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Core Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Core Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../core/00-master-cross-reference/ class=md-nav__link> <span class=md-ellipsis> Master Cross-Reference </span> </a> </li> <li class=md-nav__item> <a href=../../core/02-gateway-can-flood-exploit/ class=md-nav__link> <span class=md-ellipsis> Gateway CAN Flood Exploit </span> </a> </li> <li class=md-nav__item> <a href=../../core/03-certificate-recovery-orphan-cars/ class=md-nav__link> <span class=md-ellipsis> Certificate Recovery </span> </a> </li> <li class=md-nav__item> <a href=../../core/04-network-ports-firewall/ class=md-nav__link> <span class=md-ellipsis> Network Topology </span> </a> </li> <li class=md-nav__item> <a href=../../core/06-usb-firmware-update/ class=md-nav__link> <span class=md-ellipsis> USB Firmware Update </span> </a> </li> <li class=md-nav__item> <a href=../../core/07-usb-map-installation/ class=md-nav__link> <span class=md-ellipsis> USB Map Installation </span> </a> </li> <li class=md-nav__item> <a href=../../core/08-key-programming-vcsec/ class=md-nav__link> <span class=md-ellipsis> Key Programming </span> </a> </li> <li class=md-nav__item> <a href=../../core/13-ota-handshake-protocol/ class=md-nav__link> <span class=md-ellipsis> OTA Protocol </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Gateway Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Gateway Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gateway/81-gateway-secure-configs-CRITICAL/ class=md-nav__link> <span class=md-ellipsis> üîí CRITICAL: Secure Configs </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/80-ryzen-gateway-flash-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> ‚úÖ Complete Flash Dump </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/82-odin-routines-database-UNHASHED/ class=md-nav__link> <span class=md-ellipsis> üîì Odin Database </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/92-config-metadata-table-FOUND/ class=md-nav__link> <span class=md-ellipsis> üéØ Config Metadata Table </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/83-odin-config-api-analysis/ class=md-nav__link> <span class=md-ellipsis> Odin Config API </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/84-gw-diag-command-reference/ class=md-nav__link> <span class=md-ellipsis> gw-diag Commands </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/88-gateway-strings-analysis/ class=md-nav__link> <span class=md-ellipsis> Gateway Strings </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/91-gateway-powerpc-disassembly-summary/ class=md-nav__link> <span class=md-ellipsis> PowerPC Disassembly </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/94-gateway-ALL-FUNCTIONS/ class=md-nav__link> <span class=md-ellipsis> All Functions </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/95-gateway-CAN-MESSAGES-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> CAN Messages Complete </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/96-gateway-DATA-TABLES/ class=md-nav__link> <span class=md-ellipsis> All Data Tables </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/97-gateway-MEMORY-MAP/ class=md-nav__link> <span class=md-ellipsis> Memory Map </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/98-SHA-256-USAGE-ANALYSIS/ class=md-nav__link> <span class=md-ellipsis> SHA-256 Usage </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/99-gateway-FIRMWARE-METADATA/ class=md-nav__link> <span class=md-ellipsis> Firmware Metadata </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/55-gateway-spc-chip-replacement/ class=md-nav__link> <span class=md-ellipsis> SPC Chip Replacement </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> MCU Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> MCU Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mcu/24-mcu-architecture.md class=md-nav__link> <span class=md-ellipsis> MCU Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/25-mcu-boot-sequence.md class=md-nav__link> <span class=md-ellipsis> Boot Sequence </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/28-mcu-qtcarserver.md class=md-nav__link> <span class=md-ellipsis> QtCarServer Security </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/31-mcu-chromium-security.md class=md-nav__link> <span class=md-ellipsis> Chromium Security </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Evidence & Audit </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Evidence & Audit </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-nav__link> <span class=md-ellipsis> Evidence Audit </span> </a> </li> <li class=md-nav__item> <a href=../../VERIFICATION-STATUS/ class=md-nav__link> <span class=md-ellipsis> Verification Status </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Tools & Scripts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Tools & Scripts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/56-tools-gateway-database-query.md class=md-nav__link> <span class=md-ellipsis> Gateway CRC Validator </span> </a> </li> <li class=md-nav__item> <a href=#scripts class=md-nav__link> <span class=md-ellipsis> Download Scripts </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=mcu2-network-security-deep-dive>MCU2 Network Security Deep Dive</h1> <p><strong>Complete networking analysis of Tesla MCU2 firmware</strong> <strong>Source:</strong> <code>/root/downloads/mcu2-extracted</code> <strong>Analysis Date:</strong> 2025-02-03</p> <hr> <h2 id=table-of-contents>Table of Contents</h2> <ol> <li><a href=#executive-summary>Executive Summary</a></li> <li><a href=#network-architecture>Network Architecture</a></li> <li><a href=#firewall-analysis>Firewall Analysis</a></li> <li><a href=#port-inventory>Port Inventory</a></li> <li><a href=#service-mappings>Service Mappings</a></li> <li><a href=#access-control-matrix>Access Control Matrix</a></li> <li><a href=#attack-surface-analysis>Attack Surface Analysis</a></li> <li><a href=#security-findings>Security Findings</a></li> </ol> <hr> <h2 id=executive-summary>Executive Summary</h2> <ul> <li><strong>Total Services Analyzed:</strong> 219</li> <li><strong>Firewall Rules:</strong> 82 service-specific configurations</li> <li><strong>Unique Ports Identified:</strong> 139</li> <li><strong>Firewall Chains:</strong> APE_INPUT, INTERNET</li> </ul> <h2 id=network-architecture>Network Architecture</h2> <h3 id=subnet-map>Subnet Map</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>‚îÇ  Tesla MCU2 Network Architecture               ‚îÇ
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>‚îÇ                                                 ‚îÇ
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>‚îÇ  192.168.90.100 - MCU (Media Control Unit)     ‚îÇ
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>‚îÇ       ‚îú‚îÄ eth0: Internal APE network            ‚îÇ
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>‚îÇ       ‚îú‚îÄ wlan0: WiFi (NAT to internet)         ‚îÇ
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>‚îÇ       ‚îú‚îÄ eth0.2: Cellular (NAT to internet)    ‚îÇ
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>‚îÇ       ‚îî‚îÄ lo: Localhost services                ‚îÇ
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>‚îÇ                                                 ‚îÇ
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>‚îÇ  192.168.90.103 - APE (Autopilot A)            ‚îÇ
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>‚îÇ  192.168.90.105 - APEB (Autopilot B)           ‚îÇ
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>‚îÇ  192.168.90.104 - AURIX (Gateway/GPS)          ‚îÇ
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>‚îÇ  192.168.90.102 - GTW (CAN Gateway)            ‚îÇ
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>‚îÇ                                                 ‚îÇ
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>‚îÇ  Multicast Groups:                              ‚îÇ
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>‚îÇ    224.0.0.154 - UI Server messages            ‚îÇ
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>‚îÇ    224.0.0.155 - Dashcam streams               ‚îÇ
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>‚îÇ    224.0.1.129 - PTP (Precision Time Protocol) ‚îÇ
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>‚îÇ                                                 ‚îÇ
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>‚îÇ  NAT Subnet: 192.168.10.0/24                   ‚îÇ
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>‚îÇ  Link-Local: 169.254.0.0/16 (DoIP/UDS)         ‚îÇ
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div> <h2 id=firewall-analysis>Firewall Analysis</h2> <h3 id=main-firewall-chains>Main Firewall Chains</h3> <h4 id=ape_input>APE_INPUT</h4> <p><strong>Purpose:</strong> Controls incoming traffic from Autopilot computers</p> <p><strong>Allowed Services:</strong> - <code>-A APE_INPUT -i eth0 -p udp -s $APE_LIST -d 192.168.90.100 --dport 123 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p tcp -s $APE_LIST -d 192.168.90.100 --dport 20564 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p tcp -s $APE_LIST -d 192.168.90.100 -m multiport --dports 8443,8444,8900 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p tcp -s $APE_LIST -d 192.168.90.100 -m multiport --dports 9892,9893,9894,9898,9897,9896,9900 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p udp -s $APE_LIST -d 192.168.90.100 -m multiport --dports 5353,5354 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p udp -s $APE_LIST -d 224.0.0.155 -m multiport --dports 9892,9893,9894,9895,9896,9897,9898,9900,9901,9902,9903 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p udp -s $APE_LIST -d 224.0.0.154 --dport 5424 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p udp -s $APE_LIST -d 192.168.90.100 --dport 8906 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p tcp -s $APE_LIST -d 192.168.90.100 --match multiport --dports 20565,20566 -j ACCEPT"</code> - <code>-A APE_INPUT -i eth0 -p udp -s 192.168.90.103/32 -d 224.0.1.129/32 --sport 319 --dport 319 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p udp -s 192.168.90.103/32 -d 224.0.1.129/32 --sport 320 --dport 320 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p udp -s $APE_LIST -d 192.168.90.100 -m multiport --dports 8610,8611 -j ACCEPT</code> - <code>-A APE_INPUT -i eth0 -p udp -s $APE_LIST -d 192.168.90.100 --dport 9899 -j ACCEPT"</code> - <code>-A APE_INPUT -i eth0 -p udp -s 192.168.90.104 -d 192.168.90.100,192.168.90.255 --dport 63277 -j ACCEPT"</code> - <code>-A APE_INPUT -i eth0 -p udp -s $APE_LIST -d 192.168.90.100,192.168.90.255 --dport 63277 -j ACCEPT"</code></p> <h4 id=internet>INTERNET</h4> <p><strong>Purpose:</strong> Sandbox for services needing internet access</p> <p><strong>Key Rules:</strong> - Blocks all RFC1918 private networks (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) - Blocks multicast (224.0.0.0/4) - Allows DNS to 127.0.0.1:53 - REJECTS local network access (logged) - In FACTORY mode: Opens port 8080 for debug</p> <h2 id=port-inventory>Port Inventory</h2> <h3 id=all-listening-ports>All Listening Ports</h3> <table> <thead> <tr> <th>Port</th> <th>Service</th> <th>Protocol</th> <th>Interface</th> <th>Allowed Sources</th> <th>Auth</th> </tr> </thead> <tbody> <tr> <td>53</td> <td>connmand</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>dnsmasq</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>dnsmasq</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>ntpd</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>ntpd</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>53</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>53</td> <td>qtcar-gpsmanager</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>qtcar-mediaserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>qtcar-spotifyserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>53</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>67</td> <td>connmand</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>69</td> <td>harman-tuner</td> <td>TCP</td> <td>eth0, eth0</td> <td>192.168.90.30/32, 192.168.90.30/32</td> <td>?</td> </tr> <tr> <td>69</td> <td>harman-tuner</td> <td>TCP</td> <td>eth0, eth0</td> <td>192.168.90.30/32, 192.168.90.30/32</td> <td>?</td> </tr> <tr> <td>80</td> <td>connmand</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>80</td> <td>connmand</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>80</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>80</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>80</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>123</td> <td>modem</td> <td>TCP</td> <td>eth0, eth0</td> <td>192.168.90.60, 192.168.90.60</td> <td>?</td> </tr> <tr> <td>443</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>443</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>443</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>443</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>443</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>443</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>443</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>1234</td> <td>service-ui</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>1235</td> <td>service-ui</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>1666</td> <td>hermes-livestream</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>1667</td> <td>hermes-livestream</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>3500</td> <td>hermes-livestream</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>3500</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4029</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4030</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>4030</td> <td>drmlog</td> <td>TCP</td> <td></td> <td>127.0.0.1</td> <td>?</td> </tr> <tr> <td>4030</td> <td>qtcar-audiod</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4030</td> <td>qtcar-monitor</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4030</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4030</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4030</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4030</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4030</td> <td>videod</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4030</td> <td>webcam</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4031</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4032</td> <td>chromium-app</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4032</td> <td>qtcar-audiod</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4032</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4032</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4032</td> <td>qtcar-monitor</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4032</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4033</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4034</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4035</td> <td>mounterd</td> <td>TCP</td> <td></td> <td>127.0.0.1</td> <td>?</td> </tr> <tr> <td>4035</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4035</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4035</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4040</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4050</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4050</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4050</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4050</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4051</td> <td>qtcar-audiod</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4051</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4051</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4060</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4060</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4060</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4061</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4061</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4070</td> <td>qtcar-audiod</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4070</td> <td>qtcar-bluetooth</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4070</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4070</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4070</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4071</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4071</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4072</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4073</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4080</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4082</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4083</td> <td>qtcar-mediaserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4090</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4090</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4090</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4091</td> <td>qtcar-bluetooth</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4091</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4093</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4094</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4094</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4094</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>4095</td> <td>qtcar-bluetooth</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4095</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4096</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4096</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4097</td> <td>qtcar-bluetooth</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4097</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4110</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4111</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4130</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4131</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4131</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4146</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4148</td> <td>qtcar-mediaserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4160</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4161</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4161</td> <td>qtcar-gpsmanager</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4163</td> <td>qtcar-gpsmanager</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4165</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4165</td> <td>qtcar-gpsmanager</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4171</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4181</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4181</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4201</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4210</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4211</td> <td>qtcar-spotifyserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4220</td> <td>qtcar-spotifyserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4241</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4251</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4251</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4280</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4280</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4281</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4400</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>4400</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4400</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4401</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4500</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4501</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4504</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4505</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4505</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4506</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4508</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4509</td> <td>qtcar-bluetooth</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4509</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4512</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4513</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4520</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4522</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4524</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4525</td> <td>qtcar-energymonitor</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4525</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4531</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4541</td> <td>chromium-adapter</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4567</td> <td>owners-manual-download</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4567</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4567</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4567</td> <td>release-notes-download</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4567</td> <td>tesla-tts-service</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4570</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4599</td> <td>harman-tuner</td> <td>TCP</td> <td>eth0, eth0</td> <td>192.168.90.30/32, 192.168.90.30/32</td> <td>?</td> </tr> <tr> <td>4599</td> <td>harman-tuner</td> <td>TCP</td> <td>eth0, eth0</td> <td>192.168.90.30/32, 192.168.90.30/32</td> <td>?</td> </tr> <tr> <td>4600</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4601</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4998</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4998</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4999</td> <td>chromium-adapter</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-audiod</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-bluetooth</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-connman</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-dvserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-energymonitor</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-gpsmanager</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-mediaserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar-spotifyserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4999</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>4999</td> <td>valhalla</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>5161</td> <td>qtcar-gpsmanager</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>5165</td> <td>qtcar-gpsmanager</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>5354</td> <td>dashcam</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>5424</td> <td>qtcar-cluster</td> <td>TCP</td> <td></td> <td>127.0.0.1/32, 192.168.90.100/32</td> <td>?</td> </tr> <tr> <td>5424</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>5555</td> <td>harman-tuner</td> <td>TCP</td> <td>eth0, eth0</td> <td>192.168.90.30/32, 192.168.90.30/32</td> <td>?</td> </tr> <tr> <td>5555</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>5801</td> <td>modem</td> <td>TCP</td> <td>eth0, eth0</td> <td>192.168.90.60, 192.168.90.60</td> <td>?</td> </tr> <tr> <td>5801</td> <td>modem</td> <td>TCP</td> <td>eth0, eth0</td> <td>192.168.90.60, 192.168.90.60</td> <td>?</td> </tr> <tr> <td>7654</td> <td>qtcar-monitor</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>7654</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>7654</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>7654</td> <td>toolbox-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 127.0.0.1</td> <td>?</td> </tr> <tr> <td>8000</td> <td>chromium-odin</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>8000</td> <td>chromium-odin</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>8002</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>8080</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>8080</td> <td>service-ui</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>8081</td> <td>service-shell</td> <td>TCP</td> <td>eth0, lo</td> <td>192.168.90.30,192.168.90.60, 192.168.90.101,192.168.90.102,192.168.90.103,192.168.90.104,192.168.90.105,192.168.90.106,192.168.90.107</td> <td>?</td> </tr> <tr> <td>8082</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>8088</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>8443</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>8444</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>8610</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>8611</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> <tr> <td>8885</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>8888</td> <td>autopilot-api</td> <td>TCP</td> <td>eth0</td> <td>192.168.90.100, 192.168.90.103,192.168.90.105</td> <td>?</td> </tr> <tr> <td>8888</td> <td>qtcar-radioserver</td> <td>TCP</td> <td></td> <td></td> <td>?</td> </tr> <tr> <td>8888</td> <td>qtcar</td> <td>TCP</td> <td></td> <td>192.168.90.100/32, 127.0.0.1/32</td> <td>?</td> </tr> </tbody> </table> <h2 id=service-mappings>Service Mappings</h2> <h3 id=runit-services-with-network-access>Runit Services with Network Access</h3> <h4 id=alertd>alertd</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=ape-deliver>ape-deliver</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=audiod>audiod</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=autopilot-api>autopilot-api</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=bwlogger>bwlogger</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=cadmium>cadmium</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=calico>calico</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=carbonado>carbonado</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=cerulean>cerulean</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=cgdo>cgdo</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=chromium>chromium</h4> <ul> <li><strong>User:</strong> <code>chromium</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> False</li> <li><strong>Ports:</strong> 49508</li> </ul> <h4 id=chromium-adapter>chromium-adapter</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=chromium-app>chromium-app</h4> <ul> <li><strong>User:</strong> <code>chromium-app</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> <li><strong>Ports:</strong> 9000</li> </ul> <h4 id=chromium-card>chromium-card</h4> <ul> <li><strong>User:</strong> <code>chromium</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> False</li> <li><strong>Ports:</strong> 49508</li> </ul> <h4 id=chromium-card-webapp-adapter>chromium-card-webapp-adapter</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> False</li> <li><strong>Ports:</strong> 49508</li> </ul> <h4 id=chromium-card-webapp-http>chromium-card-webapp-http</h4> <ul> <li><strong>User:</strong> <code>root</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> False</li> <li><strong>Ports:</strong> 49508, 49509</li> </ul> <h4 id=chromium-fullscreen>chromium-fullscreen</h4> <ul> <li><strong>User:</strong> <code>chromium-fullscreen</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> </ul> <h4 id=chromium-odin>chromium-odin</h4> <ul> <li><strong>User:</strong> <code>chromium-odin</code></li> <li><strong>Sandboxed:</strong> True</li> <li><strong>Network Namespace:</strong> False</li> <li><strong>Firewall Rules:</strong> True</li> <li><strong>Ports:</strong> 8000</li> </ul> <h2 id=access-control-matrix>Access Control Matrix</h2> <h3 id=critical-services>Critical Services</h3> <table> <thead> <tr> <th>Service</th> <th>Ports</th> <th>Allowed From</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td>autopilot-api</td> <td>8443, 8444, 8885, 8888, 8900, 19004</td> <td>APE</td> <td>API/Service</td> </tr> <tr> <td>qtcar</td> <td>4070, 4080, 4220, 23001</td> <td>APE</td> <td>API/Service</td> </tr> <tr> <td>toolbox-api</td> <td>4030, 4035, 4050, 4060, 4090, 4094, 7654</td> <td>APE</td> <td>API/Service</td> </tr> <tr> <td>service-shell</td> <td>8081</td> <td>APE</td> <td>API/Service</td> </tr> <tr> <td>updater</td> <td>20564</td> <td>?</td> <td>API/Service</td> </tr> </tbody> </table> <h2 id=attack-surface-analysis>Attack Surface Analysis</h2> <h3 id=external-attack-surface-from-ape-network>External Attack Surface (from APE network)</h3> <p><strong>Ports accessible from 192.168.90.103/105 (Autopilot computers):</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>APE-Accessible Ports:
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>  - 20564
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>  - 5424
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>  - 20565,20566
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>  - 320
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>  - 8443,8444,8900
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>  - 319
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>  - 8610,8611
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>  - 9892,9893,9894,9895,9896,9897,9898,9900,9901,9902,9903
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>  - 123
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>  - 8906
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>  - 5353,5354
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>  - 63277
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>  - 9892,9893,9894,9898,9897,9896,9900
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>  - 9899
</code></pre></div> <h3 id=localhost-only-services>Localhost-Only Services</h3> <p>Services bound to 127.0.0.1 (not accessible from network):</p> <ul> <li>qtcar-spotifyserver</li> <li>service-ui</li> <li>bwlogger</li> <li>service-shell</li> <li>chromium-app</li> <li>qtcar-gpsmanager</li> <li>qtcar-mediaserver</li> <li>audiod</li> <li>qtcar-cluster</li> <li>owners-manual-adapter</li> <li>linuxvm-logger</li> <li>ntpd</li> <li>owners-manual</li> <li>ubloxd</li> <li>release-notes-adapter</li> <li>dashcam</li> <li>qtcar-audiod</li> <li>toolbox-api</li> <li>qtcar-radioserver</li> <li>chromium-adapter</li> </ul> <h2 id=security-findings>Security Findings</h2> <h3 id=high-risk-services>High-Risk Services</h3> <ol> <li><strong>service-shell (port 8081)</strong></li> <li>Shell access service</li> <li> <p>Needs analysis for authentication</p> </li> <li> <p><strong>toolbox-api (multiple ports)</strong></p> </li> <li>Diagnostic/debug API</li> <li> <p>Accessible from APE in some modes</p> </li> <li> <p><strong>autopilot-api (ports 8443, 8444, etc)</strong></p> </li> <li>Critical AP communication</li> <li>Limited to APE IPs (good)</li> </ol> <h3 id=network-isolation>Network Isolation</h3> <p><strong>INTERNET Chain Effectiveness:</strong> - ‚úÖ Blocks RFC1918 networks - ‚úÖ Logs violations before dropping - ‚úÖ Prevents services from accessing internal APIs via internet - ‚ö†Ô∏è Factory mode opens port 8080 (debug backdoor)</p> <p><strong>RunSandbox Usage:</strong> - 107/219 services use RunSandbox - RunSandbox enforces cgroup-based firewall rules</p> <h3 id=key-vulnerabilities-misconfigurations>Key Vulnerabilities &amp; Misconfigurations</h3> <ol> <li><strong>Factory Debug Mode</strong></li> <li>If <code>FACTORY_DEBUG=1</code> and unfused: port 8080 exposed</li> <li>Allows internal API access from internet-connected services</li> <li> <p>File: <code>/sbin/firewall</code> lines ~95-100</p> </li> <li> <p><strong>Multicast Exposure</strong></p> </li> <li>224.0.0.154, 224.0.0.155 used for UI/dashcam</li> <li>Any device on 192.168.90.x can join multicast groups</li> <li> <p>Potential for eavesdropping on internal messages</p> </li> <li> <p><strong>DoIP Gateway (port 13400)</strong></p> </li> <li>Link-local 169.254.0.0/16 access</li> <li>Used for UDS diagnostics</li> <li>NAT rules redirect to 192.168.93.82 namespace</li> </ol> <h3 id=recommendations>Recommendations</h3> <ol> <li>Audit all services listening on <code>0.0.0.0</code></li> <li>Verify authentication on APE-accessible ports</li> <li>Review factory mode conditions (<code>is-in-factory</code>, <code>is-factory-gated</code>)</li> <li>Analyze RunSandbox cgroup assignments for privilege escalation</li> <li>Map all multicast subscribers and message formats</li> </ol> <hr> <h2 id=appendix-raw-firewall-rules>Appendix: Raw Firewall Rules</h2> <h3 id=main-firewall-script>Main Firewall Script</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=ch>#!/bin/sh</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>die<span class=w> </span><span class=o>()</span><span class=w> </span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=o>{</span><span class=w> </span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;ERROR: </span><span class=nv>$*</span><span class=s2>&quot;</span><span class=w> </span><span class=m>1</span>&gt;<span class=p>&amp;</span><span class=m>2</span><span class=p>;</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>    </span><span class=nb>exit</span><span class=w> </span><span class=m>1</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=o>}</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=nv>APE_ADDR</span><span class=o>=</span><span class=m>192</span>.168.90.103
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=nv>APEB_ADDR</span><span class=o>=</span><span class=m>192</span>.168.90.105
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=nv>APE_LIST</span><span class=o>=</span><span class=nv>$APE_ADDR</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=nv>CHASSIS</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>cat<span class=w> </span>/var/etc/chassistype<span class=k>)</span><span class=s2>&quot;</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=k>case</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$CHASSIS</span><span class=s2>&quot;</span><span class=w> </span><span class=k>in</span><span class=w> </span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=w>    </span>Model3<span class=o>)</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=w>        </span><span class=nv>FACTORY_DEBUG</span><span class=o>=</span><span class=m>1</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=w>    </span><span class=p>;;</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=w>    </span>ModelY<span class=o>)</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=w>        </span><span class=nv>FACTORY_DEBUG</span><span class=o>=</span><span class=m>1</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=w>    </span><span class=p>;;</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=k>esac</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=nv>DASHW</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>cat<span class=w> </span>/var/etc/dashw<span class=k>)</span><span class=s2>&quot;</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=k>case</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$DASHW</span><span class=s2>&quot;</span><span class=w> </span><span class=k>in</span><span class=w> </span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=w>    </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=p>|</span><span class=w> </span>*<span class=o>[</span>!0-9<span class=o>]</span>*<span class=o>)</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;WARNING: dashw file corrupted or does not exist&quot;</span><span class=w> </span><span class=m>1</span>&gt;<span class=p>&amp;</span><span class=m>2</span><span class=p>;</span><span class=w> </span><span class=nv>DASHW</span><span class=o>=</span><span class=m>3</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=w>    </span><span class=p>;;</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=k>esac</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$DASHW</span><span class=s2>&quot;</span><span class=w> </span>-ge<span class=w> </span><span class=m>3</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=w>    </span><span class=nv>APE_LIST</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$APE_ADDR</span><span class=s2>,</span><span class=nv>$APEB_ADDR</span><span class=s2>&quot;</span><span class=p>;</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=k>fi</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a>cat<span class=w> </span><span class=s>&lt;&lt;EOF |</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=s># First, let&#39;s set our nat rules.</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=s>*nat</span>
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=s>:PRE</span>ROUTING<span class=w> </span>ACCEPT<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a>:INPUT<span class=w> </span>ACCEPT<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a>:OUTPUT<span class=w> </span>ACCEPT<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a>:POSTROUTING<span class=w> </span>ACCEPT<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a>-A<span class=w> </span>POSTROUTING<span class=w> </span>-o<span class=w> </span>eth0.2<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.10.0/24<span class=w> </span>-j<span class=w> </span>MASQUERADE
<a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a>-A<span class=w> </span>POSTROUTING<span class=w> </span>-o<span class=w> </span>wlan0<span class=w>  </span>-s<span class=w> </span><span class=m>192</span>.168.10.0/24<span class=w> </span>-j<span class=w> </span>MASQUERADE
<a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=c1># nat rules for re-directing UDS traffic between doip-gateway and GTW</span>
<a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a>-A<span class=w> </span>PREROUTING<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span>gw<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--sport<span class=w> </span><span class=m>10001</span><span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>-j<span class=w> </span>DNAT<span class=w> </span>--to-destination<span class=w> </span><span class=m>192</span>.168.93.82
<a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a>-A<span class=w> </span>POSTROUTING<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.93.82<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-o<span class=w> </span>eth0<span class=w> </span>-d<span class=w> </span>gw<span class=w> </span>--dport<span class=w> </span><span class=m>10001</span><span class=w> </span>-j<span class=w> </span>SNAT<span class=w> </span>--to-source<span class=w> </span><span class=m>192</span>.168.90.100
<a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a>
<a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a>COMMIT
<a id=__codelineno-2-48 name=__codelineno-2-48 href=#__codelineno-2-48></a>
<a id=__codelineno-2-49 name=__codelineno-2-49 href=#__codelineno-2-49></a><span class=c1># Set the default policies.  No filtering on outgoing packets.</span>
<a id=__codelineno-2-50 name=__codelineno-2-50 href=#__codelineno-2-50></a>*filter
<a id=__codelineno-2-51 name=__codelineno-2-51 href=#__codelineno-2-51></a>:INPUT<span class=w> </span>DROP<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-52 name=__codelineno-2-52 href=#__codelineno-2-52></a>:FORWARD<span class=w> </span>DROP<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-53 name=__codelineno-2-53 href=#__codelineno-2-53></a>:OUTPUT<span class=w> </span>ACCEPT<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-54 name=__codelineno-2-54 href=#__codelineno-2-54></a>
<a id=__codelineno-2-55 name=__codelineno-2-55 href=#__codelineno-2-55></a><span class=c1># Create the rest of our chains</span>
<a id=__codelineno-2-56 name=__codelineno-2-56 href=#__codelineno-2-56></a>:APE_INPUT<span class=w> </span>-<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-57 name=__codelineno-2-57 href=#__codelineno-2-57></a>
<a id=__codelineno-2-58 name=__codelineno-2-58 href=#__codelineno-2-58></a><span class=c1>#</span>
<a id=__codelineno-2-59 name=__codelineno-2-59 href=#__codelineno-2-59></a><span class=c1># Install input chain rules for doip-gateway.</span>
<a id=__codelineno-2-60 name=__codelineno-2-60 href=#__codelineno-2-60></a><span class=c1>#</span>
<a id=__codelineno-2-61 name=__codelineno-2-61 href=#__codelineno-2-61></a><span class=c1># TCP and UDP data within link-local range:</span>
<a id=__codelineno-2-62 name=__codelineno-2-62 href=#__codelineno-2-62></a>-A<span class=w> </span>INPUT<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-s<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-d<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>--dport<span class=w> </span><span class=m>13400</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-63 name=__codelineno-2-63 href=#__codelineno-2-63></a>-A<span class=w> </span>INPUT<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-p<span class=w> </span>udp<span class=w> </span>-s<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-d<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>--dport<span class=w> </span><span class=m>13400</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-64 name=__codelineno-2-64 href=#__codelineno-2-64></a>
<a id=__codelineno-2-65 name=__codelineno-2-65 href=#__codelineno-2-65></a><span class=c1># forward icmp traffic inbound/outbound</span>
<a id=__codelineno-2-66 name=__codelineno-2-66 href=#__codelineno-2-66></a>-A<span class=w> </span>FORWARD<span class=w> </span>-i<span class=w> </span>veth0<span class=w> </span>-p<span class=w> </span>icmp<span class=w> </span>-s<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-o<span class=w> </span>eth0<span class=w>  </span>-d<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-67 name=__codelineno-2-67 href=#__codelineno-2-67></a>-A<span class=w> </span>FORWARD<span class=w> </span>-i<span class=w> </span>eth0<span class=w>  </span>-p<span class=w> </span>icmp<span class=w> </span>-s<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-o<span class=w> </span>veth0<span class=w> </span>-d<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-68 name=__codelineno-2-68 href=#__codelineno-2-68></a>
<a id=__codelineno-2-69 name=__codelineno-2-69 href=#__codelineno-2-69></a><span class=c1># forward tcp traffic inbound/outbound</span>
<a id=__codelineno-2-70 name=__codelineno-2-70 href=#__codelineno-2-70></a>-A<span class=w> </span>FORWARD<span class=w> </span>-i<span class=w> </span>eth0<span class=w>  </span>-p<span class=w> </span>tcp<span class=w> </span>-s<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-o<span class=w> </span>veth0<span class=w> </span>-d<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>--dport<span class=w> </span><span class=m>13400</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-71 name=__codelineno-2-71 href=#__codelineno-2-71></a>-A<span class=w> </span>FORWARD<span class=w> </span>-i<span class=w> </span>veth0<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-s<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>--sport<span class=w> </span><span class=m>13400</span><span class=w> </span>-o<span class=w> </span>eth0<span class=w>  </span>-d<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-m<span class=w> </span>conntrack<span class=w> </span>--ctstate<span class=w> </span>ESTABLISHED<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-72 name=__codelineno-2-72 href=#__codelineno-2-72></a>
<a id=__codelineno-2-73 name=__codelineno-2-73 href=#__codelineno-2-73></a><span class=c1># forward udp traffic inbound/outbound (I know it is dull to copy this way.)</span>
<a id=__codelineno-2-74 name=__codelineno-2-74 href=#__codelineno-2-74></a>-A<span class=w> </span>FORWARD<span class=w> </span>-i<span class=w> </span>eth0<span class=w>  </span>-p<span class=w> </span>udp<span class=w> </span>-s<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-o<span class=w> </span>veth0<span class=w> </span>-d<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>--dport<span class=w> </span><span class=m>13400</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-75 name=__codelineno-2-75 href=#__codelineno-2-75></a>-A<span class=w> </span>FORWARD<span class=w> </span>-i<span class=w> </span>veth0<span class=w> </span>-p<span class=w> </span>udp<span class=w> </span>-s<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>--sport<span class=w> </span><span class=m>13400</span><span class=w> </span>-o<span class=w> </span>eth0<span class=w>  </span>-d<span class=w> </span><span class=m>169</span>.254.0.0/16<span class=w> </span>-m<span class=w> </span>conntrack<span class=w> </span>--ctstate<span class=w> </span>ESTABLISHED<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-76 name=__codelineno-2-76 href=#__codelineno-2-76></a>
<a id=__codelineno-2-77 name=__codelineno-2-77 href=#__codelineno-2-77></a><span class=c1># forward TCP traffic between GTW for UDS.</span>
<a id=__codelineno-2-78 name=__codelineno-2-78 href=#__codelineno-2-78></a>-A<span class=w> </span>FORWARD<span class=w> </span>-i<span class=w> </span>veth20<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.93.82<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-o<span class=w> </span>eth0<span class=w> </span>-d<span class=w> </span>gw<span class=w> </span>--dport<span class=w> </span><span class=m>10001</span><span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-79 name=__codelineno-2-79 href=#__codelineno-2-79></a>-A<span class=w> </span>FORWARD<span class=w> </span>-i<span class=w> </span>eth0<span class=w> </span>-s<span class=w> </span>gw<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--sport<span class=w> </span><span class=m>10001</span><span class=w> </span>-o<span class=w> </span>veth20<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.93.82<span class=w> </span>-m<span class=w> </span>conntrack<span class=w> </span>--ctstate<span class=w> </span>ESTABLISHED<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-80 name=__codelineno-2-80 href=#__codelineno-2-80></a>
<a id=__codelineno-2-81 name=__codelineno-2-81 href=#__codelineno-2-81></a><span class=c1># == Start INTERNET chain ==</span>
<a id=__codelineno-2-82 name=__codelineno-2-82 href=#__codelineno-2-82></a>
<a id=__codelineno-2-83 name=__codelineno-2-83 href=#__codelineno-2-83></a>:INTERNET<span class=w> </span>-<span class=w> </span><span class=o>[</span><span class=m>0</span>:0<span class=o>]</span>
<a id=__codelineno-2-84 name=__codelineno-2-84 href=#__codelineno-2-84></a>
<a id=__codelineno-2-85 name=__codelineno-2-85 href=#__codelineno-2-85></a><span class=c1># If we&#39;re in the factory, allow debug access.</span>
<a id=__codelineno-2-86 name=__codelineno-2-86 href=#__codelineno-2-86></a><span class=c1># We verify this by checking if we&#39;re unfused, and have production certs.</span>
<a id=__codelineno-2-87 name=__codelineno-2-87 href=#__codelineno-2-87></a><span class=k>$(</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$FACTORY_DEBUG</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>!<span class=w> </span>is-factory-gated<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>!<span class=w> </span>is-development-car<span class=w> </span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-2-88 name=__codelineno-2-88 href=#__codelineno-2-88></a><span class=w>    </span><span class=nb>printf</span><span class=w> </span><span class=s2>&quot;%s\n&quot;</span><span class=w> </span><span class=s2>&quot;</span>
<a id=__codelineno-2-89 name=__codelineno-2-89 href=#__codelineno-2-89></a><span class=s2>    -A INTERNET -p tcp --dport 8080 -d 127.0.0.1/32 -j ACCEPT</span>
<a id=__codelineno-2-90 name=__codelineno-2-90 href=#__codelineno-2-90></a><span class=s2>    -A INTERNET -p tcp --dport 8080 -d 192.168.90.100/32 -j ACCEPT&quot;</span>
<a id=__codelineno-2-91 name=__codelineno-2-91 href=#__codelineno-2-91></a><span class=k>fi</span><span class=w> </span><span class=k>)</span>
<a id=__codelineno-2-92 name=__codelineno-2-92 href=#__codelineno-2-92></a>
<a id=__codelineno-2-93 name=__codelineno-2-93 href=#__codelineno-2-93></a><span class=c1># Block connections to internal address spaces (internal API, VPN &amp; Multicast), allow DNS</span>
<a id=__codelineno-2-94 name=__codelineno-2-94 href=#__codelineno-2-94></a>-A<span class=w> </span>INTERNET<span class=w> </span>-d<span class=w> </span><span class=m>127</span>.0.0.1/32<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>-m<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>53</span><span class=w> </span>-m<span class=w> </span>conntrack<span class=w> </span>--ctstate<span class=w> </span>NEW,ESTABLISHED<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-95 name=__codelineno-2-95 href=#__codelineno-2-95></a>-A<span class=w> </span>INTERNET<span class=w> </span>-d<span class=w> </span><span class=m>127</span>.0.0.1/32<span class=w> </span>-p<span class=w> </span>udp<span class=w> </span>-m<span class=w> </span>udp<span class=w> </span>--dport<span class=w> </span><span class=m>53</span><span class=w> </span>-m<span class=w> </span>conntrack<span class=w> </span>--ctstate<span class=w> </span>NEW,ESTABLISHED<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-96 name=__codelineno-2-96 href=#__codelineno-2-96></a>-A<span class=w> </span>INTERNET<span class=w> </span>-d<span class=w> </span><span class=m>127</span>.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,224.0.0.0/4,255.0.0.0/8<span class=w> </span>-m<span class=w> </span>limit<span class=w> </span>--limit<span class=w> </span><span class=m>1</span>/min<span class=w> </span>-j<span class=w> </span>NFLOG<span class=w> </span>--nflog-prefix<span class=w> </span>iptables-sandbox<span class=o>=</span>INTERNET<span class=w> </span>--nflog-group<span class=w> </span><span class=m>30</span>
<a id=__codelineno-2-97 name=__codelineno-2-97 href=#__codelineno-2-97></a>-A<span class=w> </span>INTERNET<span class=w> </span>-d<span class=w> </span><span class=m>127</span>.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,224.0.0.0/4,255.0.0.0/8<span class=w> </span>-j<span class=w> </span>REJECT<span class=w> </span>--reject-with<span class=w> </span>icmp-port-unreachable
<a id=__codelineno-2-98 name=__codelineno-2-98 href=#__codelineno-2-98></a>-A<span class=w> </span>INTERNET<span class=w> </span>-o<span class=w> </span>lo<span class=w> </span>-j<span class=w> </span>REJECT<span class=w> </span>--reject-with<span class=w> </span>icmp-port-unreachable
<a id=__codelineno-2-99 name=__codelineno-2-99 href=#__codelineno-2-99></a>-A<span class=w> </span>INTERNET<span class=w> </span>-o<span class=w> </span>eth0<span class=w> </span>-j<span class=w> </span>REJECT<span class=w> </span>--reject-with<span class=w> </span>icmp-port-unreachable
<a id=__codelineno-2-100 name=__codelineno-2-100 href=#__codelineno-2-100></a>
<a id=__codelineno-2-101 name=__codelineno-2-101 href=#__codelineno-2-101></a><span class=c1># == End INTERNET chain ==</span>
<a id=__codelineno-2-102 name=__codelineno-2-102 href=#__codelineno-2-102></a>
<a id=__codelineno-2-103 name=__codelineno-2-103 href=#__codelineno-2-103></a><span class=c1># SW-229515: Do not allow internal subnet traffic to ingress/egress via wlan0</span>
<a id=__codelineno-2-104 name=__codelineno-2-104 href=#__codelineno-2-104></a>-A<span class=w> </span>INPUT<span class=w> </span>-i<span class=w> </span>wlan0<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.0/24<span class=w> </span>-j<span class=w> </span>DROP
<a id=__codelineno-2-105 name=__codelineno-2-105 href=#__codelineno-2-105></a>-A<span class=w> </span>OUTPUT<span class=w> </span>-o<span class=w> </span>wlan0<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.0/24<span class=w> </span>-j<span class=w> </span>DROP
<a id=__codelineno-2-106 name=__codelineno-2-106 href=#__codelineno-2-106></a>
<a id=__codelineno-2-107 name=__codelineno-2-107 href=#__codelineno-2-107></a><span class=c1># SW-500857: Instate sane forwarding defaults to protect the internal network</span>
<a id=__codelineno-2-108 name=__codelineno-2-108 href=#__codelineno-2-108></a>-A<span class=w> </span>FORWARD<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.0/24<span class=w> </span>-j<span class=w> </span>DROP
<a id=__codelineno-2-109 name=__codelineno-2-109 href=#__codelineno-2-109></a>-A<span class=w> </span>FORWARD<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.0/24<span class=w> </span>-j<span class=w> </span>DROP
<a id=__codelineno-2-110 name=__codelineno-2-110 href=#__codelineno-2-110></a>
<a id=__codelineno-2-111 name=__codelineno-2-111 href=#__codelineno-2-111></a><span class=c1># Install package specific firewall rules.</span>
<a id=__codelineno-2-112 name=__codelineno-2-112 href=#__codelineno-2-112></a><span class=k>$(</span><span class=w> </span><span class=k>for</span><span class=w> </span>f<span class=w> </span><span class=k>in</span><span class=w> </span>/etc/firewall.d/*.iptables<span class=w> </span><span class=p>;</span><span class=w> </span><span class=k>do</span>
<a id=__codelineno-2-113 name=__codelineno-2-113 href=#__codelineno-2-113></a><span class=w>    </span>.<span class=w> </span><span class=s2>&quot;</span><span class=nv>$f</span><span class=s2>&quot;</span><span class=w> </span><span class=m>2</span>&gt;/dev/null
<a id=__codelineno-2-114 name=__codelineno-2-114 href=#__codelineno-2-114></a><span class=k>done</span><span class=w> </span><span class=k>)</span>
<a id=__codelineno-2-115 name=__codelineno-2-115 href=#__codelineno-2-115></a>
<a id=__codelineno-2-116 name=__codelineno-2-116 href=#__codelineno-2-116></a><span class=c1># SW-74649: The kernel short-circuits packets to addresses configured on</span>
<a id=__codelineno-2-117 name=__codelineno-2-117 href=#__codelineno-2-117></a><span class=c1># local interfaces through the loopback interface. E.g. if a globally-</span>
<a id=__codelineno-2-118 name=__codelineno-2-118 href=#__codelineno-2-118></a><span class=c1># routable address is configured on ppp0, then packets to that address will</span>
<a id=__codelineno-2-119 name=__codelineno-2-119 href=#__codelineno-2-119></a><span class=c1># be sent through the loopback interface. So packets to loopback must be to &amp;</span>
<a id=__codelineno-2-120 name=__codelineno-2-120 href=#__codelineno-2-120></a><span class=c1># from the addresses we configured, or sandboxed users/processes will be able</span>
<a id=__codelineno-2-121 name=__codelineno-2-121 href=#__codelineno-2-121></a><span class=c1># to access our internal APIs using a globally-routable address configured on</span>
<a id=__codelineno-2-122 name=__codelineno-2-122 href=#__codelineno-2-122></a><span class=c1># a cellular interface.</span>
<a id=__codelineno-2-123 name=__codelineno-2-123 href=#__codelineno-2-123></a>-A<span class=w> </span>INPUT<span class=w> </span>-i<span class=w> </span>lo<span class=w> </span>-s<span class=w> </span><span class=m>127</span>.0.0.0/8<span class=w> </span>-d<span class=w> </span><span class=m>127</span>.0.0.0/8<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-124 name=__codelineno-2-124 href=#__codelineno-2-124></a>-A<span class=w> </span>INPUT<span class=w> </span>-i<span class=w> </span>lo<span class=w> </span>-s<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-125 name=__codelineno-2-125 href=#__codelineno-2-125></a>-A<span class=w> </span>INPUT<span class=w> </span>-i<span class=w> </span>lo<span class=w> </span>-j<span class=w> </span>DROP
<a id=__codelineno-2-126 name=__codelineno-2-126 href=#__codelineno-2-126></a>
<a id=__codelineno-2-127 name=__codelineno-2-127 href=#__codelineno-2-127></a><span class=c1># If a connection is already established then accept it.</span>
<a id=__codelineno-2-128 name=__codelineno-2-128 href=#__codelineno-2-128></a><span class=c1># Note that this rule should be located before other drop rules</span>
<a id=__codelineno-2-129 name=__codelineno-2-129 href=#__codelineno-2-129></a>-A<span class=w> </span>INPUT<span class=w> </span>-m<span class=w> </span>conntrack<span class=w> </span>--ctstate<span class=w> </span>ESTABLISHED<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-130 name=__codelineno-2-130 href=#__codelineno-2-130></a>-A<span class=w> </span>INPUT<span class=w> </span>-p<span class=w> </span>icmp<span class=w> </span>-m<span class=w> </span>conntrack<span class=w> </span>--ctstate<span class=w> </span>RELATED<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-2-131 name=__codelineno-2-131 href=#__codelineno-2-131></a>
<a id=__codelineno-2-132 name=__codelineno-2-132 href=#__codelineno-2-132></a><span class=c1># ==</span>
<a id=__codelineno-2-133 name=__codelineno-2-133 href=#__codelineno-2-133></a>...<span class=o>(</span>truncated<span class=o>)</span>
</code></pre></div> <h1 id=mcu2-network-security-enhanced-analysis>MCU2 Network Security - Enhanced Analysis</h1> <h2 id=service-binary-port-mapping>Service ‚Üí Binary ‚Üí Port Mapping</h2> <table> <thead> <tr> <th>Service</th> <th>Binary</th> <th>User</th> <th>Ports</th> <th>Bind Addr</th> <th>Sandboxed</th> <th>NetNS</th> </tr> </thead> <tbody> <tr> <td>2048</td> <td><code>N/A</code></td> <td>game2048</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>2048-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>a2dpbridge</td> <td><code>alsaloop</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>alertd</td> <td><code>alertd</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>alsaloop-chromium</td> <td><code>alsaloop</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>alsaloop-usb-mic</td> <td><code>alsaloop</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>ape-deliver</td> <td><code>ape-deliver</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>apviz</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>apviz-assetgen</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>apviz-controls</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>audio_watchdog</td> <td><code>audio_watchdog</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>audiod</td> <td><code>audiod</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>audiorecord</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>autopilot-api</td> <td><code>autopilot-api</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>backgammon</td> <td><code>N/A</code></td> <td>backgammon</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>backgammon-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>backup-camera</td> <td><code>videod</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>backup-camera-setup</td> <td><code>backup-camera-setup</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>backup-settings-db</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>boot-alerts</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>bsa_server</td> <td><code>bsa_server</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>btd</td> <td><code>btd</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>bwlogger</td> <td><code>bwlogger</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>cadmium</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>cadmium-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>calico</td> <td><code>gamescope-calico</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>calico-compositor</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>camp-mode</td> <td><code>tvideo</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>camp-mode-holiday</td> <td><code>tvideo</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>carbonado</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>carbonado-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>cerulean</td> <td><code>gamescope-cerulean</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>cerulean-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>cgdo</td> <td><code>cgdo</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>cgroup-event-monitor</td> <td><code>cgroup-event-monitor</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>cgroup-monitor</td> <td><code>cg-monitor</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chess</td> <td><code>N/A</code></td> <td>chess</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chess-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>chromium</td> <td><code>tesla-chromium</code></td> <td>chromium</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-adapter</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-app</td> <td><code>tesla-chromium</code></td> <td>chromium-app</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-app-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>chromium-card</td> <td><code>tesla-chromium</code></td> <td>chromium</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-card-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>chromium-card-webapp-adapter</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-card-webapp-http</td> <td><code>simple-http-server</code></td> <td>root</td> <td>-</td> <td>127.0.0.1</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-fullscreen</td> <td><code>tesla-chromium</code></td> <td>chromium-fullscreen</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-fullscreen-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>chromium-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>chromium-odin</td> <td><code>tesla-chromium</code></td> <td>chromium-odin</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-odin-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>chromium-webapp-adapter</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>chromium-webapp-http</td> <td><code>simple-http-server</code></td> <td>root</td> <td>-</td> <td>127.0.0.1</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>cobalt</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>cobalt-compositor</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>cobalt-input</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>connman</td> <td><code>connmand</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>crashloghelper</td> <td><code>crashloghelper</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>crashlognotify</td> <td><code>crashlognotify</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>crit-backup-monitor</td> <td><code>crit-backup-monitor</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>dashcam</td> <td><code>dashcamd</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>dashcam-back</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dashcam-front</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dashcam-left-rep</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dashcam-right-rep</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dashcam-track-front</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dashcam-viewer</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>dashcam-wide</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus</td> <td><code>dbus-daemon</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-chromium</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-chromium-app</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-chromium-card</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-chromium-fullscreen</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-chromium-fullscreen-rear</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-chromium-odin</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-mediaserver</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-owners-manual</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-release-notes</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dbus-session-tesla</td> <td><code>run-session-bus</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dlt-daemon</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dlt-log</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dmesg-alert</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dnsmasq</td> <td><code>dnsmasq</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>dnsproxy</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>dog-mode</td> <td><code>tvideo</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>doip-autoip</td> <td><code>doip-autoip</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>‚úì</td> </tr> <tr> <td>doip-gateway</td> <td><code>doip-gateway</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>drmlog</td> <td><code>drmlog</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>drmlognotify</td> <td><code>drmlognotify</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>emmc-monitor</td> <td><code>emmc-monitor</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>escalator</td> <td><code>escalator</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>fireplace</td> <td><code>tvideo</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>firewall</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>fs-monitor</td> <td><code>fs-monitor</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>fstrim</td> <td><code>N/A</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>fusehelper</td> <td><code>fusehelper</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>gadget-updater</td> <td><code>gadget-updater</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>gamepad-to-virtual</td> <td><code>gamepad-to-virtual</code></td> <td>root</td> <td>-</td> <td>-</td> <td>‚úì</td> <td>-</td> </tr> <tr> <td>gem-watcher</td> <td><code>gem-watcher</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr> <td>getty</td> <td><code>getty</code></td> <td>root</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> </tbody> </table> <h2 id=port-accessibility-matrix>Port Accessibility Matrix</h2> <table> <thead> <tr> <th>Port</th> <th>Service</th> <th>Accessible From</th> <th>Risk Level</th> </tr> </thead> <tbody> <tr> <td>123</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>319</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>320</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>4030</td> <td>toolbox-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>4035</td> <td>toolbox-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>4050</td> <td>toolbox-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>4060</td> <td>toolbox-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>4090</td> <td>toolbox-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>4094</td> <td>toolbox-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>5353</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>5354</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>5424</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>7654</td> <td>toolbox-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>8081</td> <td>service-shell</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>8443</td> <td>autopilot-api</td> <td>APE (192.168.90.103/105), Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>8444</td> <td>autopilot-api</td> <td>APE (192.168.90.103/105), Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>8610</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>8611</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>8885</td> <td>autopilot-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>8888</td> <td>autopilot-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>8900</td> <td>autopilot-api</td> <td>APE (192.168.90.103/105), Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>8906</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9892</td> <td>?</td> <td>APE (192.168.90.103/105), APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9893</td> <td>?</td> <td>APE (192.168.90.103/105), APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9894</td> <td>?</td> <td>APE (192.168.90.103/105), APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9895</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9896</td> <td>?</td> <td>APE (192.168.90.103/105), APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9897</td> <td>?</td> <td>APE (192.168.90.103/105), APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9898</td> <td>?</td> <td>APE (192.168.90.103/105), APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9899</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9900</td> <td>?</td> <td>APE (192.168.90.103/105), APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9901</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9902</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>9903</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>19004</td> <td>autopilot-api</td> <td>Localhost only</td> <td>üü¢ LOW</td> </tr> <tr> <td>20564</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>20565</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>20566</td> <td>?</td> <td>APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> <tr> <td>63277</td> <td>?</td> <td>APE (192.168.90.103/105), APE (192.168.90.103/105)</td> <td>‚ö™ UNKNOWN</td> </tr> </tbody> </table> <h2 id=authentication-analysis>Authentication Analysis</h2> <h3 id=service-shell>service-shell</h3> <ul> <li><strong>Port:</strong> 8081</li> <li><strong>Auth Type:</strong> TLS certificate</li> <li><strong>CA Certificate:</strong> <code>$CA</code></li> <li><strong>Requires Car Certificate:</strong> ‚úì</li> <li><strong>OID Restrictions:</strong> $TESLA_CERTIFICATES_EKU_PRODUCT_ACCESS_CLIENT_AUTH_PROD", $TESLA_CERTIFICATES_EKU_PRODUCT_ACCESS_CLIENT_AUTH_ENG";</li> </ul> <h2 id=firewall-chain-analysis>Firewall Chain Analysis</h2> <h3 id=ape_input_1>APE_INPUT</h3> <p><strong>Total Rules:</strong> 17</p> <p><em>(Too many rules to display - 17 total)</em></p> <h3 id=internet_1>INTERNET</h3> <p><strong>Total Rules:</strong> 8</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>-A INTERNET -p tcp --dport 8080 -d 127.0.0.1/32 -j ACCEPT
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>-A INTERNET -p tcp --dport 8080 -d 192.168.90.100/32 -j ACCEPT&quot;
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>-A INTERNET -d 127.0.0.1/32 -p tcp -m tcp --dport 53 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>-A INTERNET -d 127.0.0.1/32 -p udp -m udp --dport 53 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>-A INTERNET -d 127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,224.0.0.0/4,255.0.0.0/8 -m limit --limit 1/min -j NFLOG --nflog-prefix iptables-sandbox=INTERNET --nflog-group 30
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>-A INTERNET -d 127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,224.0.0.0/4,255.0.0.0/8 -j REJECT --reject-with icmp-port-unreachable
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>-A INTERNET -o lo -j REJECT --reject-with icmp-port-unreachable
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>-A INTERNET -o eth0 -j REJECT --reject-with icmp-port-unreachable
</code></pre></div> <hr> <h2 id=deep-dive-critical-services>Deep Dive: Critical Services</h2> <h3 id=port-8081-service-shell>Port 8081 - service-shell</h3> <p><strong>Binary:</strong> <code>/usr/bin/service-shell</code> (12.2 MB, hardlinked 11 times)</p> <p><strong>Authentication Mechanism:</strong> - TLS mutual authentication required - Client must present certificate signed by Tesla Product Access CA - Certificate must contain specific OID (Extended Key Usage) - Production: Tesla Product Access Client Auth (Prod) - Engineering: Tesla Product Access Client Auth (Eng) - Domain-based authorization (prd vs eng) - Device ID restrictions via <code>authorized-principals</code> - Session monitoring enabled - Principal-based access control</p> <p><strong>Access Control:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>REJECT from:
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>  - 192.168.90.30, 192.168.90.60 (specific blocked IPs)
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>  - 192.168.90.101-107 (other MCU instances/clusters)
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>ACCEPT from:
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>  - Any device on 192.168.90.0/24 (except above)
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>  - localhost (127.0.0.1)
</code></pre></div></p> <p><strong>Variants:</strong> Multiple hardlinked variants with different AppArmor profiles: - <code>service-shell-autodiag</code> - Auto diagnostic mode - <code>service-shell-backend</code> - Backend services access - <code>service-shell-engineering</code> - Engineering/factory mode - <code>service-shell-external</code> - External (customer?) access - <code>service-shell-macgyver</code> - Emergency/recovery mode? - <code>service-shell-mothership</code> - Tesla backend connection - <code>service-shell-service</code> - Service mode - <code>service-shell-tesla</code> - Tesla internal access - <code>service-shell-service-ui</code> - UI service access</p> <p><strong>Attack Surface:</strong> - ‚ùå Direct credential theft unlikely (certificate + OID checking) - ‚ö†Ô∏è Potentially vulnerable if car certificate compromised - ‚ö†Ô∏è Self-signed certificate fallback if provisioning fails - ‚ö†Ô∏è <code>is-development-car</code> || <code>!is-factory-gated</code> enables engineering domain - ‚úÖ AppArmor profiles restrict file access per variant</p> <p><strong>Critical Code Path:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># From /etc/sv/service-shell/run</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=nb>exec</span><span class=w> </span>/usr/bin/service-shell<span class=w> </span><span class=se>\</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>  </span>--address<span class=w> </span><span class=m>0</span>.0.0.0<span class=w> </span><span class=se>\ </span><span class=w>         </span><span class=c1># ‚ö†Ô∏è LISTENS ON ALL INTERFACES</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>  </span>--port<span class=w> </span><span class=m>8081</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>  </span>--ca<span class=w> </span><span class=s2>&quot;</span><span class=nv>$TESLA_CERTIFICATES_COMBINED_PRODUCTS</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>  </span>--cert<span class=w> </span>/var/lib/car_creds/car.crt<span class=w> </span><span class=se>\</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>  </span>--key<span class=w> </span>/var/lib/car_creds/car.key<span class=w> </span><span class=se>\</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>  </span>--principal-public-key<span class=w> </span>/etc/service-shell/principal-<span class=o>{</span>prd<span class=p>|</span>eng<span class=o>}</span>.pub<span class=w> </span><span class=se>\</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>  </span>--domain<span class=w> </span><span class=o>{</span>prd<span class=p>|</span>eng<span class=o>}</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>  </span>--monitor-sessions<span class=w> </span><span class=se>\</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>  </span><span class=o>{</span>--fused<span class=o>}</span><span class=w> </span><span class=o>{</span>--factory-gated<span class=o>}</span><span class=w> </span><span class=o>{</span>--delivered<span class=o>}</span>
</code></pre></div></p> <hr> <h3 id=port-4030-4094-7654-toolbox-api>Port 4030-4094, 7654 - toolbox-api</h3> <p><strong>Binary:</strong> <code>/usr/bin/toolbox-api</code> (6.2 MB)</p> <p><strong>Sandboxing:</strong> - Runs via RunSandbox (minijail + cgroups) - Kafel seccomp policy: <code>/etc/kafel/toolbox-api.kafel</code> - AppArmor profile enforced - Dedicated user: <code>toolbox-api</code></p> <p><strong>Access Control:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>APE-accessible (192.168.90.103/105):
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>  - Port 4030 ONLY
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>REJECT from:
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>  - 192.168.90.30, 192.168.90.60
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>  - 192.168.90.100 (self)
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>  - 192.168.90.101, 192.168.90.102, 192.168.90.104
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>ACCEPT from:
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>  - Everything else on 192.168.90.0/24
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>Localhost access:
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>  - Ports 4030, 4050, 4060, 4090, 4094, 7654
</code></pre></div></p> <p><strong>Firewall Logging:</strong> - Rejected packets logged to NFLOG group 30 - Prefix: <code>iptables-sandbox=TOOLBOX-API</code> - Rate limit: 1/min</p> <p><strong>Attack Surface:</strong> - üü° Port 4030 exposed to APE computers - üü° API likely allows diagnostic commands - ‚úÖ Strong sandboxing (minijail + seccomp + AppArmor) - ‚ùì Need to reverse-engineer binary for API endpoints</p> <hr> <h3 id=ports-8443-8444-8885-8888-8900-19004-autopilot-api>Ports 8443, 8444, 8885, 8888, 8900, 19004 - autopilot-api</h3> <p><strong>Binary:</strong> <code>/usr/bin/autopilot-api</code></p> <p><strong>Purpose:</strong> Communication bridge between MCU and Autopilot computers</p> <p><strong>Access Control:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>INPUT (listening):
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>  - Sources: 192.168.90.103, 192.168.90.105 ONLY
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>  - All other sources: REJECT
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>OUTPUT (connections):
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>  - Can connect TO APE on ports above (ESTABLISHED state)
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>  - Localhost access: 4030, 4400, 8080, 8002
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>  - Factory mode: Can connect to 10.0.0.0/8:443 over wlan0
</code></pre></div></p> <p><strong>Sandboxing:</strong> - Runs via RunSandbox - User: <code>autopilot-api</code> - cgroup net_cls classification (for QoS/firewall)</p> <p><strong>Attack Surface:</strong> - ‚úÖ Strong restriction: only APE IPs can connect - ‚ö†Ô∏è If APE compromised, can reach this API - ‚úÖ Sandboxed execution limits blast radius - üî¥ Factory mode opens 10.0.0.0/8:443 - could be used for data exfil</p> <hr> <h3 id=port-20564-updater-hermes-delivery-ape-deliver>Port 20564 - updater (hermes-delivery / ape-deliver)</h3> <p><strong>Purpose:</strong> Firmware update delivery from APE to MCU</p> <p><strong>Access Control:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>APE_INPUT chain:
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>  - Source: 192.168.90.103/105
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>  - Destination: 192.168.90.100
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>  - Port: 20564
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>  - Protocol: TCP
</code></pre></div></p> <p><strong>Security Implications:</strong> - üî¥ <strong>CRITICAL</strong>: Firmware update path - ‚ùì Authentication/signing verification unknown (need binary analysis) - ‚ö†Ô∏è APE compromise = ability to push updates to MCU - Must verify: digital signature checking, rollback protection</p> <hr> <h3 id=port-53-dns-resolution>Port 53 - DNS Resolution</h3> <p><strong>Handled by:</strong> - dnsmasq (for internal resolution) - Forwarded to external DNS over cellular/WiFi</p> <p><strong>Access Control:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>INTERNET chain:
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>  - Allows connections to 127.0.0.1:53 (TCP/UDP)
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>  - Sandboxed processes can use DNS
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>connmand:
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>  - Allows outbound UDP port 53, 67 (DHCP)
</code></pre></div></p> <p><strong>Attack Surface:</strong> - ‚úÖ DNS to localhost only (no external DNS for sandboxed apps) - ‚ö†Ô∏è dnsmasq vulnerabilities could affect all services - Cache poisoning risk if dnsmasq not updated</p> <hr> <h2 id=network-namespace-isolation>Network Namespace Isolation</h2> <h3 id=doip-gateway-namespace-1921689382>doip-gateway Namespace (192.168.93.82)</h3> <p><strong>Purpose:</strong> Isolate Diagnostics over IP (DoIP) / UDS traffic</p> <p><strong>Network Setup:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>Main namespace (192.168.90.100):
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>  - eth0: APE network
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>doip-gateway namespace (192.168.93.82):
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>  - veth0: Virtual ethernet to main namespace
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>  - Isolated from direct APE access
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>  - NAT rules redirect GTW traffic
</code></pre></div></p> <p><strong>NAT Rules:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>PREROUTING:
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>  -A PREROUTING -i eth0 -s gw -p tcp --sport 10001 \
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>    -d 192.168.90.100 -j DNAT --to-destination 192.168.93.82
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>POSTROUTING:
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>  -A POSTROUTING -s 192.168.93.82 -p tcp -o eth0 \
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>    -d gw --dport 10001 -j SNAT --to-source 192.168.90.100
</code></pre></div></p> <p><strong>DoIP Port 13400:</strong> - Link-local addressing (169.254.0.0/16) - Forwards TCP/UDP to veth0 namespace - Used for automotive diagnostics (UDS)</p> <p><strong>Attack Surface:</strong> - ‚úÖ Strong isolation via network namespace - üü° Link-local access means physical proximity required - ‚ö†Ô∏è If GTW (192.168.90.102) compromised, can reach doip-gateway - UDS commands could trigger vehicle functions</p> <hr> <h2 id=multicast-groups-data-leakage-risk>Multicast Groups - Data Leakage Risk</h2> <h3 id=22400154-ui-server-messages>224.0.0.154 - UI Server Messages</h3> <p><strong>Senders:</strong> - qtcar (main UI application) - APE (Autopilot UI updates)</p> <p><strong>Receivers:</strong> - Any service on 192.168.90.0/24 that joins the group - Dashcam viewer - Service UIs</p> <p><strong>Port:</strong> 5424 (UDP)</p> <p><strong>Data Transmitted:</strong> - UI state updates - DV (Data Visualization?) traffic to 127.255.255.255</p> <p><strong>Security Risk:</strong> - üü° Any compromised service can eavesdrop on UI messages - Potential information disclosure (speed, GPS, driver actions)</p> <h3 id=22400155-dashcam-streams>224.0.0.155 - Dashcam Streams</h3> <p><strong>Senders:</strong> - backup-camera, dashcam services</p> <p><strong>Receivers:</strong> - APE computers (192.168.90.103/105) - dashcam-viewer service</p> <p><strong>Ports:</strong> 9892-9903 (UDP)</p> <p><strong>Data Transmitted:</strong> - Video streams from cameras - Sentry mode recordings</p> <p><strong>Security Risk:</strong> - üî¥ <strong>HIGH</strong>: Raw camera feeds on multicast - Any device on 192.168.90.x can join and intercept video - No apparent encryption (need packet capture to verify)</p> <hr> <h2 id=internet-chain-sandbox-bypass-analysis>INTERNET Chain - Sandbox Bypass Analysis</h2> <p><strong>Purpose:</strong> Prevent sandboxed internet-facing services from accessing internal APIs</p> <p><strong>Implementation:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>:INTERNET - [0:0]
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a># Block internal networks
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>-A INTERNET -d 127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,224.0.0.0/4,255.0.0.0/8 \
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>  -m limit --limit 1/min \
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>  -j NFLOG --nflog-prefix iptables-sandbox=INTERNET --nflog-group 30
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>-A INTERNET -d &lt;internal ranges&gt; -j REJECT --reject-with icmp-port-unreachable
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a># Block loopback and APE network
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>-A INTERNET -o lo -j REJECT --reject-with icmp-port-unreachable
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>-A INTERNET -o eth0 -j REJECT --reject-with icmp-port-unreachable
</code></pre></div></p> <p><strong>Bypass Opportunities:</strong></p> <ol> <li><strong>Factory Mode Backdoor:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$FACTORY_DEBUG</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>!<span class=w> </span>is-factory-gated<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>!<span class=w> </span>is-development-car<span class=w> </span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>    </span>-A<span class=w> </span>INTERNET<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>8080</span><span class=w> </span>-d<span class=w> </span><span class=m>127</span>.0.0.1/32<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w>    </span>-A<span class=w> </span>INTERNET<span class=w> </span>-p<span class=w> </span>tcp<span class=w> </span>--dport<span class=w> </span><span class=m>8080</span><span class=w> </span>-d<span class=w> </span><span class=m>192</span>.168.90.100/32<span class=w> </span>-j<span class=w> </span>ACCEPT
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=k>fi</span>
</code></pre></div></li> <li>If <code>FACTORY_DEBUG=1</code> AND car is unfused AND has production certs</li> <li>Port 8080 on localhost/MCU IP becomes accessible</li> <li> <p>Internet-connected services can reach internal APIs</p> </li> <li> <p><strong>DNS Exception:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>-A INTERNET -d 127.0.0.1/32 -p tcp -m tcp --dport 53 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>-A INTERNET -d 127.0.0.1/32 -p udp -m udp --dport 53 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
</code></pre></div></p> </li> <li>DNS to localhost allowed</li> <li>dnsmasq running on 127.0.0.1:53</li> <li> <p>DNS rebinding attack potential?</p> </li> <li> <p><strong>Cellular Interfaces:</strong></p> </li> <li>INTERNET chain blocks <code>eth0</code> (APE network) and <code>lo</code> (localhost)</li> <li>Does NOT explicitly block other interfaces</li> <li><code>eth0.2</code> (cellular) and <code>wlan0</code> (WiFi) allowed implicitly</li> <li>NAT rules forward 192.168.10.0/24 to these interfaces</li> </ol> <hr> <h2 id=runsandbox-mechanism>RunSandbox Mechanism</h2> <p><strong>Script:</strong> <code>/etc/sandbox/sandbox.bash</code></p> <p><strong>Execution Flow:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>1. Load profile: /etc/sandbox.d/json/{service}.json
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>2. Load environment: /etc/sandbox.d/vars/{service}.vars
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>3. Setup cgroups:
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>   - CPU limits (cpuset)
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>   - Memory limits (memory cgroup)
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>   - Network classification (net_cls cgroup)
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>   - Freezer (for pause/resume)
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>4. Setup network namespace (if needed):
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>   - Create veth pair (veth0 ‚Üî vpeer0)
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>   - Assign IP addresses (192.168.93.x subnet)
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>   - Setup NAT rules
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>   - Add iptables chain for namespace
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>5. Setup minijail:
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a>   - chroot (if specified)
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>   - seccomp policy (via Kafel)
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a>   - AppArmor profile
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>   - Additional bind mounts (eng mode)
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>6. Execute: cgexec &lt;cgroup opts&gt; minijail &lt;jail opts&gt; -- /path/to/binary
</code></pre></div></p> <p><strong>cgroup Network Classification:</strong> - Each service assigned unique cgroup ID (NET_CLS_CGROUP_ID) - iptables can match via <code>-m cgroup --cgroup &lt;id&gt;</code> - Used for service-specific firewall rules</p> <p><strong>Example from qtcar.iptables:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=nv>CGROUP_QTCAR</span><span class=o>=</span>0x10001
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>-A<span class=w> </span>OUTPUT<span class=w> </span>-m<span class=w> </span>cgroup<span class=w> </span>--cgroup<span class=w> </span><span class=nv>$CGROUP_QTCAR</span><span class=w> </span>-j<span class=w> </span>QTCAR
</code></pre></div></p> <p><strong>Attack Surface:</strong> - ‚úÖ Defense-in-depth: cgroups + seccomp + AppArmor + network namespace - ‚ö†Ô∏è Configuration errors in JSON profiles could weaken isolation - ‚ö†Ô∏è Eng/dev mode adds additional bind mounts (<code>sandbox-abm.bash</code>) - ‚ùì Seccomp policies need audit (Kafel files in <code>/etc/kafel/</code>)</p> <hr> <h2 id=subnet-routing-nat-analysis>Subnet Routing &amp; NAT Analysis</h2> <h3 id=nat-rules-from-sbinfirewall>NAT Rules (from /sbin/firewall)</h3> <p><strong>Masquerading for Internal Subnet:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>*nat
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>-A POSTROUTING -o eth0.2 -s 192.168.10.0/24 -j MASQUERADE
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>-A POSTROUTING -o wlan0  -s 192.168.10.0/24 -j MASQUERADE
</code></pre></div> - 192.168.10.0/24 is NAT subnet for... what? - Need to find which services use this subnet - Likely for guest WiFi hotspot or similar</p> <p><strong>DoIP/UDS NAT:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a># Redirect UDS traffic between doip-gateway and GTW
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>-A PREROUTING -i eth0 -s gw -p tcp --sport 10001 -d 192.168.90.100 \
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>  -j DNAT --to-destination 192.168.93.82
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>-A POSTROUTING -s 192.168.93.82 -p tcp -o eth0 -d gw --dport 10001 \
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>  -j SNAT --to-source 192.168.90.100
</code></pre></div></p> <h3 id=interface-overview>Interface Overview</h3> <table> <thead> <tr> <th>Interface</th> <th>IP Address</th> <th>Purpose</th> <th>Exposed Services</th> </tr> </thead> <tbody> <tr> <td><code>lo</code></td> <td>127.0.0.1</td> <td>Localhost</td> <td>Most services (IPC)</td> </tr> <tr> <td><code>eth0</code></td> <td>192.168.90.100</td> <td>APE Network</td> <td>autopilot-api, updater, service-shell, toolbox-api</td> </tr> <tr> <td><code>eth0.2</code></td> <td>DHCP/Cellular</td> <td>Cellular Internet</td> <td>Internet-facing services (via NAT)</td> </tr> <tr> <td><code>wlan0</code></td> <td>DHCP/WiFi</td> <td>WiFi</td> <td>Internet-facing services (via NAT)</td> </tr> <tr> <td><code>veth0</code></td> <td>192.168.93.x</td> <td>Namespaces</td> <td>doip-gateway, other isolated services</td> </tr> </tbody> </table> <p><strong>Forwarding Rules:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>*filter
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>:FORWARD DROP [0:0]
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a># Only specific forwards allowed:
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a># 1. DoIP link-local traffic
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>-A FORWARD -i veth0 -p icmp -s 169.254.0.0/16 -o eth0 -d 169.254.0.0/16 -j ACCEPT
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>-A FORWARD -i eth0  -p icmp -s 169.254.0.0/16 -o veth0 -d 169.254.0.0/16 -j ACCEPT
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a># 2. DoIP TCP/UDP port 13400
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a>-A FORWARD -i eth0  -p tcp -s 169.254.0.0/16 -o veth0 -d 169.254.0.0/16 --dport 13400 -j ACCEPT
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a># 3. GTW UDS traffic
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a>-A FORWARD -i veth20 -s 192.168.93.82 -p tcp -o eth0 -d gw --dport 10001 -j ACCEPT
</code></pre></div></p> <p><strong>Security Posture:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>‚úÖ Default DROP policy on FORWARD chain
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>‚úÖ Explicit ACCEPT rules only
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>‚ö†Ô∏è  SW-500857: Additional DROP rules for 192.168.90.0/24 (belt-and-suspenders)
</code></pre></div></p> <hr> <h2 id=complete-port-reference>Complete Port Reference</h2> <h3 id=ports-4000-4999-internal-apis>Ports 4000-4999 (Internal APIs)</h3> <table> <thead> <tr> <th>Port</th> <th>Service</th> <th>Protocol</th> <th>Purpose</th> <th>Access</th> </tr> </thead> <tbody> <tr> <td>4029</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4030</td> <td>toolbox-api</td> <td>TCP</td> <td>Diagnostics/Toolbox API</td> <td>APE + Localhost</td> </tr> <tr> <td>4031-4034</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4035</td> <td>toolbox-api</td> <td>TCP</td> <td>Toolbox API endpoint</td> <td>Localhost</td> </tr> <tr> <td>4040</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4050</td> <td>toolbox-api</td> <td>TCP</td> <td>Toolbox API endpoint</td> <td>Localhost</td> </tr> <tr> <td>4051</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4060</td> <td>toolbox-api</td> <td>TCP</td> <td>Toolbox API endpoint</td> <td>Localhost</td> </tr> <tr> <td>4061</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4070</td> <td>qtcar</td> <td>TCP</td> <td>qtcar server</td> <td>Localhost</td> </tr> <tr> <td>4071-4073</td> <td>qtcar</td> <td>UDP</td> <td>DV traffic (multicast 127.255.255.255)</td> <td>Localhost</td> </tr> <tr> <td>4080</td> <td>qtcar</td> <td>TCP</td> <td>qtcar server</td> <td>Localhost</td> </tr> <tr> <td>4082</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4083</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4090</td> <td>toolbox-api</td> <td>TCP</td> <td>Toolbox API endpoint</td> <td>Localhost</td> </tr> <tr> <td>4091</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4093</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4094</td> <td>toolbox-api</td> <td>TCP</td> <td>Toolbox API endpoint</td> <td>Localhost</td> </tr> <tr> <td>4095-4097</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4110</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4111</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4130</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4131</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4146</td> <td>?</td> <td>UDP</td> <td>DV traffic</td> <td>Localhost</td> </tr> <tr> <td>4148</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4160</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4161</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4163</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4165</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4171</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4181</td> <td>?</td> <td>UDP</td> <td>DV traffic</td> <td>Localhost</td> </tr> <tr> <td>4201</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4210</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4211</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4220</td> <td>qtcar</td> <td>TCP</td> <td>qtcar server</td> <td>Localhost</td> </tr> <tr> <td>4241</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4251</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4280</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4281</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4400</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4401</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4500</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4501</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4504</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4505</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4506</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4508</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4509</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4512</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4513</td> <td>?</td> <td>UDP</td> <td>DV traffic</td> <td>Localhost</td> </tr> <tr> <td>4520</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4522</td> <td>?</td> <td>UDP</td> <td>DV traffic</td> <td>Localhost</td> </tr> <tr> <td>4524</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4525</td> <td>?</td> <td>UDP</td> <td>DV traffic</td> <td>Localhost</td> </tr> <tr> <td>4531</td> <td>?</td> <td>UDP</td> <td>DV traffic</td> <td>Localhost</td> </tr> <tr> <td>4541</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4567</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4570</td> <td>qtcar</td> <td>TCP/UDP</td> <td>qtcar server + DV</td> <td>Localhost</td> </tr> <tr> <td>4599</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>4600</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>4601</td> <td>?</td> <td>UDP</td> <td>DV traffic</td> <td>Localhost</td> </tr> <tr> <td>4998-4999</td> <td>?</td> <td>UDP</td> <td>DV traffic</td> <td>Localhost</td> </tr> </tbody> </table> <p><strong>Pattern Analysis:</strong> - Most 4xxx ports are localhost-only - Many used by <code>qtcar</code> (main UI application) - "DV traffic" likely = Data Visualization (multicast to 127.255.255.255) - Need to analyze qtcar binary to map ports to specific functions</p> <h3 id=ports-8000-9999-external-services>Ports 8000-9999 (External Services)</h3> <table> <thead> <tr> <th>Port</th> <th>Service</th> <th>Protocol</th> <th>Purpose</th> <th>Access</th> </tr> </thead> <tbody> <tr> <td>8000</td> <td>?</td> <td>TCP</td> <td>HTTP?</td> <td>?</td> </tr> <tr> <td>8002</td> <td>autopilot-api</td> <td>TCP</td> <td>Autopilot API endpoint</td> <td>Localhost</td> </tr> <tr> <td>8080</td> <td>Various</td> <td>TCP</td> <td>HTTP, debug proxy</td> <td>Localhost (FACTORY: All)</td> </tr> <tr> <td>8081</td> <td>service-shell</td> <td>TCP</td> <td>Tesla remote access shell</td> <td>192.168.90.0/24</td> </tr> <tr> <td>8082</td> <td>?</td> <td>TCP</td> <td>APE service</td> <td>APE network</td> </tr> <tr> <td>8088</td> <td>?</td> <td>TCP</td> <td>APE service</td> <td>APE network</td> </tr> <tr> <td>8443</td> <td>autopilot-api</td> <td>TCP</td> <td>HTTPS Autopilot API</td> <td>APE only</td> </tr> <tr> <td>8444</td> <td>autopilot-api</td> <td>TCP</td> <td>HTTPS Autopilot API</td> <td>APE only</td> </tr> <tr> <td>8610</td> <td>?</td> <td>UDP</td> <td>Augmented vision data</td> <td>APE ‚Üí MCU</td> </tr> <tr> <td>8611</td> <td>?</td> <td>UDP</td> <td>Augmented vision data (APEB?)</td> <td>APEB ‚Üí MCU</td> </tr> <tr> <td>8885</td> <td>autopilot-api</td> <td>TCP</td> <td>Autopilot API</td> <td>APE only</td> </tr> <tr> <td>8888</td> <td>autopilot-api</td> <td>TCP</td> <td>Autopilot API</td> <td>APE only</td> </tr> <tr> <td>8900</td> <td>autopilot-api</td> <td>TCP</td> <td>Autopilot API</td> <td>APE only</td> </tr> <tr> <td>8901</td> <td>hermes-logs</td> <td>TCP</td> <td>Log streaming</td> <td>Owner UID only</td> </tr> <tr> <td>8906</td> <td>?</td> <td>UDP</td> <td>MCU stats (APE request)</td> <td>APE ‚Üí MCU</td> </tr> <tr> <td>8950</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>9000-9002</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>9004</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>9006</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>9080</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>9892-9903</td> <td>dashcam/backup-camera</td> <td>UDP</td> <td>Camera video streams</td> <td>APE (multicast 224.0.0.155)</td> </tr> </tbody> </table> <h3 id=other-critical-ports>Other Critical Ports</h3> <table> <thead> <tr> <th>Port</th> <th>Service</th> <th>Protocol</th> <th>Purpose</th> <th>Access</th> </tr> </thead> <tbody> <tr> <td>53</td> <td>dnsmasq</td> <td>TCP/UDP</td> <td>DNS resolution</td> <td>Localhost</td> </tr> <tr> <td>67</td> <td>dhcp</td> <td>UDP</td> <td>DHCP client</td> <td>Outbound</td> </tr> <tr> <td>80</td> <td>connmand, various</td> <td>TCP</td> <td>HTTP, connectivity check</td> <td>Internet</td> </tr> <tr> <td>123</td> <td>ntpd</td> <td>UDP</td> <td>NTP time sync</td> <td>Internet + APE</td> </tr> <tr> <td>443</td> <td>Various</td> <td>TCP</td> <td>HTTPS</td> <td>Internet</td> </tr> <tr> <td>1234-1235</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>192.168.90.100</td> </tr> <tr> <td>1666-1667</td> <td>?</td> <td>TCP</td> <td>Unknown (Perforce??)</td> <td>?</td> </tr> <tr> <td>3500</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>5353-5354</td> <td>?</td> <td>UDP</td> <td>mDNS? Sentry signaling</td> <td>APE ‚Üí MCU</td> </tr> <tr> <td>5424</td> <td>?</td> <td>UDP</td> <td>UI Server multicast</td> <td>Multicast 224.0.0.154</td> </tr> <tr> <td>5555</td> <td>?</td> <td>TCP</td> <td>ADB? (Android Debug Bridge??)</td> <td>?</td> </tr> <tr> <td>5801</td> <td>?</td> <td>TCP</td> <td>VNC?</td> <td>?</td> </tr> <tr> <td>7654</td> <td>toolbox-api</td> <td>TCP</td> <td>Toolbox API</td> <td>Localhost</td> </tr> <tr> <td>10001</td> <td>GTW</td> <td>TCP</td> <td>UDS Gateway (DoIP)</td> <td>GTW ‚Üî doip-ns</td> </tr> <tr> <td>13400</td> <td>doip-gateway</td> <td>TCP/UDP</td> <td>DoIP (Diagnostics over IP)</td> <td>Link-local 169.254.0.0/16</td> </tr> <tr> <td>18466</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>19004</td> <td>autopilot-api</td> <td>TCP</td> <td>Autopilot API</td> <td>APE only</td> </tr> <tr> <td>20100</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>20101</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>192.168.90.100</td> </tr> <tr> <td>20564</td> <td>updater</td> <td>TCP</td> <td>Firmware updates</td> <td>APE ‚Üí MCU</td> </tr> <tr> <td>20565-20566</td> <td>deploy tool (dev)</td> <td>TCP</td> <td>SSQ deployment (dev-release only)</td> <td>APE ‚Üí MCU</td> </tr> <tr> <td>23001</td> <td>qtcar</td> <td>TCP</td> <td>qtcar server</td> <td>Localhost</td> </tr> <tr> <td>25956</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>28496</td> <td>?</td> <td>TCP</td> <td>qtcar access</td> <td>Localhost</td> </tr> <tr> <td>30490</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>30508-30513</td> <td>?</td> <td>TCP</td> <td>Unknown (Android?)</td> <td>?</td> </tr> <tr> <td>30520</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>30530</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>31415-31416</td> <td>?</td> <td>TCP</td> <td>Unknown (Pi ports?)</td> <td>?</td> </tr> <tr> <td>38888</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>49503</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>Localhost</td> </tr> <tr> <td>49505</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>49507</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>49508</td> <td>chromium-webapp-http</td> <td>TCP</td> <td>Chromium web app backend</td> <td>Localhost (127.0.0.1)</td> </tr> <tr> <td>49509</td> <td>hermes-proxy</td> <td>TCP</td> <td>Hermes proxy for webapp</td> <td>Localhost</td> </tr> <tr> <td>50666</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>50877</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>50950</td> <td>updater</td> <td>TCP</td> <td>Update service</td> <td>UID updater only</td> </tr> <tr> <td>50960</td> <td>?</td> <td>TCP</td> <td>Unknown</td> <td>?</td> </tr> <tr> <td>63277</td> <td>gps/aurix</td> <td>UDP</td> <td>GPS data</td> <td>AURIX/APE ‚Üí MCU</td> </tr> </tbody> </table> <hr> <h2 id=attack-scenarios>Attack Scenarios</h2> <h3 id=scenario-1-compromised-ape-computer>Scenario 1: Compromised APE Computer</h3> <p><strong>Attacker Position:</strong> Code execution on 192.168.90.103 (APE)</p> <p><strong>Available Attack Surface:</strong> 1. <strong>autopilot-api (ports 8443, 8444, 8885, 8888, 8900, 19004)</strong> - Full access to Autopilot API on MCU - Can send commands, receive data - RunSandbox limits damage, but API functions unknown</p> <ol> <li><strong>toolbox-api (port 4030)</strong></li> <li>Diagnostic API access</li> <li>Likely allows status queries, maybe command injection</li> <li> <p>Sandboxed, but could gather intel</p> </li> <li> <p><strong>service-shell (port 8081)</strong></p> </li> <li>‚ùå Blocked: 192.168.90.103 is ACCEPTED in firewall</li> <li>But requires TLS certificate with correct OID</li> <li> <p>If APE has access to MCU car.crt/car.key ‚Üí full shell access</p> </li> <li> <p><strong>updater (port 20564)</strong></p> </li> <li>Can push firmware updates to MCU</li> <li><strong>Critical:</strong> If signature verification is weak, full MCU compromise</li> <li> <p>Need to reverse engineer update protocol</p> </li> <li> <p><strong>Multicast Groups</strong></p> </li> <li>Join 224.0.0.154 ‚Üí eavesdrop on UI messages</li> <li> <p>Join 224.0.0.155 ‚Üí intercept dashcam video</p> </li> <li> <p><strong>NTP (port 123)</strong></p> </li> <li>Can respond to NTP queries</li> <li>Time manipulation attacks (certificate expiry, log tampering)</li> </ol> <p><strong>Lateral Movement:</strong> - From APE ‚Üí MCU (limited by firewall) - From APE ‚Üí GTW (via UDS/DoIP if vulnerable) - From APE ‚Üí AURIX (GPS spoofing on port 63277?)</p> <hr> <h3 id=scenario-2-factory-mode-exploit>Scenario 2: Factory Mode Exploit</h3> <p><strong>Trigger Conditions:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=nv>FACTORY_DEBUG</span><span class=o>=</span><span class=m>1</span><span class=w>                </span><span class=c1># Model 3/Y by default</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>!<span class=w> </span>is-factory-gated<span class=w>             </span><span class=c1># Car NOT factory-gated</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>!<span class=w> </span>is-development-car<span class=w>           </span><span class=c1># Car has PRODUCTION certs</span>
</code></pre></div></p> <p><strong>Result:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>-A INTERNET -p tcp --dport 8080 -d 127.0.0.1/32 -j ACCEPT
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>-A INTERNET -p tcp --dport 8080 -d 192.168.90.100/32 -j ACCEPT
</code></pre></div></p> <p><strong>Impact:</strong> - Internet-connected services can reach port 8080 - Port 8080 likely runs debug HTTP server or proxy - Could access internal APIs via 127.0.0.1:8080 - Bypasses INTERNET chain restrictions</p> <p><strong>Attack Chain:</strong> 1. Compromise internet-facing service (e.g., Chromium, connmand) 2. Connect to 127.0.0.1:8080 3. Use debug proxy to reach internal APIs 4. Escalate to full MCU control</p> <hr> <h3 id=scenario-3-multicast-video-interception>Scenario 3: Multicast Video Interception</h3> <p><strong>Setup:</strong> - Attacker gains code execution on ANY service on 192.168.90.x - Could be via APE compromise, or MCU service vuln</p> <p><strong>Attack:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=kn>import</span><span class=w> </span><span class=nn>socket</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=kn>import</span><span class=w> </span><span class=nn>struct</span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=c1># Join dashcam multicast group</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=n>MCAST_GRP</span> <span class=o>=</span> <span class=s1>&#39;224.0.0.155&#39;</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=n>MCAST_PORT</span> <span class=o>=</span> <span class=mi>9892</span>  <span class=c1># Or 9893-9903 for other cameras</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=n>sock</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_DGRAM</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>IPPROTO_UDP</span><span class=p>)</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=n>sock</span><span class=o>.</span><span class=n>setsockopt</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>SOL_SOCKET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SO_REUSEADDR</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=n>sock</span><span class=o>.</span><span class=n>bind</span><span class=p>((</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>MCAST_PORT</span><span class=p>))</span>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=c1># Join multicast group</span>
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=n>mreq</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&quot;4sl&quot;</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>inet_aton</span><span class=p>(</span><span class=n>MCAST_GRP</span><span class=p>),</span> <span class=n>socket</span><span class=o>.</span><span class=n>INADDR_ANY</span><span class=p>)</span>
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class=n>sock</span><span class=o>.</span><span class=n>setsockopt</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>IPPROTO_IP</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>IP_ADD_MEMBERSHIP</span><span class=p>,</span> <span class=n>mreq</span><span class=p>)</span>
<a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a>
<a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a><span class=c1># Receive camera frames</span>
<a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
<a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a>    <span class=n>data</span><span class=p>,</span> <span class=n>addr</span> <span class=o>=</span> <span class=n>sock</span><span class=o>.</span><span class=n>recvfrom</span><span class=p>(</span><span class=mi>65535</span><span class=p>)</span>
<a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a>    <span class=c1># Process video frame</span>
</code></pre></div></p> <p><strong>Impact:</strong> - Real-time camera feed interception - Sentry mode recording capture - Backup camera view</p> <p><strong>Mitigation Status:</strong> - ‚ùå No encryption observed (need packet capture to confirm) - ‚ùå No authentication to join multicast group - ‚ö†Ô∏è Requires network access to 192.168.90.0/24</p> <hr> <h2 id=recommendations_1>Recommendations</h2> <h3 id=immediate-priorities>Immediate Priorities</h3> <ol> <li><strong>Audit Update Mechanism (port 20564)</strong></li> <li>Reverse engineer <code>/usr/bin/ape-deliver</code> and update binaries</li> <li>Verify cryptographic signature checking</li> <li>Test for signature bypass vulnerabilities</li> <li> <p>Check for rollback protection</p> </li> <li> <p><strong>Analyze service-shell Authentication</strong></p> </li> <li>Extract certificate validation logic</li> <li>Test OID checking robustness</li> <li>Check self-signed cert fallback conditions</li> <li> <p>Attempt principal bypass</p> </li> <li> <p><strong>Map qtcar Port Functions</strong></p> </li> <li>Reverse engineer <code>/usr/bin/qtcar</code></li> <li>Document API endpoints on 4xxx ports</li> <li>Identify unauthenticated endpoints</li> <li> <p>Test for command injection</p> </li> <li> <p><strong>Factory Mode Audit</strong></p> </li> <li>Determine exact conditions for <code>FACTORY_DEBUG</code> activation</li> <li>Identify what runs on port 8080 in factory mode</li> <li>Test INTERNET chain bypass via 8080</li> </ol> <h3 id=long-term-security-improvements>Long-Term Security Improvements</h3> <ol> <li><strong>Encrypt Multicast Traffic</strong></li> <li>Add encryption to dashcam streams (224.0.0.155)</li> <li> <p>Add encryption/authentication to UI messages (224.0.0.154)</p> </li> <li> <p><strong>Reduce APE Attack Surface</strong></p> </li> <li>Minimize ports exposed to 192.168.90.103/105</li> <li>Add authentication to toolbox-api port 4030</li> <li> <p>Consider TLS for autopilot-api connections</p> </li> <li> <p><strong>Strengthen INTERNET Chain</strong></p> </li> <li>Remove factory mode 8080 exception</li> <li>Add explicit allow-list for internet-facing services</li> <li> <p>Log all INTERNET chain violations</p> </li> <li> <p><strong>Network Namespace All Services</strong></p> </li> <li>Move more services into isolated network namespaces</li> <li> <p>Limit localhost communication to necessary APIs only</p> </li> <li> <p><strong>Audit Seccomp Policies</strong></p> </li> <li>Review all Kafel files in <code>/etc/kafel/</code></li> <li>Ensure syscall restrictions are tight</li> <li>Test for seccomp bypass</li> </ol> <hr> <h2 id=files-requiring-further-analysis>Files Requiring Further Analysis</h2> <h3 id=binaries-reverse-engineering>Binaries (Reverse Engineering)</h3> <ul> <li><code>/usr/bin/service-shell</code> (12 MB) - Remote shell, certificate auth</li> <li><code>/usr/bin/toolbox-api</code> (6 MB) - Diagnostic API</li> <li><code>/usr/bin/autopilot-api</code> - APE‚ÜîMCU bridge</li> <li><code>/usr/bin/ape-deliver</code> - Update delivery</li> <li><code>/usr/bin/qtcar</code> - Main UI, many ports</li> <li><code>/usr/bin/chromium-*</code> - Browser variants</li> <li><code>/sbin/doip-gateway</code> - DoIP/UDS handler</li> </ul> <h3 id=configuration-files>Configuration Files</h3> <ul> <li><code>/etc/service-shell/principals.d/</code> - Authorized principals</li> <li><code>/etc/service-shell/principal-{prd,eng}.pub</code> - Public keys</li> <li><code>/etc/sandbox.d/json/*.json</code> - Sandbox profiles</li> <li><code>/etc/kafel/*.kafel</code> - Seccomp policies</li> <li><code>/etc/apparmor.d/</code> - AppArmor profiles</li> <li><code>/sbin/authorized-principals</code> - Device ID auth</li> </ul> <h3 id=scripts>Scripts</h3> <ul> <li><code>/sbin/is-factory-gated</code> - Factory mode check</li> <li><code>/sbin/is-development-car</code> - Dev car check</li> <li><code>/sbin/is-delivered</code> - Delivery status</li> <li><code>/sbin/is-fused</code> - Fuse status (security)</li> <li><code>/etc/tesla-certificates.vars</code> - Certificate paths</li> </ul> <hr> <h2 id=summary>Summary</h2> <p><strong>Total Network Services:</strong> 219 runit services analyzed</p> <p><strong>Exposed Ports:</strong> 139 unique ports identified</p> <p><strong>Critical Findings:</strong> 1. üî¥ <strong>Service-shell (8081)</strong> accessible from entire 192.168.90.0/24 subnet 2. üî¥ <strong>Firmware update port (20564)</strong> requires signature verification audit 3. üî¥ <strong>Multicast camera streams</strong> appear unencrypted, joinable by any network device 4. üü° <strong>Factory mode</strong> opens port 8080, bypassing INTERNET chain 5. üü° <strong>toolbox-api port 4030</strong> exposed to APE computers 6. ‚úÖ <strong>Strong sandboxing</strong> via RunSandbox (cgroups + minijail + seccomp + AppArmor) 7. ‚úÖ <strong>INTERNET chain</strong> effectively blocks RFC1918 for internet services 8. ‚úÖ <strong>DoIP isolated</strong> in network namespace</p> <p><strong>Overall Security Posture:</strong> - Defense-in-depth approach with multiple isolation layers - Strong firewall rules for most services - Critical dependencies on certificate security and update signature verification - APE compromise is highest-impact attack vector</p> <p><strong>Next Steps:</strong> 1. Binary analysis of critical services 2. Packet capture of multicast traffic 3. Certificate validation testing 4. Factory mode activation research</p> <hr> <p><em>Analysis complete. Document generated: 2025-02-03 04:51 UTC</em> <em>Source: Tesla MCU2 firmware extraction from /root/downloads/mcu2-extracted/</em></p> <hr> <h2 id=network-topology-diagram>Network Topology Diagram</h2> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>‚ïë                     TESLA MCU2 NETWORK ARCHITECTURE                          ‚ïë
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>                                  INTERNET
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>                                     ‚ñ≤
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>                                     ‚îÇ
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>                    ‚îÇ                ‚îÇ                ‚îÇ
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>                    ‚îÇ                ‚îÇ                ‚îÇ
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>              ‚îÇ  Cellular ‚îÇ    ‚îÇ  WiFi   ‚îÇ     ‚îÇ Ethernet‚îÇ
<a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>              ‚îÇ  (LTE/5G) ‚îÇ    ‚îÇ (wlan0) ‚îÇ     ‚îÇ (tether)‚îÇ
<a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a>              ‚îÇ  (eth0.2) ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
<a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a>              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ               ‚îÇ
<a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a>                    ‚îÇ               ‚îÇ               ‚îÇ
<a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a>                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
<a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a>                            ‚îÇ NAT (MASQUERADE)
<a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a>                            ‚îÇ 192.168.10.0/24
<a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a>        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
<a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a>        ‚îÇ                MCU (192.168.90.100)                       ‚îÇ
<a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a>        ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
<a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a>        ‚îÇ  ‚îÇ              MAIN NAMESPACE                         ‚îÇ  ‚îÇ
<a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a>        ‚îÇ  ‚îÇ                                                     ‚îÇ  ‚îÇ
<a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a>        ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ
<a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a>        ‚îÇ  ‚îÇ  ‚îÇ  Localhost Services (127.0.0.1)              ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ qtcar (ports 4000-4999)               ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - Main UI application                  ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - 4070, 4080, 4220 (servers)          ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - 4xxx (IPC endpoints)                 ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-33 name=__codelineno-24-33 href=#__codelineno-24-33></a>        ‚îÇ  ‚îÇ  ‚îÇ                                               ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-34 name=__codelineno-24-34 href=#__codelineno-24-34></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-35 name=__codelineno-24-35 href=#__codelineno-24-35></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ toolbox-api (4030,4050,4060,4090,4094) ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-36 name=__codelineno-24-36 href=#__codelineno-24-36></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - Diagnostic API (sandboxed)           ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-37 name=__codelineno-24-37 href=#__codelineno-24-37></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-38 name=__codelineno-24-38 href=#__codelineno-24-38></a>        ‚îÇ  ‚îÇ  ‚îÇ                                               ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-39 name=__codelineno-24-39 href=#__codelineno-24-39></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-40 name=__codelineno-24-40 href=#__codelineno-24-40></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ chromium-webapp-http (49508)           ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-41 name=__codelineno-24-41 href=#__codelineno-24-41></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ autopilot-api (4030,4400,8080,8002)    ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-42 name=__codelineno-24-42 href=#__codelineno-24-42></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ dnsmasq (53)                           ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-43 name=__codelineno-24-43 href=#__codelineno-24-43></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-44 name=__codelineno-24-44 href=#__codelineno-24-44></a>        ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ
<a id=__codelineno-24-45 name=__codelineno-24-45 href=#__codelineno-24-45></a>        ‚îÇ  ‚îÇ                                                     ‚îÇ  ‚îÇ
<a id=__codelineno-24-46 name=__codelineno-24-46 href=#__codelineno-24-46></a>        ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ
<a id=__codelineno-24-47 name=__codelineno-24-47 href=#__codelineno-24-47></a>        ‚îÇ  ‚îÇ  ‚îÇ  APE Network Services (eth0)                 ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-48 name=__codelineno-24-48 href=#__codelineno-24-48></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-49 name=__codelineno-24-49 href=#__codelineno-24-49></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ service-shell (8081)                   ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-50 name=__codelineno-24-50 href=#__codelineno-24-50></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - TLS mutual auth                      ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-51 name=__codelineno-24-51 href=#__codelineno-24-51></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - Cert + OID required                  ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-52 name=__codelineno-24-52 href=#__codelineno-24-52></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - LISTENS on 0.0.0.0 ‚ö†Ô∏è                ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-53 name=__codelineno-24-53 href=#__codelineno-24-53></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-54 name=__codelineno-24-54 href=#__codelineno-24-54></a>        ‚îÇ  ‚îÇ  ‚îÇ                                               ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-55 name=__codelineno-24-55 href=#__codelineno-24-55></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-56 name=__codelineno-24-56 href=#__codelineno-24-56></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ autopilot-api (8443,8444,8885,8888,    ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-57 name=__codelineno-24-57 href=#__codelineno-24-57></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ                8900,19004)              ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-58 name=__codelineno-24-58 href=#__codelineno-24-58></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - APE 103/105 ONLY                     ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-59 name=__codelineno-24-59 href=#__codelineno-24-59></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-60 name=__codelineno-24-60 href=#__codelineno-24-60></a>        ‚îÇ  ‚îÇ  ‚îÇ                                               ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-61 name=__codelineno-24-61 href=#__codelineno-24-61></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-62 name=__codelineno-24-62 href=#__codelineno-24-62></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ updater (20564)                        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-63 name=__codelineno-24-63 href=#__codelineno-24-63></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - Firmware delivery from APE           ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-64 name=__codelineno-24-64 href=#__codelineno-24-64></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ - CRITICAL ‚ö†Ô∏è                           ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-65 name=__codelineno-24-65 href=#__codelineno-24-65></a>        ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-66 name=__codelineno-24-66 href=#__codelineno-24-66></a>        ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ
<a id=__codelineno-24-67 name=__codelineno-24-67 href=#__codelineno-24-67></a>        ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
<a id=__codelineno-24-68 name=__codelineno-24-68 href=#__codelineno-24-68></a>        ‚îÇ                                                           ‚îÇ
<a id=__codelineno-24-69 name=__codelineno-24-69 href=#__codelineno-24-69></a>        ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
<a id=__codelineno-24-70 name=__codelineno-24-70 href=#__codelineno-24-70></a>        ‚îÇ  ‚îÇ         NETWORK NAMESPACES (veth pairs)             ‚îÇ  ‚îÇ
<a id=__codelineno-24-71 name=__codelineno-24-71 href=#__codelineno-24-71></a>        ‚îÇ  ‚îÇ                                                     ‚îÇ  ‚îÇ
<a id=__codelineno-24-72 name=__codelineno-24-72 href=#__codelineno-24-72></a>        ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ
<a id=__codelineno-24-73 name=__codelineno-24-73 href=#__codelineno-24-73></a>        ‚îÇ  ‚îÇ  ‚îÇ doip-gateway (192.168.93.82)                 ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-74 name=__codelineno-24-74 href=#__codelineno-24-74></a>        ‚îÇ  ‚îÇ  ‚îÇ - veth0 ‚Üî vpeer0                             ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-75 name=__codelineno-24-75 href=#__codelineno-24-75></a>        ‚îÇ  ‚îÇ  ‚îÇ - Port 13400 (DoIP/UDS)                      ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-76 name=__codelineno-24-76 href=#__codelineno-24-76></a>        ‚îÇ  ‚îÇ  ‚îÇ - Link-local 169.254.0.0/16                  ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-77 name=__codelineno-24-77 href=#__codelineno-24-77></a>        ‚îÇ  ‚îÇ  ‚îÇ - NAT to/from GTW port 10001                 ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-78 name=__codelineno-24-78 href=#__codelineno-24-78></a>        ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ
<a id=__codelineno-24-79 name=__codelineno-24-79 href=#__codelineno-24-79></a>        ‚îÇ  ‚îÇ                                                     ‚îÇ  ‚îÇ
<a id=__codelineno-24-80 name=__codelineno-24-80 href=#__codelineno-24-80></a>        ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ
<a id=__codelineno-24-81 name=__codelineno-24-81 href=#__codelineno-24-81></a>        ‚îÇ  ‚îÇ  ‚îÇ Other service namespaces (192.168.93.x)      ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-82 name=__codelineno-24-82 href=#__codelineno-24-82></a>        ‚îÇ  ‚îÇ  ‚îÇ - /30 subnets per service                    ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-83 name=__codelineno-24-83 href=#__codelineno-24-83></a>        ‚îÇ  ‚îÇ  ‚îÇ - NAT via iptables MASQUERADE                ‚îÇ  ‚îÇ  ‚îÇ
<a id=__codelineno-24-84 name=__codelineno-24-84 href=#__codelineno-24-84></a>        ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ
<a id=__codelineno-24-85 name=__codelineno-24-85 href=#__codelineno-24-85></a>        ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
<a id=__codelineno-24-86 name=__codelineno-24-86 href=#__codelineno-24-86></a>        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
<a id=__codelineno-24-87 name=__codelineno-24-87 href=#__codelineno-24-87></a>                            ‚îÇ
<a id=__codelineno-24-88 name=__codelineno-24-88 href=#__codelineno-24-88></a>                            ‚îÇ eth0 (192.168.90.100)
<a id=__codelineno-24-89 name=__codelineno-24-89 href=#__codelineno-24-89></a>                            ‚îÇ
<a id=__codelineno-24-90 name=__codelineno-24-90 href=#__codelineno-24-90></a>        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
<a id=__codelineno-24-91 name=__codelineno-24-91 href=#__codelineno-24-91></a>        ‚îÇ              192.168.90.0/24 Network                      ‚îÇ
<a id=__codelineno-24-92 name=__codelineno-24-92 href=#__codelineno-24-92></a>        ‚îÇ               (APE / Autopilot Network)                   ‚îÇ
<a id=__codelineno-24-93 name=__codelineno-24-93 href=#__codelineno-24-93></a>        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
<a id=__codelineno-24-94 name=__codelineno-24-94 href=#__codelineno-24-94></a>                            ‚îÇ
<a id=__codelineno-24-95 name=__codelineno-24-95 href=#__codelineno-24-95></a>           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
<a id=__codelineno-24-96 name=__codelineno-24-96 href=#__codelineno-24-96></a>           ‚îÇ                ‚îÇ                ‚îÇ                 ‚îÇ
<a id=__codelineno-24-97 name=__codelineno-24-97 href=#__codelineno-24-97></a>      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
<a id=__codelineno-24-98 name=__codelineno-24-98 href=#__codelineno-24-98></a>      ‚îÇ   APE   ‚îÇ      ‚îÇ  APEB   ‚îÇ     ‚îÇ AURIX   ‚îÇ      ‚îÇ    GTW    ‚îÇ
<a id=__codelineno-24-99 name=__codelineno-24-99 href=#__codelineno-24-99></a>      ‚îÇ (AP A)  ‚îÇ      ‚îÇ (AP B)  ‚îÇ     ‚îÇ(Gateway)‚îÇ      ‚îÇ (Gateway) ‚îÇ
<a id=__codelineno-24-100 name=__codelineno-24-100 href=#__codelineno-24-100></a>      ‚îÇ  .103   ‚îÇ      ‚îÇ  .105   ‚îÇ     ‚îÇ  .104   ‚îÇ      ‚îÇ   .102    ‚îÇ
<a id=__codelineno-24-101 name=__codelineno-24-101 href=#__codelineno-24-101></a>      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
<a id=__codelineno-24-102 name=__codelineno-24-102 href=#__codelineno-24-102></a>           ‚îÇ                ‚îÇ                ‚îÇ                 ‚îÇ
<a id=__codelineno-24-103 name=__codelineno-24-103 href=#__codelineno-24-103></a>           ‚îÇ                ‚îÇ                ‚îÇ                 ‚îÇ
<a id=__codelineno-24-104 name=__codelineno-24-104 href=#__codelineno-24-104></a>      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê
<a id=__codelineno-24-105 name=__codelineno-24-105 href=#__codelineno-24-105></a>      ‚îÇ                                                              ‚îÇ
<a id=__codelineno-24-106 name=__codelineno-24-106 href=#__codelineno-24-106></a>      ‚îÇ   Sends to MCU:                                             ‚îÇ
<a id=__codelineno-24-107 name=__codelineno-24-107 href=#__codelineno-24-107></a>      ‚îÇ   - Autopilot API calls (8443,8444,8885,8888,8900,19004)   ‚îÇ
<a id=__codelineno-24-108 name=__codelineno-24-108 href=#__codelineno-24-108></a>      ‚îÇ   - Firmware updates (20564)                                ‚îÇ
<a id=__codelineno-24-109 name=__codelineno-24-109 href=#__codelineno-24-109></a>      ‚îÇ   - Camera streams to 224.0.0.155 (multicast)               ‚îÇ
<a id=__codelineno-24-110 name=__codelineno-24-110 href=#__codelineno-24-110></a>      ‚îÇ   - Augmented vision data (8610,8611 UDP)                   ‚îÇ
<a id=__codelineno-24-111 name=__codelineno-24-111 href=#__codelineno-24-111></a>      ‚îÇ   - GPS data (63277 UDP) [from AURIX .104]                  ‚îÇ
<a id=__codelineno-24-112 name=__codelineno-24-112 href=#__codelineno-24-112></a>      ‚îÇ   - NTP requests (123)                                      ‚îÇ
<a id=__codelineno-24-113 name=__codelineno-24-113 href=#__codelineno-24-113></a>      ‚îÇ   - UI messages to 224.0.0.154 (multicast)                  ‚îÇ
<a id=__codelineno-24-114 name=__codelineno-24-114 href=#__codelineno-24-114></a>      ‚îÇ                                                              ‚îÇ
<a id=__codelineno-24-115 name=__codelineno-24-115 href=#__codelineno-24-115></a>      ‚îÇ   Receives from MCU:                                        ‚îÇ
<a id=__codelineno-24-116 name=__codelineno-24-116 href=#__codelineno-24-116></a>      ‚îÇ   - Sentry mode video (9892-9903 TCP/UDP)                   ‚îÇ
<a id=__codelineno-24-117 name=__codelineno-24-117 href=#__codelineno-24-117></a>      ‚îÇ   - Dashcam streams (multicast 224.0.0.155)                 ‚îÇ
<a id=__codelineno-24-118 name=__codelineno-24-118 href=#__codelineno-24-118></a>      ‚îÇ   - UI server updates (multicast 224.0.0.154)               ‚îÇ
<a id=__codelineno-24-119 name=__codelineno-24-119 href=#__codelineno-24-119></a>      ‚îÇ                                                              ‚îÇ
<a id=__codelineno-24-120 name=__codelineno-24-120 href=#__codelineno-24-120></a>      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
<a id=__codelineno-24-121 name=__codelineno-24-121 href=#__codelineno-24-121></a>
<a id=__codelineno-24-122 name=__codelineno-24-122 href=#__codelineno-24-122></a>
<a id=__codelineno-24-123 name=__codelineno-24-123 href=#__codelineno-24-123></a>                        ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
<a id=__codelineno-24-124 name=__codelineno-24-124 href=#__codelineno-24-124></a>                        ‚ïë   MULTICAST GROUPS        ‚ïë
<a id=__codelineno-24-125 name=__codelineno-24-125 href=#__codelineno-24-125></a>                        ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
<a id=__codelineno-24-126 name=__codelineno-24-126 href=#__codelineno-24-126></a>
<a id=__codelineno-24-127 name=__codelineno-24-127 href=#__codelineno-24-127></a>      224.0.0.154:5424 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ UI Server Messages
<a id=__codelineno-24-128 name=__codelineno-24-128 href=#__codelineno-24-128></a>          ‚îÇ                      (qtcar, APE, services)
<a id=__codelineno-24-129 name=__codelineno-24-129 href=#__codelineno-24-129></a>          ‚îÇ
<a id=__codelineno-24-130 name=__codelineno-24-130 href=#__codelineno-24-130></a>          ‚îú‚îÄ qtcar sends UI state
<a id=__codelineno-24-131 name=__codelineno-24-131 href=#__codelineno-24-131></a>          ‚îú‚îÄ APE sends UI updates
<a id=__codelineno-24-132 name=__codelineno-24-132 href=#__codelineno-24-132></a>          ‚îî‚îÄ Services subscribe for events
<a id=__codelineno-24-133 name=__codelineno-24-133 href=#__codelineno-24-133></a>
<a id=__codelineno-24-134 name=__codelineno-24-134 href=#__codelineno-24-134></a>      224.0.0.155:9892-9903 ‚îÄ‚îÄ‚îÄ‚ñ∫ Dashcam Video Streams
<a id=__codelineno-24-135 name=__codelineno-24-135 href=#__codelineno-24-135></a>          ‚îÇ                      (cameras ‚Üí APE)
<a id=__codelineno-24-136 name=__codelineno-24-136 href=#__codelineno-24-136></a>          ‚îÇ
<a id=__codelineno-24-137 name=__codelineno-24-137 href=#__codelineno-24-137></a>          ‚îú‚îÄ Port 9892: Camera 1
<a id=__codelineno-24-138 name=__codelineno-24-138 href=#__codelineno-24-138></a>          ‚îú‚îÄ Port 9893: Camera 2
<a id=__codelineno-24-139 name=__codelineno-24-139 href=#__codelineno-24-139></a>          ‚îú‚îÄ Port 9894: Camera 3
<a id=__codelineno-24-140 name=__codelineno-24-140 href=#__codelineno-24-140></a>          ‚îú‚îÄ Port 9895-9903: Additional cameras/views
<a id=__codelineno-24-141 name=__codelineno-24-141 href=#__codelineno-24-141></a>          ‚îÇ
<a id=__codelineno-24-142 name=__codelineno-24-142 href=#__codelineno-24-142></a>          ‚îî‚îÄ ‚ö†Ô∏è  UNENCRYPTED - any device on 192.168.90.x can join
<a id=__codelineno-24-143 name=__codelineno-24-143 href=#__codelineno-24-143></a>
<a id=__codelineno-24-144 name=__codelineno-24-144 href=#__codelineno-24-144></a>      224.0.1.129:319,320 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Precision Time Protocol (PTP)
<a id=__codelineno-24-145 name=__codelineno-24-145 href=#__codelineno-24-145></a>                                 (APE .103 ‚Üí MCU)
<a id=__codelineno-24-146 name=__codelineno-24-146 href=#__codelineno-24-146></a>
<a id=__codelineno-24-147 name=__codelineno-24-147 href=#__codelineno-24-147></a>
<a id=__codelineno-24-148 name=__codelineno-24-148 href=#__codelineno-24-148></a>                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
<a id=__codelineno-24-149 name=__codelineno-24-149 href=#__codelineno-24-149></a>                    ‚ïë   FIREWALL CHAINS             ‚ïë
<a id=__codelineno-24-150 name=__codelineno-24-150 href=#__codelineno-24-150></a>                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
<a id=__codelineno-24-151 name=__codelineno-24-151 href=#__codelineno-24-151></a>
<a id=__codelineno-24-152 name=__codelineno-24-152 href=#__codelineno-24-152></a>      INTERNET ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Sandbox for internet-facing services
<a id=__codelineno-24-153 name=__codelineno-24-153 href=#__codelineno-24-153></a>          ‚îÇ                Block: 10.0.0.0/8, 172.16.0.0/12,
<a id=__codelineno-24-154 name=__codelineno-24-154 href=#__codelineno-24-154></a>          ‚îÇ                       192.168.0.0/16, 224.0.0.0/4
<a id=__codelineno-24-155 name=__codelineno-24-155 href=#__codelineno-24-155></a>          ‚îÇ                Allow: DNS to 127.0.0.1:53
<a id=__codelineno-24-156 name=__codelineno-24-156 href=#__codelineno-24-156></a>          ‚îÇ                ‚ö†Ô∏è  FACTORY: Opens 8080 if unfused + prod certs
<a id=__codelineno-24-157 name=__codelineno-24-157 href=#__codelineno-24-157></a>          ‚îÇ
<a id=__codelineno-24-158 name=__codelineno-24-158 href=#__codelineno-24-158></a>          ‚îî‚îÄ Used by: chromium, connmand, hermes services
<a id=__codelineno-24-159 name=__codelineno-24-159 href=#__codelineno-24-159></a>
<a id=__codelineno-24-160 name=__codelineno-24-160 href=#__codelineno-24-160></a>      APE_INPUT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Controls APE ‚Üí MCU traffic
<a id=__codelineno-24-161 name=__codelineno-24-161 href=#__codelineno-24-161></a>          ‚îÇ                Sources: 192.168.90.103/105 (+ .104 for GPS)
<a id=__codelineno-24-162 name=__codelineno-24-162 href=#__codelineno-24-162></a>          ‚îÇ                Allows: autopilot-api, updater, NTP,
<a id=__codelineno-24-163 name=__codelineno-24-163 href=#__codelineno-24-163></a>          ‚îÇ                        sentry video, dashcam, augmented vision
<a id=__codelineno-24-164 name=__codelineno-24-164 href=#__codelineno-24-164></a>          ‚îÇ                REJECTS: .30, .60 (specific blocks)
<a id=__codelineno-24-165 name=__codelineno-24-165 href=#__codelineno-24-165></a>          ‚îÇ
<a id=__codelineno-24-166 name=__codelineno-24-166 href=#__codelineno-24-166></a>          ‚îî‚îÄ Default: NFLOG + DROP
<a id=__codelineno-24-167 name=__codelineno-24-167 href=#__codelineno-24-167></a>
<a id=__codelineno-24-168 name=__codelineno-24-168 href=#__codelineno-24-168></a>      SERVICE-SHELL-INPUT ‚ñ∫ service-shell access control
<a id=__codelineno-24-169 name=__codelineno-24-169 href=#__codelineno-24-169></a>          ‚îÇ                 REJECT: .30, .60, .101-.107
<a id=__codelineno-24-170 name=__codelineno-24-170 href=#__codelineno-24-170></a>          ‚îÇ                 ACCEPT: Rest of 192.168.90.0/24, localhost
<a id=__codelineno-24-171 name=__codelineno-24-171 href=#__codelineno-24-171></a>          ‚îÇ
<a id=__codelineno-24-172 name=__codelineno-24-172 href=#__codelineno-24-172></a>          ‚îî‚îÄ But still requires TLS cert auth
<a id=__codelineno-24-173 name=__codelineno-24-173 href=#__codelineno-24-173></a>
<a id=__codelineno-24-174 name=__codelineno-24-174 href=#__codelineno-24-174></a>      TOOLBOX-API-INPUT ‚îÄ‚ñ∫ toolbox-api access control
<a id=__codelineno-24-175 name=__codelineno-24-175 href=#__codelineno-24-175></a>          ‚îÇ                APE (.103/.105): Port 4030 ONLY
<a id=__codelineno-24-176 name=__codelineno-24-176 href=#__codelineno-24-176></a>          ‚îÇ                REJECT: .30, .60, .100, .101, .102, .104
<a id=__codelineno-24-177 name=__codelineno-24-177 href=#__codelineno-24-177></a>          ‚îÇ                ACCEPT: Others
<a id=__codelineno-24-178 name=__codelineno-24-178 href=#__codelineno-24-178></a>          ‚îÇ
<a id=__codelineno-24-179 name=__codelineno-24-179 href=#__codelineno-24-179></a>          ‚îî‚îÄ Additional sandboxing via RunSandbox
<a id=__codelineno-24-180 name=__codelineno-24-180 href=#__codelineno-24-180></a>
<a id=__codelineno-24-181 name=__codelineno-24-181 href=#__codelineno-24-181></a>
<a id=__codelineno-24-182 name=__codelineno-24-182 href=#__codelineno-24-182></a>                      ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
<a id=__codelineno-24-183 name=__codelineno-24-183 href=#__codelineno-24-183></a>                      ‚ïë  ATTACK SURFACE SUMMARY   ‚ïë
<a id=__codelineno-24-184 name=__codelineno-24-184 href=#__codelineno-24-184></a>                      ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
<a id=__codelineno-24-185 name=__codelineno-24-185 href=#__codelineno-24-185></a>
<a id=__codelineno-24-186 name=__codelineno-24-186 href=#__codelineno-24-186></a>      üî¥ CRITICAL
<a id=__codelineno-24-187 name=__codelineno-24-187 href=#__codelineno-24-187></a>         ‚îú‚îÄ Port 20564 (updater) - Firmware delivery
<a id=__codelineno-24-188 name=__codelineno-24-188 href=#__codelineno-24-188></a>         ‚îú‚îÄ Port 8081 (service-shell) - Remote access (but cert-protected)
<a id=__codelineno-24-189 name=__codelineno-24-189 href=#__codelineno-24-189></a>         ‚îî‚îÄ Multicast 224.0.0.155 - Unencrypted camera streams
<a id=__codelineno-24-190 name=__codelineno-24-190 href=#__codelineno-24-190></a>
<a id=__codelineno-24-191 name=__codelineno-24-191 href=#__codelineno-24-191></a>      üü° HIGH
<a id=__codelineno-24-192 name=__codelineno-24-192 href=#__codelineno-24-192></a>         ‚îú‚îÄ Port 4030 (toolbox-api) - Diagnostics from APE
<a id=__codelineno-24-193 name=__codelineno-24-193 href=#__codelineno-24-193></a>         ‚îú‚îÄ Ports 8443-8900 (autopilot-api) - APE communication
<a id=__codelineno-24-194 name=__codelineno-24-194 href=#__codelineno-24-194></a>         ‚îú‚îÄ Port 13400 (doip-gateway) - Automotive diagnostics (link-local)
<a id=__codelineno-24-195 name=__codelineno-24-195 href=#__codelineno-24-195></a>         ‚îî‚îÄ Factory mode port 8080 - INTERNET chain bypass
<a id=__codelineno-24-196 name=__codelineno-24-196 href=#__codelineno-24-196></a>
<a id=__codelineno-24-197 name=__codelineno-24-197 href=#__codelineno-24-197></a>      üü¢ MEDIUM
<a id=__codelineno-24-198 name=__codelineno-24-198 href=#__codelineno-24-198></a>         ‚îú‚îÄ Port 123 (NTP) - Time manipulation potential
<a id=__codelineno-24-199 name=__codelineno-24-199 href=#__codelineno-24-199></a>         ‚îú‚îÄ Multicast 224.0.0.154 - UI message eavesdropping
<a id=__codelineno-24-200 name=__codelineno-24-200 href=#__codelineno-24-200></a>         ‚îî‚îÄ Port 63277 (GPS) - GPS data injection from AURIX
<a id=__codelineno-24-201 name=__codelineno-24-201 href=#__codelineno-24-201></a>
<a id=__codelineno-24-202 name=__codelineno-24-202 href=#__codelineno-24-202></a>      ‚ö™ LOW (Localhost only)
<a id=__codelineno-24-203 name=__codelineno-24-203 href=#__codelineno-24-203></a>         ‚îî‚îÄ Ports 4000-4999 (qtcar + internal APIs)
<a id=__codelineno-24-204 name=__codelineno-24-204 href=#__codelineno-24-204></a>
<a id=__codelineno-24-205 name=__codelineno-24-205 href=#__codelineno-24-205></a>
<a id=__codelineno-24-206 name=__codelineno-24-206 href=#__codelineno-24-206></a>                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
<a id=__codelineno-24-207 name=__codelineno-24-207 href=#__codelineno-24-207></a>                    ‚ïë  SECURITY CONTROLS SUMMARY     ‚ïë
<a id=__codelineno-24-208 name=__codelineno-24-208 href=#__codelineno-24-208></a>                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
<a id=__codelineno-24-209 name=__codelineno-24-209 href=#__codelineno-24-209></a>
<a id=__codelineno-24-210 name=__codelineno-24-210 href=#__codelineno-24-210></a>      ‚úÖ STRONG
<a id=__codelineno-24-211 name=__codelineno-24-211 href=#__codelineno-24-211></a>         ‚îú‚îÄ RunSandbox: cgroups + minijail + seccomp + AppArmor
<a id=__codelineno-24-212 name=__codelineno-24-212 href=#__codelineno-24-212></a>         ‚îú‚îÄ Network namespaces for isolation (doip-gateway)
<a id=__codelineno-24-213 name=__codelineno-24-213 href=#__codelineno-24-213></a>         ‚îú‚îÄ INTERNET chain blocks RFC1918 networks
<a id=__codelineno-24-214 name=__codelineno-24-214 href=#__codelineno-24-214></a>         ‚îú‚îÄ Service-specific firewall rules (82 .iptables files)
<a id=__codelineno-24-215 name=__codelineno-24-215 href=#__codelineno-24-215></a>         ‚îú‚îÄ Default DROP on INPUT/FORWARD chains
<a id=__codelineno-24-216 name=__codelineno-24-216 href=#__codelineno-24-216></a>         ‚îî‚îÄ TLS + certificate + OID auth for service-shell
<a id=__codelineno-24-217 name=__codelineno-24-217 href=#__codelineno-24-217></a>
<a id=__codelineno-24-218 name=__codelineno-24-218 href=#__codelineno-24-218></a>      ‚ö†Ô∏è  NEEDS AUDIT
<a id=__codelineno-24-219 name=__codelineno-24-219 href=#__codelineno-24-219></a>         ‚îú‚îÄ Update signature verification (port 20564)
<a id=__codelineno-24-220 name=__codelineno-24-220 href=#__codelineno-24-220></a>         ‚îú‚îÄ toolbox-api authentication (port 4030)
<a id=__codelineno-24-221 name=__codelineno-24-221 href=#__codelineno-24-221></a>         ‚îú‚îÄ autopilot-api API security (multiple ports)
<a id=__codelineno-24-222 name=__codelineno-24-222 href=#__codelineno-24-222></a>         ‚îú‚îÄ Multicast traffic encryption status
<a id=__codelineno-24-223 name=__codelineno-24-223 href=#__codelineno-24-223></a>         ‚îú‚îÄ Factory mode activation conditions
<a id=__codelineno-24-224 name=__codelineno-24-224 href=#__codelineno-24-224></a>         ‚îî‚îÄ Seccomp policies (Kafel files)
<a id=__codelineno-24-225 name=__codelineno-24-225 href=#__codelineno-24-225></a>
<a id=__codelineno-24-226 name=__codelineno-24-226 href=#__codelineno-24-226></a>      ‚ùå WEAKNESSES
<a id=__codelineno-24-227 name=__codelineno-24-227 href=#__codelineno-24-227></a>         ‚îú‚îÄ service-shell listens on 0.0.0.0 (not limited to eth0)
<a id=__codelineno-24-228 name=__codelineno-24-228 href=#__codelineno-24-228></a>         ‚îú‚îÄ No authentication on multicast groups
<a id=__codelineno-24-229 name=__codelineno-24-229 href=#__codelineno-24-229></a>         ‚îú‚îÄ Factory mode 8080 bypass of INTERNET chain
<a id=__codelineno-24-230 name=__codelineno-24-230 href=#__codelineno-24-230></a>         ‚îî‚îÄ Large attack surface from APE (if compromised)
</code></pre></div> <hr> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/talas9/tesla-research target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>