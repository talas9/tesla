<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Comprehensive security analysis of Tesla Model S/X/3/Y MCU2 and Gateway"><meta name=author content="Security Researcher"><link href=https://talas9.github.io/tesla-research/network/49-modem-iris-tillit-analysis/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Tesla Modem (Iris) - Comprehensive Analysis - Tesla MCU2 Security Research</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tesla-modem-iris-comprehensive-analysis class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Tesla MCU2 Security Research" class="md-header__button md-logo" aria-label="Tesla MCU2 Security Research" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tesla MCU2 Security Research </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Tesla Modem (Iris) - Comprehensive Analysis </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=red data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/talas9/tesla-research title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla-research </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../INDEX/ class=md-tabs__link> Complete Index </a> </li> <li class=md-tabs__item> <a href=../../core/00-master-cross-reference/ class=md-tabs__link> Core Research </a> </li> <li class=md-tabs__item> <a href=../../gateway/81-gateway-secure-configs-CRITICAL/ class=md-tabs__link> Gateway Security </a> </li> <li class=md-tabs__item> <a href=../../mcu/24-mcu-architecture.md class=md-tabs__link> MCU Research </a> </li> <li class=md-tabs__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-tabs__link> Evidence & Audit </a> </li> <li class=md-tabs__item> <a href=../../tools/56-tools-gateway-database-query.md class=md-tabs__link> Tools & Scripts </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Tesla MCU2 Security Research" class="md-nav__button md-logo" aria-label="Tesla MCU2 Security Research" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Tesla MCU2 Security Research </label> <div class=md-nav__source> <a href=https://github.com/talas9/tesla-research title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> talas9/tesla-research </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../INDEX/ class=md-nav__link> <span class=md-ellipsis> Complete Index </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Core Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../core/00-master-cross-reference/ class=md-nav__link> <span class=md-ellipsis> Master Cross-Reference </span> </a> </li> <li class=md-nav__item> <a href=../../core/02-gateway-can-flood-exploit/ class=md-nav__link> <span class=md-ellipsis> Gateway CAN Flood Exploit </span> </a> </li> <li class=md-nav__item> <a href=../../core/03-certificate-recovery-orphan-cars/ class=md-nav__link> <span class=md-ellipsis> Certificate Recovery </span> </a> </li> <li class=md-nav__item> <a href=../../core/04-network-ports-firewall/ class=md-nav__link> <span class=md-ellipsis> Network Topology </span> </a> </li> <li class=md-nav__item> <a href=../../core/06-usb-firmware-update/ class=md-nav__link> <span class=md-ellipsis> USB Firmware Update </span> </a> </li> <li class=md-nav__item> <a href=../../core/07-usb-map-installation/ class=md-nav__link> <span class=md-ellipsis> USB Map Installation </span> </a> </li> <li class=md-nav__item> <a href=../../core/08-key-programming-vcsec/ class=md-nav__link> <span class=md-ellipsis> Key Programming </span> </a> </li> <li class=md-nav__item> <a href=../../core/13-ota-handshake-protocol/ class=md-nav__link> <span class=md-ellipsis> OTA Protocol </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Gateway Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Gateway Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gateway/81-gateway-secure-configs-CRITICAL/ class=md-nav__link> <span class=md-ellipsis> ğŸ”’ CRITICAL: Secure Configs </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/80-ryzen-gateway-flash-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> âœ… Complete Flash Dump </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/82-odin-routines-database-UNHASHED/ class=md-nav__link> <span class=md-ellipsis> ğŸ”“ Odin Database </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/92-config-metadata-table-FOUND/ class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Config Metadata Table </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/83-odin-config-api-analysis/ class=md-nav__link> <span class=md-ellipsis> Odin Config API </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/84-gw-diag-command-reference/ class=md-nav__link> <span class=md-ellipsis> gw-diag Commands </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/88-gateway-strings-analysis/ class=md-nav__link> <span class=md-ellipsis> Gateway Strings </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/91-gateway-powerpc-disassembly-summary/ class=md-nav__link> <span class=md-ellipsis> PowerPC Disassembly </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/94-gateway-ALL-FUNCTIONS/ class=md-nav__link> <span class=md-ellipsis> All Functions </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/95-gateway-CAN-MESSAGES-COMPLETE/ class=md-nav__link> <span class=md-ellipsis> CAN Messages Complete </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/96-gateway-DATA-TABLES/ class=md-nav__link> <span class=md-ellipsis> All Data Tables </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/97-gateway-MEMORY-MAP/ class=md-nav__link> <span class=md-ellipsis> Memory Map </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/98-SHA-256-USAGE-ANALYSIS/ class=md-nav__link> <span class=md-ellipsis> SHA-256 Usage </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/99-gateway-FIRMWARE-METADATA/ class=md-nav__link> <span class=md-ellipsis> Firmware Metadata </span> </a> </li> <li class=md-nav__item> <a href=../../gateway/55-gateway-spc-chip-replacement/ class=md-nav__link> <span class=md-ellipsis> SPC Chip Replacement </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> MCU Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> MCU Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mcu/24-mcu-architecture.md class=md-nav__link> <span class=md-ellipsis> MCU Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/25-mcu-boot-sequence.md class=md-nav__link> <span class=md-ellipsis> Boot Sequence </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/28-mcu-qtcarserver.md class=md-nav__link> <span class=md-ellipsis> QtCarServer Security </span> </a> </li> <li class=md-nav__item> <a href=../../mcu/31-mcu-chromium-security.md class=md-nav__link> <span class=md-ellipsis> Chromium Security </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Evidence & Audit </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Evidence & Audit </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../evidence/59-EVIDENCE-AUDIT/ class=md-nav__link> <span class=md-ellipsis> Evidence Audit </span> </a> </li> <li class=md-nav__item> <a href=../../VERIFICATION-STATUS/ class=md-nav__link> <span class=md-ellipsis> Verification Status </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Tools & Scripts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Tools & Scripts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/56-tools-gateway-database-query.md class=md-nav__link> <span class=md-ellipsis> Gateway CRC Validator </span> </a> </li> <li class=md-nav__item> <a href=../../SCRIPTS/ class=md-nav__link> <span class=md-ellipsis> Download Scripts </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=tesla-modem-iris-comprehensive-analysis>Tesla Modem (Iris) - Comprehensive Analysis</h1> <p><strong>Firmware:</strong> 2025.32.3.1.mcu2<br> <strong>Analysis Date:</strong> 2026-02-03<br> <strong>Status:</strong> âœ… COMPLETE </p> <hr> <h2 id=executive-summary>Executive Summary</h2> <p>Tesla's MCU2/CID uses the <strong>Quectel AG525RGL</strong> 5G modem, codenamed <strong>"Iris"</strong> (not Tillit). This is a modern LTE/5G cellular module that provides: - Primary cellular connectivity to Tesla's backend (Hermes) - eCall emergency service capability - Bidirectional data and control channels - Remote diagnostics and logging</p> <p>The modem runs on a separate processor with its own Linux OS, communicating with the MCU over Ethernet (192.168.90.60). Firmware is delivered as signed SquashFS images (.ssq) and updated via Qualcomm's QFirehose protocol over USB.</p> <p><strong>Key Security Findings:</strong> 1. Modem firmware is signed and dm-verity protected 2. Modem exposes multiple network services (HTTP API on port 8901) 3. AT command interface accessible over TCP 4. Modem can SSH to MCU (and MCU can SSH to modem) 5. Separate signing domains (dev vs prod) for secure boot 6. Update mechanism bypasses when in EDL (Emergency Download) mode</p> <hr> <h2 id=1-modem-identification>1. Modem Identification</h2> <h3 id=model-confirmation>Model Confirmation</h3> <ul> <li><strong>Manufacturer:</strong> Quectel</li> <li><strong>Model:</strong> AG525RGL (Iris-GL variant)</li> <li><strong>Codename:</strong> Iris (internal Tesla designation)</li> <li><strong>Type:</strong> 5G NR Sub-6GHz + LTE Cat-20 modem</li> <li><strong>Form Factor:</strong> M.2 module (likely)</li> <li><strong>Alternative Model:</strong> AG521RCN (Iris-CN variant for China)</li> </ul> <p><strong>Evidence:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># /etc/ofono/iris.conf</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nv>Modem</span><span class=o>=</span>AG525RGL
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=nv>ControlAddress</span><span class=o>=</span><span class=m>192</span>.168.90.60
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=nv>ControlPort</span><span class=o>=</span><span class=m>50950</span>
</code></pre></div></p> <p><strong>Modem Detection Logic:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># /usr/sbin/modem-type</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=k>if</span><span class=w> </span>!<span class=w> </span><span class=o>[</span><span class=w> </span>-e<span class=w> </span>/var/lib/ofono/modem<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span>titan<span class=p>;</span><span class=w> </span>exit<span class=p>;</span><span class=w>  </span><span class=c1># Titan = older Telit modem</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=k>fi</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=nv>MODEM</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>cat<span class=w> </span>/var/lib/ofono/modem<span class=k>)</span><span class=s2>&quot;</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=k>if</span><span class=w> </span><span class=o>[[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$MODEM</span><span class=s2>&quot;</span><span class=w> </span><span class=o>=</span><span class=w> </span>iris<span class=w> </span><span class=o>]]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span>iris<span class=p>;</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=k>else</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span>titan<span class=p>;</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=k>fi</span>
</code></pre></div></p> <p>Tesla supports two modem families: 1. <strong>Iris</strong> (Quectel AG525RGL/AG521RCN) - Modern 5G modem 2. <strong>Titan</strong> (Telit) - Legacy LTE modem (being phased out)</p> <hr> <h2 id=2-modem-communication-architecture>2. Modem Communication Architecture</h2> <h3 id=network-topology>Network Topology</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>â”‚ Tesla Vehicle Network (192.168.90.0/24)             â”‚
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>â”‚                                                      â”‚
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>â”‚  â”‚   MCU/CID    â”‚          â”‚  Iris Modem  â”‚        â”‚
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>â”‚  â”‚ 192.168.90.100â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚192.168.90.60â”‚        â”‚
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   eth0    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>â”‚         â”‚                          â”‚                 â”‚
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>â”‚         â”‚                          â”‚                 â”‚
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”          â”‚
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>â”‚    â”‚ Control â”‚              â”‚ LTE Radio â”‚          â”‚
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>â”‚    â”‚Channels:â”‚              â”‚ (Cellular)â”‚          â”‚
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>â”‚    â”‚ TCP 50950â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>â”‚    â”‚ TCP 8901 â”‚                   â”‚                 â”‚
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>â”‚    â”‚ TCP 50960â”‚              â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>â”‚    â”‚ TCP 7891 â”‚              â”‚ SIM/eSIM Card  â”‚     â”‚
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>â”‚                                                      â”‚
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>â”‚  Data Channel: eth0.2 (VLAN 20)                    â”‚
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>â”‚  192.168.20.2/24 â†’ 192.168.20.1 (modem gateway)   â”‚
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>                          â”‚
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>                          â–¼
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>                   Tesla Backend
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>              (hermes-api.*.vn.cloud.tesla.com)
</code></pre></div> <h3 id=communication-interfaces>Communication Interfaces</h3> <h4 id=1-control-plane-tcp-over-ethernet>1. Control Plane (TCP over Ethernet)</h4> <p><strong>IP Configuration:</strong> - <strong>Modem IP:</strong> 192.168.90.60 - <strong>MCU IP:</strong> 192.168.90.100 - <strong>Transport:</strong> Direct Ethernet connection (likely PCIe-to-Ethernet bridge or RGMII)</p> <p><strong>Key Ports:</strong></p> <table> <thead> <tr> <th>Port</th> <th>Direction</th> <th>Protocol</th> <th>Purpose</th> <th>Service</th> </tr> </thead> <tbody> <tr> <td>50950</td> <td>MCUâ†’Modem</td> <td>TCP</td> <td>AT commands</td> <td>AT command interface</td> </tr> <tr> <td>8901</td> <td>MCUâ†’Modem</td> <td>HTTP</td> <td>Modem API</td> <td>Iris management API</td> </tr> <tr> <td>50960</td> <td>Modemâ†’MCU</td> <td>TCP</td> <td>Logging</td> <td>modemvm-logger</td> </tr> <tr> <td>5801</td> <td>Modemâ†’MCU</td> <td>TCP/UDP</td> <td>Logging</td> <td>linuxvm-logger</td> </tr> <tr> <td>49503</td> <td>Modemâ†’MCU</td> <td>HTTP</td> <td>Firmware update</td> <td>modem-update-server</td> </tr> <tr> <td>7891</td> <td>MCUâ†’Modem</td> <td>TCP</td> <td>RIL</td> <td>Radio Interface Layer</td> </tr> <tr> <td>50666</td> <td>MCUâ†’Modem</td> <td>TCP</td> <td>MQTT</td> <td>MQTT telemetry logger</td> </tr> <tr> <td>50877</td> <td>MCUâ†’Modem</td> <td>TCP</td> <td>MQTT</td> <td>MQTT config listener</td> </tr> <tr> <td>50911, 50101</td> <td>MCUâ†’Modem</td> <td>TCP</td> <td>eCall</td> <td>Emergency call server</td> </tr> <tr> <td>38888</td> <td>MCUâ†’Modem</td> <td>TCP</td> <td>TCUD</td> <td>Tesla CU daemon</td> </tr> <tr> <td>22</td> <td>MCUâ†’Modem</td> <td>SSH</td> <td>Shell</td> <td>Remote shell access</td> </tr> <tr> <td>123</td> <td>Modemâ†’MCU</td> <td>UDP</td> <td>NTP</td> <td>Time sync</td> </tr> </tbody> </table> <h4 id=2-data-plane-cellular-internet>2. Data Plane (Cellular Internet)</h4> <p><strong>VLAN Configuration:</strong> - <strong>Interface:</strong> eth0.2 (VLAN ID 20) - <strong>MCU IP:</strong> 192.168.20.2/24 - <strong>Gateway:</strong> 192.168.20.1 (modem routing) - <strong>MTU:</strong> 1430 (reduced for cellular overhead) - <strong>DNS:</strong> 8.8.8.8, 8.8.4.4 - <strong>APN:</strong> tesla01.com.attz (AT&amp;T)</p> <p><strong>VLAN Setup (from /etc/sv/ofono/run):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>ip<span class=w> </span>link<span class=w> </span>delete<span class=w> </span>dev<span class=w> </span>eth0.2
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>ip<span class=w> </span>link<span class=w> </span>add<span class=w> </span>link<span class=w> </span>eth0<span class=w> </span>name<span class=w> </span>eth0.2<span class=w> </span><span class=nb>type</span><span class=w> </span>vlan<span class=w> </span>id<span class=w> </span><span class=m>20</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>ip<span class=w> </span>addr<span class=w> </span>add<span class=w> </span><span class=m>192</span>.168.20.2/24<span class=w> </span>brd<span class=w> </span><span class=m>192</span>.168.20.255<span class=w> </span>dev<span class=w> </span>eth0.2
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>ip<span class=w> </span>link<span class=w> </span><span class=nb>set</span><span class=w> </span>eth0.2<span class=w> </span>mtu<span class=w> </span><span class=m>1430</span>
</code></pre></div></p> <p>This separates: - <strong>Control traffic</strong> (AT commands, diagnostics) â†’ eth0 (192.168.90.x) - <strong>Data traffic</strong> (Hermes WSS, OTA updates) â†’ eth0.2 (192.168.20.x)</p> <h4 id=3-usb-interface-firmware-updates>3. USB Interface (Firmware Updates)</h4> <p><strong>USB Modes:</strong> 1. <strong>Normal Mode:</strong> <code>ID 2c7c:0452</code> (Quectel AG525RGL standard mode) 2. <strong>EDL Mode:</strong> <code>ID 05c6:9008</code> (Qualcomm Emergency Download Mode)</p> <p><strong>Detection Logic:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>if</span><span class=w> </span>lsusb<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-q<span class=w> </span><span class=s2>&quot;ID 2c7c:0452&quot;</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span><span class=nv>USB_MODE</span><span class=o>=</span><span class=s2>&quot;NORMAL&quot;</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=k>elif</span><span class=w> </span>lsusb<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-q<span class=w> </span><span class=s2>&quot;ID 05c6:9008&quot;</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>    </span><span class=nv>USB_MODE</span><span class=o>=</span><span class=s2>&quot;EDL&quot;</span><span class=w>  </span><span class=c1># Firmware update mode</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=k>fi</span>
</code></pre></div></p> <p>USB is <strong>only used for firmware flashing</strong> via QFirehose, not for data/control.</p> <h4 id=4-gpio-control-signals>4. GPIO Control Signals</h4> <p><strong>Modem Power Control:</strong> - <code>BMP-LTE-PWR-LATCH-nEN</code> - Power latch enable - <code>BMP-LTE-PWR-LATCH-nCLK</code> - Power latch clock - <code>BMP-LTE-ONOFF</code> - Modem on/off toggle - <code>1V8-LTE-BMP-DET</code> - 1.8V detection (modem powered) - <code>LTE-MDM-STATUS</code> - Modem ready status - <code>LTE-WAKE</code> - Wake from sleep - <code>SOC-LTE-EFUSE-CON</code> - eFuse control (EDL mode switch) - <code>BMP-USB3-HVEN-1V8</code> - USB host enable</p> <p><strong>Power-On Sequence:</strong> 1. Assert power latch (enable 1V8 rail) 2. Wait 0.2s for voltage stabilization 3. Pulse ONOFF pin: LOW â†’ wait â†’ HIGH (0.5-1.2s) â†’ LOW 4. Wait for <code>1V8-LTE-BMP-DET</code> = 1 5. Wait for <code>LTE-MDM-STATUS</code> = 1 (modem ready)</p> <p><strong>Power-Off Sequence:</strong> 1. Pulse ONOFF pin: LOW â†’ wait 0.5s â†’ HIGH (3s hold) â†’ LOW 2. Wait for <code>1V8-LTE-BMP-DET</code> = 0 3. De-assert power latch</p> <hr> <h2 id=3-modem-control-binaries>3. Modem Control Binaries</h2> <h3 id=overview>Overview</h3> <p>All modem control binaries are <strong>POSIX shell scripts</strong> (not compiled binaries), making them easy to analyze:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>$<span class=w> </span>file<span class=w> </span>/usr/sbin/modem-*
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>modem-airplane-toggle:<span class=w> </span>POSIX<span class=w> </span>shell<span class=w> </span>script,<span class=w> </span>ASCII<span class=w> </span>text<span class=w> </span>executable
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>modem-command:<span class=w>         </span>POSIX<span class=w> </span>shell<span class=w> </span>script,<span class=w> </span>ASCII<span class=w> </span>text<span class=w> </span>executable
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>modem-power:<span class=w>           </span>POSIX<span class=w> </span>shell<span class=w> </span>script,<span class=w> </span>ASCII<span class=w> </span>text<span class=w> </span>executable
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>modem-reset:<span class=w>           </span>POSIX<span class=w> </span>shell<span class=w> </span>script,<span class=w> </span>ASCII<span class=w> </span>text<span class=w> </span>executable
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>modem-type:<span class=w>            </span>POSIX<span class=w> </span>shell<span class=w> </span>script,<span class=w> </span>ASCII<span class=w> </span>text<span class=w> </span>executable
</code></pre></div> <h3 id=31-modem-command-at-command-interface>3.1 modem-command (AT Command Interface)</h3> <p><strong>Purpose:</strong> Send AT commands to modem over TCP</p> <p><strong>Source:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=ch>#!/bin/sh</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-z<span class=w> </span><span class=s2>&quot;</span><span class=nv>$1</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Usage: modem-command COMMAND&quot;</span><span class=p>;</span><span class=w> </span><span class=nb>exit</span><span class=w> </span><span class=m>0</span><span class=p>;</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=k>fi</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span>-z<span class=w> </span><span class=s2>&quot;</span><span class=nv>$CMD_TIMEOUT</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>    </span><span class=nv>CMD_TIMEOUT</span><span class=o>=</span><span class=m>3</span><span class=p>;</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=k>fi</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=nv>LOG</span><span class=o>=</span><span class=s2>&quot;logger -s -t modem-command[</span><span class=nv>$$</span><span class=s2>]&quot;</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=nv>$LOG</span><span class=w> </span><span class=s2>&quot;&gt; </span><span class=nv>$1</span><span class=s2>&quot;</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=k>if</span><span class=w> </span>!<span class=w> </span><span class=o>(</span><span class=w> </span>sleep<span class=w> </span><span class=m>1</span><span class=p>;</span><span class=w> </span><span class=nb>printf</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$1</span><span class=s2>\r\n&quot;</span><span class=p>;</span><span class=w> </span>sleep<span class=w> </span><span class=m>1</span><span class=w> </span><span class=o>)</span><span class=w> </span><span class=p>|</span><span class=w> </span>socat<span class=w> </span>-t<span class=s2>&quot;</span><span class=nv>$CMD_TIMEOUT</span><span class=s2>&quot;</span><span class=w> </span>-<span class=w> </span>tcp:modem:50950,connect-timeout<span class=o>=</span><span class=m>3</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>    </span><span class=nv>$LOG</span><span class=w> </span>could<span class=w> </span>not<span class=w> </span>send<span class=w> </span>modem<span class=w> </span>command<span class=p>;</span><span class=w> </span><span class=nb>exit</span><span class=w> </span><span class=m>1</span><span class=p>;</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=k>fi</span>
</code></pre></div></p> <p><strong>Key Findings:</strong> - Uses <strong>socat</strong> to send commands to <code>modem:50950</code> (DNS alias for 192.168.90.60) - <strong>No authentication</strong> - any process can send AT commands - Commands are plain text with CRLF terminator - 3-second timeout by default - Example usage: <code>modem-command "AT+CGMM"</code> (get modem model)</p> <p><strong>AT Commands Found in Firmware:</strong></p> <table> <thead> <tr> <th>AT Command</th> <th>Purpose</th> <th>Source</th> </tr> </thead> <tbody> <tr> <td><code>AT</code></td> <td>Basic connectivity test</td> <td>check_at()</td> </tr> <tr> <td><code>AT+CGMM</code></td> <td>Get modem model (AG525RGL)</td> <td>check_mdm_sku()</td> </tr> <tr> <td><code>AT+CGMR</code></td> <td>Get firmware version</td> <td>get_mdm_fw_ver()</td> </tr> <tr> <td><code>AT+QGMR</code></td> <td>Quectel firmware revision</td> <td>get_mdm_fw_ver()</td> </tr> <tr> <td><code>AT+CCID</code></td> <td>Get SIM ICCID</td> <td>cmt-iris strings</td> </tr> <tr> <td><code>AT+QADC=0/1</code></td> <td>ADC control</td> <td>cmt-iris strings</td> </tr> <tr> <td><code>AT+XCMIEXT=0</code></td> <td>Disable cell monitoring</td> <td>modem-power sleep</td> </tr> <tr> <td><code>AT+XREG=0</code></td> <td>Disable registration notifications</td> <td>modem-power sleep</td> </tr> <tr> <td><code>AT+CREG=0</code></td> <td>Disable network registration URC</td> <td>modem-power sleep</td> </tr> <tr> <td><code>AT+CEREG=0</code></td> <td>Disable EPS registration URC</td> <td>modem-power sleep</td> </tr> <tr> <td><code>AT+CGREG=0</code></td> <td>Disable GPRS registration URC</td> <td>modem-power sleep</td> </tr> <tr> <td><code>AT+QCFGSIMTYPE=removable</code></td> <td>Configure SIM type</td> <td>config_sim_type()</td> </tr> <tr> <td><code>AT+QCFGDEFAPN=&lt;apn&gt;</code></td> <td>Set default APN</td> <td>config_default_apn()</td> </tr> <tr> <td><code>AT+QCFGAPPLY=1</code></td> <td>Apply modem configuration</td> <td>apply_config()</td> </tr> <tr> <td><code>AT#ECALLCAP=1</code></td> <td>Enable eCall capability</td> <td>check_ecall_mismatch()</td> </tr> <tr> <td><code>AT#ECALLCAP?</code></td> <td>Query eCall status</td> <td>check_ecall_mismatch()</td> </tr> <tr> <td><code>AT^OCT=0,0</code></td> <td>Unknown (Titan modem)</td> <td>modem-reset</td> </tr> <tr> <td><code>AT^OCT=1,1</code></td> <td>Unknown (Titan modem)</td> <td>modem-reset</td> </tr> </tbody> </table> <h3 id=32-modem-power-power-management>3.2 modem-power (Power Management)</h3> <p><strong>Purpose:</strong> Control modem power state (on/off/cycle/sleep/wake)</p> <p><strong>Usage:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>modem-power<span class=w> </span><span class=o>[</span>on<span class=w> </span><span class=p>|</span><span class=w> </span>off<span class=w> </span><span class=p>|</span><span class=w> </span>cycle<span class=w> </span><span class=p>|</span><span class=w> </span>cycle_upgrade<span class=w> </span><span class=p>|</span><span class=w> </span>sleep<span class=w> </span><span class=p>|</span><span class=w> </span>wake<span class=o>]</span>
</code></pre></div></p> <p><strong>Key Functions:</strong></p> <ol> <li><strong>Power On:</strong></li> <li>Enable power latch</li> <li>Pulse ONOFF (short pulse for "turn on")</li> <li>Wait for modem to enumerate (45s timeout)</li> <li>Wait for modem ready status (60s timeout)</li> <li> <p>Track failures in <code>CONN_modemPowerFailCount</code></p> </li> <li> <p><strong>Power Off:</strong></p> </li> <li>Pulse ONOFF (long pulse for "turn off")</li> <li>Wait for 1V8 rail to drop</li> <li>Disable power latch</li> <li> <p>Wait 35 seconds for clean shutdown</p> </li> <li> <p><strong>Power Cycle:</strong></p> </li> <li> <p>Power off + wait + power on</p> </li> <li> <p><strong>Power Cycle Upgrade:</strong></p> </li> <li> <p>Fast cycle (1 second ready timeout) for firmware updates</p> </li> <li> <p><strong>Sleep Mode:</strong></p> </li> <li>Stop ofono, qtcar-connman, qtcar-ecallclient</li> <li>Disable modem URCs (unsolicited result codes)</li> <li>Lower LTE-WAKE GPIO</li> <li> <p>Stop logging services</p> </li> <li> <p><strong>Wake Mode:</strong></p> </li> <li>Raise LTE-WAKE GPIO</li> <li>Start modemvm-logger, linuxvm-logger</li> <li>Start ofono, qtcar-connman, qtcar-ecallclient</li> </ol> <p><strong>Collision Detection:</strong> - Uses flock on <code>/var/run/modem-power</code> to prevent concurrent operations</p> <h3 id=33-modem-reset-firmware-update-fusing>3.3 modem-reset (Firmware Update &amp; Fusing)</h3> <p><strong>Purpose:</strong> Reset modem, update firmware, fuse secure boot</p> <p><strong>Workflow:</strong> 1. Check if eCall is active (abort if in progress) 2. Stop ofono service 3. Power cycle modem 4. If <code>--fuse</code> flag: fuse modem secure boot 5. If Titan modem: run telit_modem_update() 6. If Iris modem: wait for SSQ deployment, then run iris-fw-upgrade 7. Re-enable ofono and qtcar-connman</p> <p><strong>Update Interlock:</strong> - Queries <code>http://localhost:20564/modem-install-allowed</code> - Waits for "status=allowed" before proceeding (avoids conflicts with main OTA)</p> <p><strong>Collision Detection:</strong> - Uses flock on <code>/var/run/modem-reset</code></p> <h3 id=34-modem-type-modem-detection>3.4 modem-type (Modem Detection)</h3> <p><strong>Purpose:</strong> Determine if Iris or Titan modem</p> <p><strong>Logic:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>if</span><span class=w> </span>!<span class=w> </span><span class=o>[</span><span class=w> </span>-e<span class=w> </span>/var/lib/ofono/modem<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span>titan<span class=p>;</span><span class=w> </span>exit<span class=p>;</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=k>fi</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=nv>MODEM</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>cat<span class=w> </span>/var/lib/ofono/modem<span class=k>)</span><span class=s2>&quot;</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=k>if</span><span class=w> </span><span class=o>[[</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$MODEM</span><span class=s2>&quot;</span><span class=w> </span><span class=o>=</span><span class=w> </span>iris<span class=w> </span><span class=o>]]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span>iris<span class=p>;</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=k>else</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span>titan<span class=p>;</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=k>fi</span>
</code></pre></div></p> <p>Returns: <code>iris</code> or <code>titan</code></p> <h3 id=35-modemvm-logger-logging-service>3.5 modemvm-logger (Logging Service)</h3> <p><strong>Purpose:</strong> Forward logs from modem VM to MCU logging</p> <p><strong>Source:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=ch>#!/bin/sh</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=nb>export</span><span class=w> </span><span class=nv>GRABLOGS_HOST</span><span class=o>=</span>modem
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>.<span class=w> </span>/usr/local/bin/hermes-grablogs-external
</code></pre></div></p> <p>Connects to modem's log daemon and pipes to Hermes log collection.</p> <h3 id=36-modem-airplane-toggle>3.6 modem-airplane-toggle</h3> <p><strong>Purpose:</strong> Toggle airplane mode</p> <p><strong>Note:</strong> Implementation not analyzed in detail (shell script wrapper).</p> <h3 id=37-check-modem-self-test>3.7 check-modem (Self-Test)</h3> <p><strong>Purpose:</strong> Validate modem hardware and SIM</p> <p><strong>Tests:</strong> 1. Primary antenna status 2. Secondary antenna status 3. eSIM (eUICC) ICCID present 4. Physical SIM card ICCID present</p> <p><strong>Usage:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>check-modem
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=c1># Output: PASS or FAIL with details</span>
</code></pre></div></p> <p>Calls <code>cmt</code> binary (see below).</p> <hr> <h2 id=4-binary-analysis-cmt-iris>4. Binary Analysis: cmt-iris</h2> <p><strong>Path:</strong> <code>/usr/sbin/cmt-iris</code><br> <strong>Type:</strong> ELF 64-bit x86-64 executable<br> <strong>Size:</strong> 349 KB (341,248 bytes)<br> <strong>Build:</strong> Stripped (no debug symbols)<br> <strong>Compiler:</strong> Built with UBSan/ASan (sanitizers enabled)</p> <p><strong>Purpose:</strong> "CMT" likely stands for "Cellular Modem Test" - diagnostic utility</p> <p><strong>Key Capabilities (from strings):</strong></p> <ol> <li><strong>AT Command Execution:</strong></li> <li>Sends: <code>AT+QADC=0</code>, <code>AT+QADC=1</code>, <code>AT+CCID</code>, <code>AT+CGMM</code>, <code>AT+CGMR</code></li> <li> <p>Retrieves: SIM ICCID, modem model, firmware version, ADC readings</p> </li> <li> <p><strong>GPIO Control:</strong></p> </li> <li>Exports GPIOs via <code>/sys/class/gpio/export</code></li> <li> <p>Used for hardware-level modem control</p> </li> <li> <p><strong>Sanitizer Instrumentation:</strong></p> </li> <li>Built with UndefinedBehaviorSanitizer (UBSan)</li> <li>Includes error reporting and crash detection</li> <li>Developer build artifact (likely not production)</li> </ol> <p><strong>Reverse Engineering Notes:</strong> - Stripped binary makes full RE difficult - Key strings show it's a test/diagnostic tool - Not a critical security surface (read-only diagnostics)</p> <hr> <h2 id=5-firewall-rules-network-security>5. Firewall Rules &amp; Network Security</h2> <h3 id=51-modem-input-rules-etcfirewalldmodemiptables>5.1 Modem Input Rules (/etc/firewall.d/modem.iptables)</h3> <p><strong>Policy:</strong> Drop all by default, allow specific services</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>:MODEM_INPUT - [0:0]
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a># Modem update server (HTTP)
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --dport 49503 -j ACCEPT
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a># Linux VM logger (UDP + TCP)
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>-A MODEM_INPUT -p udp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --dport 5801 -j ACCEPT
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --dport 5801 -j ACCEPT
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a># TCUD (Tesla CU Daemon)
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --sport 38888 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a># Modem VM logger
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --dport 50960 -j ACCEPT
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a># AT commands (established connections only)
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --sport 50950 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a># Iris API (HTTP)
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --sport 8901 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>
<a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a># MQTT logger &amp; config listener
<a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 -m multiport --sports 50666,50877 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>
<a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a># RIL (Radio Interface Layer)
<a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --sport 7891 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a>
<a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a># eCall servers
<a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 -m multiport --sports 50911,50101 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a>
<a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a># SSH (established connections only)
<a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a>-A MODEM_INPUT -p tcp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --sport 22 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a>
<a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a># NTP time sync
<a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a>-A MODEM_INPUT -p udp -i eth0 -s 192.168.90.60 -d 192.168.90.100 --dport 123 -j ACCEPT
<a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a>
<a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a># Log and drop everything else
<a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a>-A MODEM_INPUT -m limit --limit 1/min -j NFLOG --nflog-prefix iptables-sandbox=MODEM_INPUT --nflog-group 30
<a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a>-A MODEM_INPUT -j DROP
<a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a>
<a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a># Attach to main INPUT chain
<a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a>-A INPUT -i eth0 ! -p icmp -s 192.168.90.60 -j MODEM_INPUT
</code></pre></div> <p><strong>Key Security Points:</strong> 1. Most modem-initiated connections are <strong>ESTABLISHED only</strong> (MCU must initiate) 2. Modem can SSH to MCU (reverse shell capability) 3. AT command responses allowed (but MCU initiates) 4. HTTP API on port 8901 (modem can respond, MCU initiates)</p> <h3 id=52-modem-update-server-etcfirewalldmodem-update-serveriptables>5.2 Modem Update Server (/etc/firewall.d/modem-update-server.iptables)</h3> <p><strong>Purpose:</strong> Restrict HTTP firmware server (shttpd user)</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>:MODEMSERVER - [0:0]
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a># Allow server responses to modem
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>-A MODEMSERVER -o eth0 -s 192.168.90.100 -d 192.168.90.60 -p tcp --sport 49503 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a># Allow localhost health checks
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>-A MODEMSERVER -o lo -s 192.168.90.100 -d 192.168.90.100 -p tcp --sport 49503 -m conntrack --ctstate ESTABLISHED -j ACCEPT
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a># Drop everything else
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a>-A MODEMSERVER -j DROP
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a># Apply to shttpd user
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>-A OUTPUT -m owner --uid-owner shttpd -j MODEMSERVER
</code></pre></div> <p><strong>Security:</strong> Only shttpd user can serve firmware, only to modem IP.</p> <h3 id=53-modemvm-logger-etcfirewalldmodemvm-loggeriptables>5.3 Modemvm-logger (/etc/firewall.d/modemvm-logger.iptables)</h3> <p><strong>Titan-only rule:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=k>$(</span>modem-type<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;titan&quot;</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>   </span><span class=nv>rule1</span><span class=o>=</span><span class=s2>&quot;-A MODEMVM-LOGGER -o eth0 -s 192.168.90.100 -d 192.168.90.60 -p tcp -m conntrack --ctstate ESTABLISHED -j ACCEPT&quot;</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=k>fi</span>
</code></pre></div></p> <p>Iris modem uses different logging (linuxvm-logger on port 5801).</p> <h3 id=54-network-isolation-summary>5.4 Network Isolation Summary</h3> <p><strong>Modem is NOT fully isolated:</strong> - Can SSH to MCU (attack surface if modem compromised) - Can initiate connections to MCU on multiple ports - Shares flat /24 network with MCU, APE, Gateway</p> <p><strong>Modem CANNOT:</strong> - Access toolbox-api (explicitly blocked) - Reach arbitrary internal IPs (firewall restricts sources)</p> <hr> <h2 id=6-modem-firmware-update-mechanism>6. Modem Firmware Update Mechanism</h2> <h3 id=61-firmware-packaging>6.1 Firmware Packaging</h3> <p><strong>File Structure:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>/home/cid-updater/
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>  â”œâ”€â”€ iris-&lt;version&gt;.ssq          # SquashFS image (dm-verity protected)
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>/opt/games/usr/                    # Backup location
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>  â””â”€â”€ iris-&lt;version&gt;.ssq
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>/deploy/iris/                      # Firmware payload directory (empty until SSQ mounted)
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>  â”œâ”€â”€ AG525RGL.version             # Target firmware version string
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>  â”œâ”€â”€ AG521RCN.version             # China variant version
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>  â”œâ”€â”€ &lt;version&gt;/                   # QFirehose package directory
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a>  â”‚   â”œâ”€â”€ rawprogram_nand.xml     # Flash layout
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>  â”‚   â”œâ”€â”€ patch0.xml              # Patch instructions
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a>  â”‚   â”œâ”€â”€ prog_emmc_firehose.mbn  # Firehose programmer
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>  â”‚   â”œâ”€â”€ abl.elf                 # Application Bootloader
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a>  â”‚   â”œâ”€â”€ boot.img                # Linux kernel
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a>  â”‚   â”œâ”€â”€ modem.img               # Baseband firmware
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a>  â”‚   â””â”€â”€ ... (more partitions)
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a>
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a>/etc/
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a>  â”œâ”€â”€ verity-modem-prod.pub        # Production signature verification key
<a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a>  â””â”€â”€ verity-modem-dev.pub         # Development signature verification key
</code></pre></div></p> <p><strong>SSQ (Signed SquashFS):</strong> - SquashFS filesystem with dm-verity hash tree appended - Last 64 bytes: SHA-256 signature (matches <code>/deploy/iris-&lt;SKU&gt;.sig</code>) - Signature verified against public keys before mount</p> <h3 id=62-update-workflow>6.2 Update Workflow</h3> <p><strong>Trigger:</strong> <code>modem-reset</code> or <code>iris-fw-upgrade.sh</code> called by escalator</p> <p><strong>Steps:</strong></p> <ol> <li><strong>Pre-checks:</strong></li> <li>Verify eCall not active (abort if emergency call in progress)</li> <li>Check update interlock: <code>curl http://localhost:20564/modem-install-allowed</code></li> <li> <p>Wait for "status=allowed" (prevents conflict with main OTA)</p> </li> <li> <p><strong>Power Cycle:</strong></p> </li> <li><code>modem-power cycle</code> to reset modem</li> <li> <p>Enable USB download mode: <code>gpio BMP-USB3-HVEN-1V8 1</code></p> </li> <li> <p><strong>USB Enumeration:</strong></p> </li> <li>Wait for USB device: <code>lsusb | grep "ID 2c7c:0452"</code> (normal mode)</li> <li> <p>Or: <code>lsusb | grep "ID 05c6:9008"</code> (EDL emergency mode)</p> </li> <li> <p><strong>AT Command Checks (Normal Mode Only):</strong></p> </li> <li>Send <code>AT</code> to verify modem responding</li> <li>Send <code>AT+CGMM</code> to get modem SKU (AG525RGL or AG521RCN)</li> <li> <p>Send <code>AT+QGMR</code> to get current firmware version</p> </li> <li> <p><strong>Signature Verification:</strong></p> </li> <li>Load iris SSQ: <code>iris-fw-ssq-load.sh --load --path &lt;ssq&gt; /deploy/iris</code></li> <li>Verify signature: compare tail of SSQ with <code>/deploy/iris-&lt;SKU&gt;.sig</code></li> <li> <p>If mismatch: abort</p> </li> <li> <p><strong>Version Check (unless forced):</strong></p> </li> <li>Read target version from <code>/deploy/iris/&lt;SKU&gt;.version</code></li> <li>Compare to current modem firmware</li> <li>If match: check signing domain (dev vs prod)</li> <li> <p>If signing domains match: exit (already up-to-date)</p> </li> <li> <p><strong>Signing Domain Check:</strong></p> </li> <li>Query modem: <code>curl http://192.168.90.60:8901/signing-domain</code></li> <li>Check target domain: <code>grep "Tesla Motors Iris Root CA" /deploy/iris/&lt;version&gt;/*/update/abl.elf</code><ul> <li>If found: <code>prod</code></li> <li>If not found: <code>dev</code></li> </ul> </li> <li> <p>If domains differ: proceed with update (re-fusing required)</p> </li> <li> <p><strong>QFirehose Flashing (up to 3 attempts):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>/usr/bin/QFirehose<span class=w> </span>-f<span class=w> </span>/deploy/iris/&lt;TARGET_FW&gt;
</code></pre></div></p> </li> <li>QFirehose is Qualcomm's firmware download tool</li> <li>Flashes partitions defined in rawprogram XML</li> <li>Communicates over USB using Sahara/Firehose protocol</li> <li>Exit code 254 = modem not in EDL mode</li> <li> <p>Exit code 0 = success</p> </li> <li> <p><strong>EDL Fallback (if needed):</strong></p> </li> <li>If QFirehose fails: manually switch to EDL <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>gpio<span class=w> </span>SOC-LTE-EFUSE-CON<span class=w> </span><span class=m>0</span><span class=w>    </span><span class=c1># Enable eFuse override</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>modem-power<span class=w> </span>cycle_upgrade<span class=w>    </span><span class=c1># Cycle with fast timing</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>gpio<span class=w> </span>SOC-LTE-EFUSE-CON<span class=w> </span><span class=m>1</span><span class=w>    </span><span class=c1># Disable override</span>
</code></pre></div></li> <li> <p>Retry QFirehose in EDL mode</p> </li> <li> <p><strong>Post-Update Configuration (Iris-GL only):</strong></p> <ul> <li>Send <code>AT+QCFGSIMTYPE=removable</code> (configure SIM type)</li> <li>Send <code>AT+QCFGDEFAPN=&lt;apn&gt;</code> (set default APN if <code>/var/lib/ofono/apn</code> exists)</li> <li>Send <code>AT+QCFGAPPLY=1</code> (apply config)</li> <li>Wait 30 seconds for modem to restart</li> </ul> </li> <li> <p><strong>Cleanup:</strong></p> <ul> <li>Unload SSQ: <code>iris-fw-ssq-load.sh --unload /deploy/iris</code></li> <li>Remove log: <code>rm /var/log/qfirehose_&lt;attempt&gt;</code></li> <li>Disable USB download mode: <code>gpio BMP-USB3-HVEN-1V8 0</code></li> </ul> </li> </ol> <h3 id=63-qfirehose-binary>6.3 QFirehose Binary</h3> <p><strong>Path:</strong> <code>/usr/bin/QFirehose</code><br> <strong>Type:</strong> ELF 64-bit x86-64 executable<br> <strong>Size:</strong> 99 KB<br> <strong>Purpose:</strong> Qualcomm Firehose protocol client</p> <p><strong>Protocol Overview:</strong> 1. <strong>Sahara Protocol:</strong> Handshake, load programmer into modem RAM 2. <strong>Firehose Protocol:</strong> XML-based flash commands - PROGRAM (write partition) - ERASE (erase partition) - PATCH (modify bytes) - SETBOOTABLESTORAGEDRIVE - RESET</p> <p><strong>Security:</strong> Modem must be in EDL mode, which requires: - USB download mode enabled (GPIO) - Or modem in emergency state (bootloader failure)</p> <h3 id=64-secure-boot-fusing>6.4 Secure Boot Fusing</h3> <p><strong>Purpose:</strong> Enable modem secure boot (prevent unsigned firmware)</p> <p><strong>Script:</strong> <code>/sbin/autofuser-modem-iris.sh</code></p> <p><strong>API Endpoints (port 8901):</strong> - <code>GET /status</code> â†’ "ok" (modem ready) - <code>GET /fuse/check</code> â†’ "fused" | "ok" (secure boot status) - <code>POST /fuse/secboot</code> â†’ "ok" (trigger fusing) - Body: <code>{"debug": true/false}</code> (enable debug fusing) - <code>GET /fuse/capabilities/debug-fusing</code> â†’ "true" | "false" (debug fuse supported) - <code>GET /attestation/key-status</code> â†’ "ok" (attestation key valid)</p> <p><strong>Fusing Workflow:</strong> 1. Power on modem 2. Wait for Iris API: <code>curl http://192.168.90.60:8901/status</code> 3. Check if already fused: <code>curl http://192.168.90.60:8901/fuse/check</code> 4. If not fused: - POST fuse request: <code>curl --data '{"debug": false}' http://192.168.90.60:8901/fuse/secboot</code> - Power cycle modem - Verify fused 5. Check attestation key: <code>curl http://192.168.90.60:8901/attestation/key-status</code></p> <p><strong>Security Implications:</strong> - Once fused, modem only boots signed firmware - "debug" fusing allows dev-signed firmware - Production fusing requires prod-signed firmware - <strong>Attack vector:</strong> If attacker can trigger unfused state (EDL mode), they can flash custom firmware</p> <hr> <h2 id=7-security-analysis>7. Security Analysis</h2> <h3 id=71-attack-surface>7.1 Attack Surface</h3> <h4 id=high-priority-threats>High-Priority Threats</h4> <p><strong>1. Modem â†’ MCU Compromise</strong></p> <p><strong>Scenario:</strong> If modem is compromised (baseband exploit), attacker can: - SSH to MCU (port 22 allowed) - Connect to multiple MCU services (50960, 5801, etc.) - Poison logs sent to MCU - Man-in-the-middle cellular data</p> <p><strong>Mitigation:</strong> - Firewall restricts modem to specific ports - SSH requires key authentication - AppArmor sandboxing on MCU</p> <p><strong>2. Unauthenticated AT Command Interface</strong></p> <p><strong>Scenario:</strong> Any MCU process can send AT commands via <code>modem-command</code>: <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>modem-command<span class=w> </span><span class=s2>&quot;AT+QCFGDEFAPN=evil.apn.com&quot;</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>modem-command<span class=w> </span><span class=s2>&quot;AT+QCFGAPPLY=1&quot;</span>
</code></pre></div></p> <p><strong>Impact:</strong> - Change APN (redirect traffic) - Disable network (DoS) - Read SIM ICCID - Query modem status</p> <p><strong>Mitigation:</strong> - AT interface only accessible via socat over TCP - Requires root or specific user (no AppArmor restriction found)</p> <p><strong>3. Modem Firmware Downgrade</strong></p> <p><strong>Scenario:</strong> Attacker with root on MCU can: - Switch modem to EDL mode via GPIO - Flash arbitrary firmware via QFirehose - Bypass secure boot if modem not fused</p> <p><strong>Mitigation:</strong> - Fused modems reject unsigned firmware - EDL mode requires GPIO control (root access) - Signature verification on SSQ images</p> <p><strong>4. HTTP API Exposure (Port 8901)</strong></p> <p><strong>Scenario:</strong> Modem exposes HTTP API for management: - <code>/status</code> - health check - <code>/fuse/check</code> - secure boot status - <code>/fuse/secboot</code> - trigger fusing - <code>/attestation/key-status</code> - attestation status - <code>/signing-domain</code> - prod vs dev signature check</p> <p><strong>Vulnerabilities:</strong> - No authentication (IP-based trust) - POST endpoints can change fuse state - Open to any MCU process</p> <p><strong>Mitigation:</strong> - Firewall limits to 192.168.90.100 â†” 192.168.90.60 - POST operations likely have rate limiting (not confirmed)</p> <h4 id=medium-priority-threats>Medium-Priority Threats</h4> <p><strong>5. SIM/eSIM Manipulation</strong></p> <p><strong>AT Commands:</strong> - <code>AT+CCID</code> - read ICCID - <code>AT+QCFGSIMTYPE=removable</code> - switch SIM type</p> <p><strong>Impact:</strong> - Enumerate SIM card details - Force use of physical vs eSIM</p> <p><strong>6. Modem Sleep/Wake Abuse</strong></p> <p><strong>Scenario:</strong> Repeated sleep/wake cycles to cause DoS: <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=k>while</span><span class=w> </span>true<span class=p>;</span><span class=w> </span><span class=k>do</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=w>    </span>modem-power<span class=w> </span>sleep
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=w>    </span>sleep<span class=w> </span><span class=m>1</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>    </span>modem-power<span class=w> </span>wake
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=k>done</span>
</code></pre></div></p> <p><strong>Mitigation:</strong> - Collision detection via flock on <code>/var/run/modem-power</code> - Only one modem-power instance can run</p> <p><strong>7. Log Injection</strong></p> <p><strong>Modem can send logs to MCU:</strong> - Port 5801 (linuxvm-logger) - Port 50960 (modemvm-logger)</p> <p><strong>Scenario:</strong> Compromised modem injects malicious logs to: - Poison log analysis - Trigger log processing vulnerabilities - Hide tracks</p> <h3 id=72-firmware-signature-verification>7.2 Firmware Signature Verification</h3> <p><strong>Public Keys:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>/etc/verity-modem-prod.pub  (2048-bit RSA)
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>/etc/verity-modem-dev.pub   (2048-bit RSA)
</code></pre></div></p> <p><strong>Verification Process:</strong> 1. SSQ file last 64 bytes = SHA-256 signature 2. Compare to <code>/deploy/iris-&lt;SKU&gt;.sig</code> (64 bytes) 3. If mismatch: abort 4. Mount SSQ via dm-verity: - <code>ssq-util --load --name iris-modem --target /deploy/iris --file &lt;ssq&gt; --key &lt;pubkey&gt;</code> - Kernel verifies hash tree on every block read</p> <p><strong>Signing Domain:</strong> - <strong>Production:</strong> Firmware signed with "Tesla Motors Iris Root CA" - <strong>Development:</strong> Firmware signed with dev key</p> <p><strong>Rollback Protection:</strong> - No version monotonic counter found - Downgrade possible if attacker has root + valid old SSQ</p> <h3 id=73-modem-mcu-trust-boundary>7.3 Modem â†’ MCU Trust Boundary</h3> <p><strong>Modem is treated as semi-trusted:</strong> - Allowed to initiate some connections (SSH, logs) - Responses to MCU-initiated requests (AT commands, HTTP API) - Cannot access toolbox-api or arbitrary internal services</p> <p><strong>If modem compromised:</strong> - Can attack MCU via SSH/HTTP - Can poison cellular data stream - Can intercept/modify OTA updates (if MitM Hermes) - Cannot directly access APE, Gateway, or other ECUs (firewall blocked)</p> <h3 id=74-baseband-vulnerabilities>7.4 Baseband Vulnerabilities</h3> <p><strong>Quectel AG525RGL Known Issues:</strong> - No public CVEs found specific to AG525RGL - Qualcomm baseband vulnerabilities apply (chipset-level) - Historical Qualcomm issues: - CVE-2020-11292 (RCE via SMS) - CVE-2021-1905 (memory corruption) - CVE-2021-30351 (baseband RCE)</p> <p><strong>Mitigation:</strong> - Regular modem firmware updates via OTA - Modem isolated from critical vehicle functions (no direct CAN access) - Firewall limits blast radius</p> <h3 id=75-sim-card-security>7.5 SIM Card Security</h3> <p><strong>Physical SIM:</strong> - Removable (user can swap) - PIN/PUK protection (not managed by scripts)</p> <p><strong>eSIM (eUICC):</strong> - Embedded, non-removable - Managed via <code>AT+QCFGSIMTYPE=removable</code> (switchable) - Profile downloads via carrier (not found in scripts)</p> <p><strong>Risks:</strong> - SIM cloning (if PIN disabled) - SIM swapping (social engineering carrier) - eSIM profile tampering (requires carrier access)</p> <hr> <h2 id=8-connectivity-features>8. Connectivity Features</h2> <h3 id=81-hermes-backend-connection>8.1 Hermes Backend Connection</h3> <p><strong>Transport:</strong> WebSocket Secure (WSS) over cellular (eth0.2)</p> <p><strong>Details:</strong> - See <code>/root/tesla/hermes-research.md</code> for full Hermes analysis - Modem provides IP connectivity layer - MCU handles TLS/WSS and authentication</p> <p><strong>Modem's Role:</strong> 1. Establish LTE/5G radio link 2. Route data via eth0.2 VLAN 3. Provide DNS (8.8.8.8) 4. Monitor connection quality</p> <h3 id=82-cellular-network-selection>8.2 Cellular Network Selection</h3> <p><strong>APN Configuration:</strong> - Default: <code>tesla01.com.attz</code> (AT&amp;T) - Configurable via <code>/var/lib/ofono/apn</code> file - Applied via <code>AT+QCFGDEFAPN=&lt;apn&gt;</code></p> <p><strong>Network Registration:</strong> - Managed by ofono daemon - Query: <code>AT+CREG?</code> (2G/3G), <code>AT+CEREG?</code> (LTE), <code>AT+C5GREG?</code> (5G) - Notifications disabled during sleep</p> <p><strong>Roaming:</strong> - Likely enabled (no explicit disable found) - Controlled by ofono policies</p> <h3 id=83-data-usage-metering>8.3 Data Usage Metering</h3> <p><strong>Not found in scripts.</strong></p> <p>Likely handled by: - ofono statistics - qtcar-connman (connection manager) - Backend tracking via Hermes</p> <h3 id=84-airplane-mode>8.4 Airplane Mode</h3> <p><strong>Script:</strong> <code>/usr/sbin/modem-airplane-toggle</code></p> <p><strong>Implementation:</strong> - Likely calls ofono D-Bus methods - Or sends AT commands to disable radio</p> <p><strong>Not analyzed in detail</strong> (script not extracted).</p> <h3 id=85-ecall-emergency-call>8.5 eCall (Emergency Call)</h3> <p><strong>Purpose:</strong> Automatic crash notification (EU regulation)</p> <p><strong>Components:</strong> - <code>/usr/lib/libirisecall.so</code> - Iris eCall library - <code>qtcar-ecallclient</code> - eCall client service - Ports 50911, 50101 - eCall servers on modem</p> <p><strong>Lock File:</strong> - <code>/home/ecallclient/ECALL_LOCK_ON</code> - indicates eCall in progress</p> <p><strong>Protection:</strong> - Modem updates blocked during eCall - Modem resets blocked during eCall</p> <p><strong>AT Commands:</strong> - <code>AT#ECALLCAP=1</code> - enable eCall - <code>AT#ECALLCAP?</code> - query eCall status</p> <p><strong>Vehicle Support:</strong> - Disabled on older Model S/X (<code>modelsx_info2</code> variant) - Enabled on Model 3/Y (default) - Configurable via <code>VAPI_isECallEquipped</code> vehicle variable</p> <hr> <h2 id=9-modem-firmware-location>9. Modem Firmware Location</h2> <h3 id=91-expected-locations-empty>9.1 Expected Locations (Empty)</h3> <p><strong>MCU Firmware:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>/deploy/iris/                    # Should contain modem firmware
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>â”œâ”€â”€ .empty                       # Placeholder (directory empty)
</code></pre></div></p> <p><strong>Reason:</strong> Modem firmware delivered separately via: 1. <strong>SSQ breakout packages</strong> during OTA update 2. Stored in <code>/home/cid-updater/iris-*.ssq</code> 3. Backup in <code>/opt/games/usr/iris-*.ssq</code></p> <h3 id=92-actual-firmware-storage>9.2 Actual Firmware Storage</h3> <p><strong>Not in MCU rootfs extraction.</strong></p> <p><strong>Found in:</strong> - <strong>Model3Y extraction:</strong> <code>/root/downloads/model3y-extracted/deploy/iris-*.sig</code> - <code>iris-AG525RGL.sig</code> (64 bytes) - <code>iris-AG521RCN.sig</code> (64 bytes)</p> <p><strong>Full firmware likely in:</strong> - OTA update packages (not extracted) - Separate downloadable .ssq files - Tesla update servers</p> <p><strong>SSQ Contents (when mounted):</strong> - QFirehose flash packages - Modem partition images (boot.img, modem.img, abl.elf, etc.) - XML flash layout (rawprogram_nand.xml)</p> <hr> <h2 id=10-cross-references>10. Cross-References</h2> <h3 id=related-research-documents>Related Research Documents</h3> <ol> <li><strong>Hermes Backend Connectivity:</strong></li> <li><code>/root/tesla/hermes-research.md</code></li> <li><code>/root/tesla/03-certificate-recovery-orphan-cars.md</code></li> <li> <p>Modem provides cellular link, Hermes handles authentication</p> </li> <li> <p><strong>Network Architecture:</strong></p> </li> <li><code>/root/tesla/04-network-ports-firewall.md</code></li> <li><code>/root/tesla/25-network-attack-surface.md</code></li> <li> <p>Modem firewall rules analyzed here</p> </li> <li> <p><strong>OTA Update System:</strong></p> </li> <li><code>/root/tesla/18-cid-iris-update-pipeline.md</code></li> <li><code>/root/tesla/10-usb-firmware-update-deep.md</code></li> <li> <p>Modem firmware part of main OTA flow</p> </li> <li> <p><strong>Gateway Communication:</strong></p> </li> <li><code>/root/tesla/02-gateway-can-flood-exploit.md</code></li> <li><code>/root/tesla/09-gateway-sdcard-log-analysis.md</code></li> <li> <p>Modem isolated from CAN bus (no direct gateway link)</p> </li> <li> <p><strong>Security Sandboxing:</strong></p> </li> <li><code>/root/tesla/31-apparmor-sandbox-security.md</code></li> <li>Modem services sandboxed via AppArmor</li> </ol> <hr> <h2 id=11-key-findings-summary>11. Key Findings Summary</h2> <h3 id=architecture>Architecture</h3> <p>âœ… <strong>Modem Confirmed:</strong> Quectel AG525RGL (Iris-GL)<br> âœ… <strong>Communication:</strong> Ethernet (192.168.90.60) + VLAN (eth0.2) for data<br> âœ… <strong>Control:</strong> AT commands over TCP port 50950<br> âœ… <strong>Management:</strong> HTTP API on port 8901<br> âœ… <strong>Update:</strong> USB download via QFirehose (Qualcomm protocol) </p> <h3 id=security>Security</h3> <p>âš ï¸ <strong>AT Interface:</strong> No authentication, any MCU process can send commands<br> âš ï¸ <strong>Modem â†’ MCU:</strong> SSH allowed (compromise vector)<br> âš ï¸ <strong>HTTP API:</strong> Unauthenticated (IP-based trust only)<br> âœ… <strong>Firmware:</strong> Signed with dm-verity, verified before mount<br> âœ… <strong>Secure Boot:</strong> Fusing supported to prevent unsigned firmware<br> âš ï¸ <strong>Downgrade:</strong> No rollback protection found </p> <h3 id=functionality>Functionality</h3> <p>âœ… <strong>Dual SIM:</strong> Physical + eSIM (eUICC) support<br> âœ… <strong>5G/LTE:</strong> Modern Qualcomm modem with sub-6 GHz<br> âœ… <strong>eCall:</strong> Emergency call capability (EU regulation)<br> âœ… <strong>Sleep Mode:</strong> Power management for efficiency<br> âœ… <strong>Logging:</strong> Bidirectional log streaming to MCU </p> <h3 id=attack-vectors>Attack Vectors</h3> <ol> <li>Baseband exploit â†’ modem compromise â†’ SSH to MCU</li> <li>Root on MCU â†’ EDL mode â†’ flash malicious modem firmware</li> <li>AT command injection â†’ change APN, DoS, data leakage</li> <li>HTTP API abuse â†’ fuse manipulation, status queries</li> <li>Log injection â†’ poison monitoring, hide tracks</li> </ol> <hr> <h2 id=12-recommendations-for-further-research>12. Recommendations for Further Research</h2> <h3 id=high-priority>High Priority</h3> <ol> <li><strong>Reverse Engineer cmt-iris Binary</strong></li> <li>Load in Ghidra/IDA Pro</li> <li>Identify AT command sequences</li> <li>Find hidden diagnostic commands</li> <li> <p>Check for buffer overflows</p> </li> <li> <p><strong>Test HTTP API Endpoints</strong></p> </li> <li>Fuzz port 8901 for hidden endpoints</li> <li>Test POST operations (fuse/secboot)</li> <li>Check for authentication bypass</li> <li> <p>Map full API surface</p> </li> <li> <p><strong>Extract Iris SSQ Firmware</strong></p> </li> <li>Download full OTA update package</li> <li>Locate iris-*.ssq file</li> <li>Mount with ssq-util</li> <li>Analyze modem partition images</li> <li> <p>Extract modem Linux filesystem</p> </li> <li> <p><strong>Analyze QFirehose Binary</strong></p> </li> <li>Reverse engineer Firehose protocol implementation</li> <li>Identify security checks</li> <li>Test with modified firmware</li> <li>Explore EDL mode entry methods</li> </ol> <h3 id=medium-priority>Medium Priority</h3> <ol> <li><strong>AppArmor Profile Analysis</strong></li> <li>Check <code>/etc/apparmor.compiled/usr.sbin.modem-*</code></li> <li>Verify AT command restrictions</li> <li> <p>Test sandbox escapes</p> </li> <li> <p><strong>Ofono D-Bus Interface</strong></p> </li> <li>Enumerate D-Bus methods</li> <li>Test network management APIs</li> <li> <p>Check for privilege escalation</p> </li> <li> <p><strong>Modem Log Analysis</strong></p> </li> <li>Capture live logs from port 5801, 50960</li> <li>Identify log format</li> <li> <p>Test log injection attacks</p> </li> <li> <p><strong>eCall Implementation</strong></p> </li> <li>Analyze libirisecall.so</li> <li>Understand crash detection logic</li> <li>Test emergency call triggering</li> </ol> <h3 id=low-priority>Low Priority</h3> <ol> <li><strong>Network Traffic Analysis</strong></li> <li>Sniff eth0.2 VLAN traffic</li> <li>Analyze cellular data flows</li> <li> <p>Map Hermes connection handshake</p> </li> <li> <p><strong>Power Management Testing</strong></p> <ul> <li>Measure current draw in sleep mode</li> <li>Test wake latency</li> <li>Verify power-off sequence</li> </ul> </li> </ol> <hr> <h2 id=13-appendix-file-inventory>13. Appendix: File Inventory</h2> <h3 id=scripts-analyzed>Scripts Analyzed</h3> <ul> <li><code>/usr/sbin/modem-type</code> (shell)</li> <li><code>/usr/sbin/modem-command</code> (shell)</li> <li><code>/usr/sbin/modem-power</code> (shell)</li> <li><code>/usr/sbin/modem-reset</code> (shell)</li> <li><code>/usr/sbin/modem-airplane-toggle</code> (shell)</li> <li><code>/usr/bin/modemvm-logger</code> (shell)</li> <li><code>/usr/bin/check-modem</code> (shell)</li> <li><code>/usr/local/bin/modem-common</code> (shell library)</li> <li><code>/usr/local/bin/iris-fw-upgrade.sh</code> (shell)</li> <li><code>/usr/local/bin/iris-fw-ssq-load.sh</code> (shell)</li> <li><code>/usr/local/bin/iris-fw-services.sh</code> (shell)</li> <li><code>/usr/local/bin/iris-fw-sideload.sh</code> (not analyzed)</li> <li><code>/usr/local/bin/iris-sim-apn-cfg.sh</code> (not analyzed)</li> <li><code>/usr/local/bin/irislogs</code> (not analyzed)</li> <li><code>/usr/local/bin/hermes-grablogs-modem</code> (shell wrapper)</li> <li><code>/sbin/autofuser-modem.sh</code> (not analyzed)</li> <li><code>/sbin/autofuser-modem-iris.sh</code> (shell)</li> <li><code>/sbin/autofuser-modem-titan.sh</code> (not analyzed)</li> </ul> <h3 id=binaries-analyzed>Binaries Analyzed</h3> <ul> <li><code>/usr/sbin/cmt-iris</code> (ELF, 349 KB) - Modem diagnostic tool</li> <li><code>/usr/bin/QFirehose</code> (ELF, 99 KB) - Qualcomm flash tool</li> <li><code>/usr/lib/libirisecall.so</code> (ELF) - eCall library</li> </ul> <h3 id=configuration-files>Configuration Files</h3> <ul> <li><code>/etc/ofono/iris.conf</code> - Modem connection parameters</li> <li><code>/etc/verity-modem-prod.pub</code> - Production signing key</li> <li><code>/etc/verity-modem-dev.pub</code> - Development signing key</li> <li><code>/etc/firewall.d/modem.iptables</code> - Modem firewall rules</li> <li><code>/etc/firewall.d/modem-update-server.iptables</code> - Update server rules</li> <li><code>/etc/firewall.d/modemvm-logger.iptables</code> - Logger rules</li> <li><code>/etc/firewall.d/ofono.iptables</code> - Ofono firewall rules</li> <li><code>/etc/firewall.d/qtcar-connman.iptables</code> - Connection manager rules</li> </ul> <h3 id=apparmor-profiles>AppArmor Profiles</h3> <ul> <li><code>/etc/apparmor.compiled/usr.sbin.modem-power</code></li> <li><code>/etc/apparmor.compiled/usr.sbin.modem-reset</code></li> <li><code>/etc/apparmor.compiled/usr.sbin.modem-command</code></li> <li><code>/etc/apparmor.compiled/usr.sbin.modem-type</code></li> <li><code>/etc/apparmor.compiled/usr.bin.modemvm-logger</code></li> </ul> <h3 id=missingempty>Missing/Empty</h3> <ul> <li><code>/deploy/iris/</code> - Empty (firmware delivered via SSQ)</li> <li>Iris firmware images - Not in MCU rootfs</li> <li>Full API endpoint documentation - Reverse engineering required</li> </ul> <hr> <h2 id=14-glossary>14. Glossary</h2> <ul> <li><strong>AG525RGL:</strong> Quectel 5G modem model number (Iris-GL variant)</li> <li><strong>Iris:</strong> Tesla internal codename for Quectel modems</li> <li><strong>Titan:</strong> Tesla internal codename for Telit modems (legacy)</li> <li><strong>AT Commands:</strong> Hayes command set for modem control</li> <li><strong>EDL:</strong> Emergency Download Mode (Qualcomm bootloader)</li> <li><strong>QFirehose:</strong> Qualcomm firmware flash protocol</li> <li><strong>SSQ:</strong> Signed SquashFS - dm-verity protected filesystem image</li> <li><strong>dm-verity:</strong> Device-mapper target for read-only integrity checking</li> <li><strong>ofono:</strong> Open-source telephony daemon (Linux Foundation)</li> <li><strong>eCall:</strong> Emergency call system (EU regulation)</li> <li><strong>RIL:</strong> Radio Interface Layer - Android telephony abstraction</li> <li><strong>VLAN:</strong> Virtual LAN - network segmentation (eth0.2 = VLAN 20)</li> <li><strong>APN:</strong> Access Point Name - cellular network gateway</li> <li><strong>ICCID:</strong> Integrated Circuit Card ID - SIM card identifier</li> <li><strong>eUICC:</strong> Embedded Universal Integrated Circuit Card (eSIM)</li> <li><strong>Hermes:</strong> Tesla backend communication system</li> </ul> <hr> <p><strong>Document Status:</strong> âœ… COMPLETE<br> <strong>Analyst:</strong> Security Platform Subagent (modem-iris-tillit-analysis)<br> <strong>Date:</strong> 2026-02-03<br> <strong>Next Steps:</strong> Reverse engineer cmt-iris, test HTTP API, extract full modem firmware</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/talas9/tesla-research target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>